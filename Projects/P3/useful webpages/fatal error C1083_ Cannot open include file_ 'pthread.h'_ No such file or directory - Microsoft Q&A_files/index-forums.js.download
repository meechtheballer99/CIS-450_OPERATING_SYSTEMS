(()=>{var Hm=Object.create;var Yn=Object.defineProperty;var ei=Object.getOwnPropertyDescriptor;var qm=Object.getOwnPropertyNames;var Bm=Object.getPrototypeOf,$m=Object.prototype.hasOwnProperty;var Vm=o=>Yn(o,"__esModule",{value:!0});var Gm=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var Km=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of qm(e))!$m.call(o,r)&&(t||r!=="default")&&Yn(o,r,{get:()=>e[r],enumerable:!(n=ei(e,r))||n.enumerable});return o},Wm=(o,e)=>Km(Vm(Yn(o!=null?Hm(Bm(o)):{},"default",!e&&o&&o.__esModule?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o);var sn=(o,e,t,n)=>{for(var r=n>1?void 0:n?ei(e,t):e,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=(n?a(e,t,r):a(r))||r);return n&&r&&Yn(e,t,r),r};var oi=Gm((ls,ti)=>{(function(o,e){typeof ls=="object"&&typeof ti<"u"?e():typeof define=="function"&&define.amd?define(e):e()})(ls,function(){"use strict";function o(t){var n=!0,r=!1,s=null,a={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function i(w){return!!(w&&w!==document&&w.nodeName!=="HTML"&&w.nodeName!=="BODY"&&"classList"in w&&"contains"in w.classList)}function c(w){var ke=w.type,gt=w.tagName;return!!(gt==="INPUT"&&a[ke]&&!w.readOnly||gt==="TEXTAREA"&&!w.readOnly||w.isContentEditable)}function l(w){w.classList.contains("focus-visible")||(w.classList.add("focus-visible"),w.setAttribute("data-focus-visible-added",""))}function d(w){!w.hasAttribute("data-focus-visible-added")||(w.classList.remove("focus-visible"),w.removeAttribute("data-focus-visible-added"))}function u(w){w.metaKey||w.altKey||w.ctrlKey||(i(t.activeElement)&&l(t.activeElement),n=!0)}function p(w){n=!1}function m(w){!i(w.target)||(n||c(w.target))&&l(w.target)}function g(w){!i(w.target)||(w.target.classList.contains("focus-visible")||w.target.hasAttribute("data-focus-visible-added"))&&(r=!0,window.clearTimeout(s),s=window.setTimeout(function(){r=!1},100),d(w.target))}function y(w){document.visibilityState==="hidden"&&(r&&(n=!0),E())}function E(){document.addEventListener("mousemove",N),document.addEventListener("mousedown",N),document.addEventListener("mouseup",N),document.addEventListener("pointermove",N),document.addEventListener("pointerdown",N),document.addEventListener("pointerup",N),document.addEventListener("touchmove",N),document.addEventListener("touchstart",N),document.addEventListener("touchend",N)}function I(){document.removeEventListener("mousemove",N),document.removeEventListener("mousedown",N),document.removeEventListener("mouseup",N),document.removeEventListener("pointermove",N),document.removeEventListener("pointerdown",N),document.removeEventListener("pointerup",N),document.removeEventListener("touchmove",N),document.removeEventListener("touchstart",N),document.removeEventListener("touchend",N)}function N(w){w.target.nodeName&&w.target.nodeName.toLowerCase()==="html"||(n=!1,I())}document.addEventListener("keydown",u,!0),document.addEventListener("mousedown",p,!0),document.addEventListener("pointerdown",p,!0),document.addEventListener("touchstart",p,!0),document.addEventListener("visibilitychange",y,!0),E(),t.addEventListener("focus",m,!0),t.addEventListener("blur",g,!0),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.host?t.host.setAttribute("data-js-focus-visible",""):t.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if(typeof window<"u"&&typeof document<"u"){window.applyFocusVisiblePolyfill=o;var e;try{e=new CustomEvent("focus-visible-polyfill-ready")}catch{e=document.createEvent("CustomEvent"),e.initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(e)}typeof document<"u"&&o(document)})});var xF=Wm(oi());var Wt=window;var H=Wt,an=Wt.navigator,k=Wt.document,ox=Wt.localStorage,Ym=Wt.history,J=Wt.location,nx=H.jQuery,rx=H.jQuery,f=H.msDocs,ie=new Promise(o=>{k.readyState==="loading"?k.addEventListener("DOMContentLoaded",()=>o()):o()});var jm="localhost",Qm="review.docs.microsoft.com",Jm="ppe.docs.microsoft.com";var cn=location.hostname===jm,ct=location.hostname===Qm,ni=location.hostname===Jm,ln=!ni&&!cn,Ue=ln&&!ct,Xm=location.hostname.endsWith("docs.microsoft.com")||cn,ft=location.pathname.split("/").map(o=>o.toLowerCase()),ri=ft.length>2?ft[2]:"",ax=ft.length>2&&ft[2]==="answers"&&document.head.querySelector('link[href*="forums.css"]'),si=ni&&ri==="learn-sandbox",un=ri==="test";var dn="__event_type_id__",Zm=0,wt=class{constructor(){this.callbacks={}}publish(e){let t=e.constructor[dn];if(t===void 0||this.callbacks[t]===void 0)return;let n=this.callbacks[t].slice(0);for(let r of n)r(e)}subscribe(e,t){e.hasOwnProperty(dn)||(e[dn]=Zm++);let n=e[dn];this.callbacks[n]===void 0&&(this.callbacks[n]=[]);let r=this.callbacks[n];return r.indexOf(t)===-1&&r.push(t),()=>this.unsubscribe(e,t)}unsubscribe(e,t){let n=e[dn];if(n===void 0||this.callbacks[n]===void 0)return;let r=this.callbacks[n],s=r.indexOf(t);s!==-1&&r.splice(s,1)}dispose(){this.callbacks={}}},Yt=new wt;var pn=class{constructor(e,t,n){this.title=e;this.url=t;this.referrerUrl=n}};var jt;function ai(){jt={};let o=k.head.querySelectorAll("meta[name],meta[property]");for(let e=0;e<o.length;e++){let t=o.item(e),n=t.name;n===""&&(n=t.getAttribute("property"),n==="")||(jt[n]?jt[n].push(t.content):jt[n]=[t.content])}Yt.subscribe(pn,ai)}function ii(o){return Array.from(o.querySelectorAll("meta")).reduce((e,t)=>{let n=t.name||t.getAttribute("property");return e[n]=t.content,e},{})}function O(o){return jt===void 0&&ai(),jt[o]===void 0?void 0:jt[o][0]}function tg(o,e){let t=e&&!!e.reviewFeatures,n=e&&e.isolated?"isolated":"online",r=e&&e.azurePortalHostname;switch(o){case"docs.microsoft.com":return{supportLevel:"production",accessLevel:n,reviewFeatures:t,systemContent:!0,azurePortalHostname:r,legacyHosting:!0};case"review.docs.microsoft.com":return{supportLevel:"production",accessLevel:n,reviewFeatures:!0,systemContent:!0,azurePortalHostname:r,legacyHosting:!0};case"ppe.docs.microsoft.com":return{supportLevel:"development",accessLevel:n,reviewFeatures:!0,systemContent:!0,azurePortalHostname:r,legacyHosting:!0};case"localhost":return{supportLevel:"development",accessLevel:"local",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0};case"review.docs.azure.cn":case"review.rd.microsoft.com":case"review.developer.microsoft.com":return{supportLevel:"production",accessLevel:n,reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0};case"dev.docs.microsoft.com":case"prdev.docs.microsoft.com":case"internal.docs.microsoft.com":case"docs-render2-pubdev-wus.azurewebsites.net":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!1};case"docs.azure.cn":case"rd.microsoft.com":case"developer.microsoft.com":default:return{supportLevel:"production",accessLevel:n,reviewFeatures:t,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0}}}var P=f?.environment?f.environment:tg(location.hostname,f?.data?.context||{});var re={setItem(o,e){try{H.localStorage.setItem(o,e)}catch{}},getItem(o){try{return H.localStorage.getItem(o)}catch{return null}},removeItem(o){try{H.localStorage.removeItem(o)}catch{}},clear(){try{H.localStorage.clear()}catch{}}};var us="docs.preview",ds=(new URLSearchParams(J.search).get("preview")||"").split(",").map(o=>o.trim().toLowerCase()).reduce((o,e)=>(e!==""&&(o[e]=1),o),{}),mn,og=()=>{let o;return re.getItem(us)?o=JSON.parse(re.getItem(us)):o={},o},ng=(o,e)=>{mn=og();let t=ds[o]===1,n=!isNaN(mn[o]),r=t||n,s=ds[`x-${o}`];return t?console.log(`Preview ${o} via query string`):n&&console.log(`Preview ${o} via local storage`),e&&(r||s)&&(r&&(mn[o]=Date.now()),s&&delete mn[o],re.setItem(us,JSON.stringify(mn))),r},je=(o,e={require:!1,persist:!1})=>{let{require:t,persist:n}=e;return!Ue&&Object.keys(ds).length===0&&!t?!0:(o=o.toLowerCase(),ng(o,n))};function ps(o=J.search,e=P.reviewFeatures){let t="preview-date",n=new URLSearchParams(o),r=new Date(n.get(t)).getTime();return e&&!isNaN(r)&&r!==0?r:Date.now()}function ci(){let o=O("page_type"),e=O("page_kind");return o==="learn"||o==="profile"||e==="learn"&&(o==="browse"||o==="home")}var Ct=class{static get contentDir(){return f.data.contentDir}static get contentLocale(){return f.data.contentLocale}static get userDir(){return f.data.userDir}static get userLocale(){return f.data.userLocale}static get hasLocSideBySideTranslation(){return O("enable_loc_sxs")==="true"||O("bilingual_type")==="hover over"}static get translationType(){return O("ms.translationtype")?.toUpperCase()}static get machineTranslated(){return this.translationType?/^(?:MT|MTE|MTE75|MTE95)$/i.test(this.translationType):!1}},gn=class{static get brand(){return f.data.brand}static get kind(){return O("page_kind")}static get type(){return O("page_type")}static get template(){return f.data.pageTemplate}};var ce=rg();function rg(){return{accountLinking:P.accessLevel!=="isolated"&&je("account-linking",{require:!0}),apiBrowser:P.accessLevel!=="isolated"||location.hostname==="isolated-dev.docs.microsoft.com",applicationInsights:ci()&&P.accessLevel!=="isolated",assessments:P.accessLevel!=="isolated",assessmentBranches:P.accessLevel!=="isolated"&&P.supportLevel==="production"&&P.reviewFeatures,azureNotebooks:P.accessLevel!=="isolated",banner:!P.legacyHosting,binaryRating:P.accessLevel!=="isolated"&&f.data.hasBinaryRating,blogComments:P.accessLevel!=="isolated",blogHome:P.accessLevel!=="isolated",certDashboard:P.accessLevel!=="isolated"&&je("cert-dashboard",{require:!0}),chromeless:f.data.context.chromeless,codeSamples:P.accessLevel!=="isolated",contentBrowse:P.accessLevel!=="isolated"||je("isolated-contentbrowse",{require:!0}),contentHeaderUpdate:je("content-header-update")&&!je("disable-content-header-update",{require:!0}),cookieConsent:P.accessLevel!=="isolated",courseScheduling:P.accessLevel!=="isolated",feedbackReport:P.accessLevel!=="isolated"&&f.data.showFeedbackReport,gamification:P.accessLevel!=="isolated",gitContributors:P.accessLevel!=="isolated",githubIssues:P.accessLevel!=="isolated"&&f.data.hasGithubIssues,inlineFeedback:P.accessLevel!=="isolated",interactivity:P.accessLevel!=="isolated",knowledgeCheck:P.accessLevel!=="isolated"&&je("knowledge-check",{require:!0}),labsOnDemand:P.accessLevel!=="isolated",marketing:P.accessLevel!=="isolated",moduleUnitFeedbackReport:P.accessLevel!=="isolated",oneCustomerVoiceFeedback:P.accessLevel!=="isolated",oneDS:P.accessLevel!=="isolated",pageRecommendations:P.accessLevel!=="isolated"&&O("recommendations")!=="false"&&(O("page_type")==="conceptual"||f.data.pageTemplate==="FAQ"||f.data.pageTemplate==="Architecture"||f.data.pageTemplate==="Reference"||f.data.pageTemplate==="Sample"),pdfDownload:P.accessLevel!=="isolated",previewRailInThisArticle:je("rail-in-this-article",{require:!0,persist:!1}),qna:P.accessLevel!=="isolated",rss:P.accessLevel!=="isolated",sandbox:P.accessLevel!=="isolated",shareLink:P.accessLevel!=="isolated",siteSearchProducts:je("site-search-products",{require:!0}),stayCurrentAllowParam:P.accessLevel!=="isolated"&&P.reviewFeatures&&(O("page_kind")==="certification"||O("page_kind")==="certificationrenewal"||O("page_kind")==="certificationRenewalAssessment"||O("page_kind")==="certificationRenewalAssessmentReport"),starRatings:P.accessLevel!=="isolated",surveyPopover:P.accessLevel!=="isolated"&&(location.hostname.endsWith("docs.microsoft.com")||cn),temporaryClientSideEventBanners:P.legacyHosting&&(location.origin.endsWith("docs.microsoft.com")||location.origin.endsWith("developer.microsoft.com")),tocSearch:f.data.brand!=="mooncake",transcript:P.accessLevel!=="isolated"&&je("transcript",{require:!0}),translationFeedback:P.accessLevel!=="isolated"&&f.data.userLocale!=="en-us"&&O("ocv-translation-feedback")==="true"&&Ct.machineTranslated,userServices:P.accessLevel!=="isolated",recommendationContentBaseModel:P.accessLevel!=="isolated"&&je("content-base",{require:!0})}}var li="You have signed in with an account associated to an organization ({email}). By becoming a member, <strong>you understand and acknowledge</strong> that your Microsoft Docs membership means our network of sites and applications will record and track your achievements and activities and we may share your results and activities with your organization. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.",ui="About";var di="Answers";var pi="Are you sure?",mi="Deleting your data cannot be undone.";var ms="Back to prior menu";var jn="Blog";var gi="Remove bookmark for {title}",fi="Add bookmark for {title}";var Qt="Cancel";var Qe="Close";var hi="Code of Conduct";var ko="Code Samples";var _i='Add <span class="font-weight-semibold">"{pageName}"</span> to:',xi='<a href="{url}" class="has-text-tertiary-invert text-decoration-underline">Collections</a> Updated';var bi='A collection already exists with the title "{title}". Collection titles should be unique.',vi="Title is required and up to 80 characters long.",yi="Description is optional and up to 200 characters long.",Ti='Collections may be publicly viewable. <a href="/learn/support/faq?pivots=general#what-is-a-collection" >Learn more</a>',Si="{userDisplayName}'s Collection {index}";var wi="Favorites";var Ci='Removed from <a href="{url}" class="has-text-tertiary-invert text-decoration-underline">{collectionName}</a>',Ei='Removed from <a href="{url}" class="has-text-tertiary-invert text-decoration-underline">Collections</a>',gs="Save to a collection",ki='Saved to <a href="{url}" class="has-text-tertiary-invert text-decoration-underline">{collectionName}</a>',Ai='Saved to <a href="{url}" class="has-text-tertiary-invert text-decoration-underline">Collections</a>';var Ii="Please sign in to add this to your collection.",Ri="Manage {title} in collections",Pi="Add {title} to a collection",Li="You can find this collection in your Learn profile";var Mi="By becoming a member, you understand and acknowledge that your Microsoft Docs membership means our network of sites and applications will record and track your achievements and activities. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.";var Ni="Dark";var zi="Delete";var Di="Description";var Ao="Dismiss alert";var Oi="Dismiss";var Et="Documentation";var Ui="FAQ";var Fi="Feedback",Hi="Feedback Comment";var qi="Find posts, tags, and users";var Qn="Global",fs="Global navigation";var Bi="Go back";var $i="High contrast",Vi="Home";var hs="This link can be accessed from the internet but not from disconnected or air-gapped cloud services.";var Gi="Learn";var Io="Events";var Ro="Shows";var Ki="Light";var _s="Loading...";var Wi="Manage cookies";var Yi="Microsoft Employee",ji="Microsoft Employee Privacy Notice",Qi="You have signed in with an account associated to an organization ({email}). By becoming a member, <strong>you understand and acknowledge</strong> that your Microsoft Docs membership means our network of sites and applications will record, and track your achievements and activities and we may share your results and activities with your organization. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.",fn="Microsoft for Startups";var Ji="Microsoft Privacy Notice",Xi="You need to agree with the Microsoft Privacy Notice to keep your profile and relating data.";var Le="More";var Zi="New collection";var ec="No results found";var tc="No, thanks";var oc="Have any additional feedback? We'd love to hear it.",nc='Feedback will be sent to Microsoft. By pressing submit, your feedback will be used to improve Microsoft products and services. <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy Statement</a>.',rc="Are you satisfied with this answer?",sc='<strong class="font-weight-bold">Feedback Submitted!</strong> If you would like to rate this answer again, please reload the page. <a href="https://docs.microsoft.com/en-us/answers/articles/25853/customer-satisfaction-surveys.html">Learn More</a>';var ac="Rate 1 star (worst rating)",ic="Rate 2 stars",cc="Rate 3 stars",lc="Rate 4 stars",uc="Rate 5 stars (best rating)";var dc="OK",pc="OK, got it.";var mc="Optional";var gc="Please fill out this field.";var Jn="Preview";var fc="Privacy &amp; Cookies";var hc="Profile";var _c="Accepted";var xc="MSDN Forum",bc="Required field",vc="Type your question...",yc="Question that may already have your answer",Tc="Questions that may already have your answer",Sc="Question Title";var hn="Regional Directors";var xs="Developer";var Po="Save",wc="Saved";var lt="Search";var Cc="Search help";var Ec="Search previous versions";var _n="Settings";var Lo="Sign in";var Xn="Sign out";var kc="Site";var Ac="Cancel Search";var Ic="Skip to main content";var Rc="Something went wrong. Please try again.";var Pc="GitHub";var Lc="Stack Overflow";var Mc="Member sign in";var Nc="Manage {title} in study guides",zc="Add {title} in study guides";var Zn="Submit";var Dc="Support";var Oc="Microsoft MVP";var Uc="This profile has been locked",Fc="This profile is currently locked and is being merged with another profile. Please sign-in to a different profile.";var Hc="Your profiles have been successfully merged.",qc='We ran into a problem merging your profiles. Please contact <a href="https://docs.microsoft.com/learn/support/troubleshooting#report-feedback">customer support</a>.',Bc="Merging in progress. It may take several minutes to complete.";var $c="Sign in with a different account";var Vc="Terms of Use";var Gc="Title";var bs="Trademarks";var Kc="Votes";var Wc='<span class="font-weight-semibold">Welcome</span> to Microsoft Docs!';var Yc="You don't have any collections yet.";var jc="Your Account";var j=ig({brand:f.data.brand,pathnameSegments:ft,page_kind:O("page_kind"),page_type:O("page_type"),headerId:O("uhfHeaderId"),isAdmin:O("is_admin")}),vs=sg(j),Qc=ag(j);function sg(o){switch(o){case"Code Samples":return ko;case"Learn":case"Profile":return"Learn";case"Admin":return"Admin";case"Q&A":return"Q&A";case"Regional Directors":return hn;case"Developer":return xs;case"Events":return Io;case"Shows":return Ro;case"Startups":return fn;case"Assessments":case"Docs_Home":case"Documentation":case"Mooncake":case"Third-Party":default:return Et}}function ag(o){switch(o){case"Regional Directors":return hn;case"Developer":return xs;case"Startups":return fn;default:return"Docs"}}function ig(o){let{brand:e,pathnameSegments:t,page_kind:n,page_type:r,headerId:s,isAdmin:a}=o;if(a==="true")return"Admin";if(s==="MSDocsHeader-Archive")return"Archive";if(n==="docs"&&r==="home"||r==="welcome")return"Docs_Home";if(r==="profile")return"Profile";if(r==="locale")return"Locale";if(r==="search")return"Search";if(n==="assessments")return"Assessments";if(t[2]==="samples")return"Code Samples";if(t[2]==="legal")return"Legal";if(e==="mooncake")return"Mooncake";switch(s){case"startups":return"Startups";case"answers":return"Q&A";case"mooncake":return"Mooncake";case"MSDocsHeader-Events":return"Events";case"MSDocsHeader-Learn":return"Learn";case"MSDocsHeader-RegionalDirectors":return"Regional Directors";case"MSDocsHeader-Shows":return"Shows";case"DEV_Homeheader":case"MSDocsHeader-Advocates":case"devcenter-store-header":case"mixed-reality-header":case"win-dev-center-header":case"win-hardware-header":case"win-iot-devcenter-header":case"reactor":return"Developer";case"MSDocsHeader-DocsL1":return"Documentation";case"MSDocsHeader-Assessments":return"Assessments";default:return"Third-Party"}}function Xc(o){let e=dg();if(!(!e||e==="exclude"))for(let t of o){let n=t?.id===e;if(n){t.current=n;break}}}var lg={id:"faq-help",pattern:"/answers/articles/38069/qa-help-articles",next:{id:"users",pattern:"/answers/users/",next:{id:"tags",pattern:"/answers/topics.html",next:{id:"tags",pattern:"/answers/topics/",next:{id:"feedback",pattern:"/answers/content/idea",next:{id:"feedback",pattern:"/answers/idea",next:{id:"questions",pattern:"/answers/questions",next:{id:"questions",pattern:"/answers/index.html"}}}}}}}},ug={id:"exclude",pattern:`/${f.data.userLocale}/learn/`,exact:!0,next:{id:"products",pattern:"/learn/paths",next:{id:"products",pattern:"/learn/browse",next:{id:"roles",pattern:"/learn/roles",next:{id:"learn-tv",pattern:"/learn/tv",next:{id:"certifications",pattern:"/learn/certifications",next:{id:"faq-help",pattern:"/learn/support",next:{id:"products",pattern:"/learn/"}}}}}}}};function dg(o=O,e=j){return e==="Learn"?Jc(ug):e==="Q&A"?Jc(lg):o("activeMenuId")}function Jc(o,e=location.pathname){let t,n=o;do(n.exact?e===n.pattern:e.indexOf(n.pattern)!==-1)&&(t=n.id),n=n.next;while(n&&!t);return t}function Je(o){let e,t=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=a=>decodeURIComponent(a.replace(t," "));o===void 0&&(o=J.search),o=o.substring(1);let s={};for(;e=n.exec(o);)s[r(e[1])]=r(e[2]);return s}function Me(o,e=!1){let t=[];for(let n in o)o.hasOwnProperty(n)&&o[n]!==""&&o[n]!==null&&o[n]!==void 0&&(e&&Array.isArray(o[n])?o[n].forEach(r=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(o[n].toString())));return t.join("&")}function Zc(o=new URL(J.href)){let e=new URLSearchParams(o.search),t={};return e.forEach((n,r)=>t[r]=n),t}var pg="DEV_Homeheader",mg="MSDocsHeader-DocsL1",gg="MSDocsHeader-RegionalDirectors",fg="startups",er={Developer:pg,"Regional Directors":gg,Startups:fg};function hg(o){for(let e in er)if(o===er[e])return!0;return!1}function el(o){return o in er?er[o]:mg}function tl(){let o=O("uhfHeaderId"),e=o&&!hg(o)?o:void 0;return(P.reviewFeatures?Je()["header-id"]:void 0)||f.data.context.uhfHeaderId||e}var _g={"https://review.docs.microsoft.com":{cloudShell:"https://ux.console.azure.com",ocvFeedback:"https://petrol-int.office.microsoft.com/v1/feedback",lists:"https://review.docs.microsoft.com/api/lists"},"https://ppe.docs.microsoft.com":{cloudShell:"https://ux-rc.console.azure.com",ocvFeedback:"https://petrol-int.office.microsoft.com/v1/feedback"},"https://localhost:3000":{siteSearch:"https://ppe.docs.microsoft.com/api/search",cloudShell:"https://ux.console.azure.com"},"http://localhost:3000":{siteSearch:"https://ppe.docs.microsoft.com/api/search",cloudShell:"https://ux.console.azure.com"}},xg={"https://review.docs.microsoft.com":{stayCurrent:"https://review.docs.microsoft.com/api/certification"}};function bg(o,e){let t=e.legacyHosting?e.supportLevel==="production"?"https://docs.microsoft.com":"https://ppe.docs.microsoft.com":o,n=e.systemContent?o:t,r=_g[o]||{},s=xg[o]||{};return{admin:vg(),selfAssessmentsAdmin:Tg(),apiBrowser:`${t}/api/apibrowser`,assessments:`${n}/api/assessments`,assessmentsBranch:"https://review.docs.microsoft.com/api/assessments/branches",azureManagement:"https://management.azure.com",auth:{docs:`${t}/api/profiles/auth`,identityPlatform:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",signOut:`${t}/api/profiles/signout`,token:"https://token.docs.microsoft.com"},blogs:`${t}/api/archives/blogs/comments`,browse:{certification:`${t}/api/contentbrowser/search/certifications`,course:`${t}/api/contentbrowser/search/certifications/courses`,events:`${t}/api/contentbrowser/search/events`,learn:`${t}/api/contentbrowser/search`,learnHome:`${t}/api/contentbrowser/home/learn`,learnHomePersonalized:`${t}/api/contentbrowser/home/personalized/learn`,sample:`${t}/api/contentbrowser/search/samples`,lifecycle:`${t}/api/contentbrowser/search/lifecycles`,architecture:`${t}/api/contentbrowser/search/architectures`,windowsSafeguards:`${t}/api/contentbrowser/search/windowsSafeguards`,shows:`${t}/api/contentbrowser/search/shows`},buildAuthAdmin:Sg(),certification:{appointments:`${t}/api/certification/appointments`,certifications:`${t}/api/certification/certifications`,dashboardSummary:`${t}/api/certification/dashboardsummary`,exams:`${t}/api/certification/exams`,linkedAccount:`${t}/api/certification/linkedAccount`,linkedMcId:`${t}/api/certification/linkedMcId`,renewalAssessments:`${t}/api/certification/scoredsnapshots`},cloudShell:"https://ux.console.azure.com",contentNav:o,contentOrigin:n,forumSearch:{azureKbQuestionSuggestions:`${t}/api/qna/azurekb/searchMSDNThreads/v1.0`,forumInternalQuestionSuggestions:`${t}/answers/search.json`},gameStatus:`${t}/api/gamestatus`,github:"https://api.github.com",labOnDemand:`${t}/api/resources/labondemand`,learn:{achievementsByUids:`${t}/api/hierarchy/achievements`,batchItemSummaries:`${t}/api/hierarchy/items`,certification:`${t}/api/hierarchy/certification`,challenge:`${t}/api/challenges`,episode:`${t}/api/video/public/v1/entries`,iltCourses:{scheduling:`${t}/api/wwl/ilt-scheduling/offerings`,location:`${t}/api/wwl/ilt-scheduling/offerings/location`},learningPath:`${t}/api/hierarchy/paths`,module:`${t}/api/hierarchy/modules`,progress:{batchUnit:`${t}/api/progress/units`,unit:`${t}/api/progress/units`,user:`${t}/api/progress`},show:{episodes:`${t}/api/hierarchy/shows`,videos:`${t}/api/video/public/v1/entries/batch`},stayCurrent:`${t}/api/certification`,tvSchedule:"https://learntvpublicschedule.azureedge.net/public/schedule.json",pubbleAuth:`${t}/api/profiles/auth/pubble`,...s},lists:`${t}/api/lists`,monikers:e.accessLevel==="isolated"?`${n}/api/familyTrees`:`${n}/_api/familyTrees`,nextSteps:`${t}/api/nextsteps`,ocvFeedback:"https://petrol.office.microsoft.com/v1/feedback",privacy:{cookieConsentDeleteService:`${o}/api/privacy/cookieDelete`,delete:`${n}/api/privacy/delete`,partialDelete:`${n}/api/privacy/partialdelete`,export:`${n}/api/privacy/export`},profile:{acknowledgeMergeStatus:`${t}/api/profiles/merge/acknowledge`,acknowledgePrivacyNotice:`${t}/api/profiles/me/acknowledgePrivacyNotice`,avatar:`${t}/api/profiles/me/avatar`,avert:`${t}/api/profiles/avert`,certification:`${t}/api/profiles/certification/certifications`,challenge:`${t}/api/profiles/challenge`,link:`${t}/api/profiles/link`,me:`${t}/api/profiles/me`,merge:`${t}/api/profiles/merge`,profiles:`${t}/api/profiles`,qnaFollowing:`${t}/api/qna/following`,reporting:`${t}/api/profiles/reporting`,validateMerge:`${t}/api/profiles/merge/validate`,transcript:{private:`${t}/api/profiles/transcript/me`,public:`${t}/api/profiles/transcript/share`,settings:{publicLink:`${t}/api/profiles/transcript/share`,transcript:`${t}/api/profiles/transcript/me/settings`}},achievement:`${t}/api/gamestatus/achievement`},qna:{tags:"https://ppe.docs.microsoft.com/api/questions/tags/autocomplete"},qnaSettings:`${t}/en-us/answers/users/{qnaId}/{username}/preferences.html`,rating:`${t}/api/rating`,recommendations:`${t}/api/recommendations`,sandbox:`${t}/api/resources/sandbox`,siteFeedback:`${t}/api/feedback/report`,siteSearch:`${o}/api/search`,uhf:{consentBanner:`${t}/api/GetConsentBanner`},video:yg(),...r}}function vg(){return ct?"https://review.docs.microsoft.com/api/admin":ln?"https://docs.microsoft.com/api/admin":"https://ppe.docs.microsoft.com/api/admin"}function yg(){return ct||ln?"https://docs-adminservice1-public-wus.azurewebsites.net":"https://docs-adminservice-pubdev-wus.azurewebsites.net"}function Tg(){return"https://docs-rcs-pubdev.azurewebsites.net"}function Sg(){return ct||ln?"https://docs-buildauth-public-wus.azurewebsites.net":"https://docs-buildauth-pubdev-wus.azurewebsites.net"}var te=bg(location.origin,P);function Jt(o=["api-branch","branch"],e=""){if(P.accessLevel==="local")return"main";if(P.reviewFeatures===!0){let t=Je(J.search);return o.reduce((n,r)=>n||t[r],void 0)||e}return null}function ys(o){return decodeURIComponent(atob(wg(o).replace(/_/g,"/").replace(/-/g,"+")).split("").map(e=>`%${("00"+e.charCodeAt(0).toString(16)).slice(-2)}`).join(""))}function wg(o){switch(o.length%4){case 0:return o;case 2:return o+"==";case 3:return o+"=";default:throw new Error("Illegal base64url string!")}}var Ss="id_token",ws="docsAuthToken",tr=class{constructor({detail:e}){this.message="invalid token",this.detail=e}},kt=class{constructor({detail:e}){this.message="invalid claim",this.detail=e}},Ts=class{constructor({detail:e}){this.message="malformed claim",this.detail=e}};function ol(o){re.setItem(Ss,o)}function Xt(){return re.getItem(Ss)}function or(){re.removeItem(Ss)}function nr(o){re.setItem(ws,o)}function Zt(){return re.getItem(ws)}function nl(){re.removeItem(ws)}function eo(o,e={nbfClockSkewInMilliseconds:2500}){try{if(!(o&&o.length&&o.indexOf(".")>-1))throw new tr({detail:"Invalid JWT - no separators found."});let n=o.split("."),r=JSON.parse(ys(n[1]));if(!r)throw new tr({detail:"Invalid JWT - payload is missing."});if(r.hasOwnProperty("nbf")){let s=r.nbf;if(isNaN(s))throw new Ts({detail:"Invalid NBF claim - claim is malformed."});let a=new Date(0);a.setUTCSeconds(r.nbf);let i=new Date(Date.now()+e.nbfClockSkewInMilliseconds);if(a>i)throw new kt({detail:"Invalid NBF claim - token not yet valid."})}if(r.hasOwnProperty("exp")){let s=r.exp;if(isNaN(s))throw new Ts({detail:"Invalid EXP claim - claim is malformed."});let a=new Date(0);a.setUTCSeconds(r.exp);let i=new Date(Date.now());if(a<=i)throw new kt({detail:"Invalid EXP claim - token has expired."})}return r}finally{}}var rl=o=>{if(!(o&&o.length&&o.indexOf(".")>-1))throw new tr({detail:"Invalid JWT - no separators found."});let t=o.split(".");return JSON.parse(ys(t[1]))};var Cg=30*1e3,B=async(o,e)=>{e=e||{};let t=new AbortController;e.signal=t.signal;let n=setTimeout(()=>t.abort(),Cg),r=await fetch(o,e);return clearTimeout(n),r};function Z(o,e,t=!0){e=e||{},e.mode="cors",t&&!e.credentials&&(e.credentials="omit");let n=new Request(o,e);return t&&Zt()&&n.headers.set("Authorization",`Bearer ${Zt()}`),(n.method==="PUT"||n.method==="POST")&&n.headers.set("Content-Type","application/json"),n}async function Cs(o,e=f.data.userLocale){let t={branch:Jt(["contentnav-branch"],"main")},n="content-nav",r=`${te.contentNav}/${e}/${n}/${o}.json?${Me(t)}`,s=await B(r,{credentials:"include"});if(!s.ok){let i=new Error(`Content navigation JSON not found for ${o} in ${e}.`);return i.headerId=o,console.error(i),null}let a=await s.json();return P.accessLevel==="isolated"&&o==="azure"&&a.callToAction&&a.callToAction.secondary&&a.callToAction.secondary.href.toLowerCase().indexOf("portal.azure.com")!==-1&&(a.callToAction.secondary.href=`https://${P.azurePortalHostname}`),a.items.push({kind:"menu",title:Le,items:[]}),a}var xn=ce.userServices&&j!=="Developer"&&j!=="Startups"&&j!=="Regional Directors",rr=j==="Third-Party"||j==="Developer"||j==="Assessments"||j==="Learn"||j==="Mooncake"||j==="Q&A";var{userLocale:to}=f.data,sl={category:{kind:"link",href:`/${to}/`,title:"Developer"},items:[{kind:"link",href:`https://docs.microsoft.com/${to}/`,title:Et},{kind:"link",href:`https://docs.microsoft.com/${to}/learn/`,title:"Learn"},{kind:"link",href:`https://docs.microsoft.com/${to}/answers/products/`,title:"Q&A"},{kind:"link",href:`https://docs.microsoft.com/${to}/samples/browse/`,title:ko},{kind:"link",href:`https://docs.microsoft.com/${to}/shows/`,title:Ro},{kind:"link",href:`https://docs.microsoft.com/${to}/events/`,title:Io},{kind:"menu",title:Le,items:[]}],cookieBanner:null};var{userLocale:At}=f.data,No=location.hostname.endsWith("docs.azure.cn"),Mo=No?"https://docs.microsoft.com":"",al={category:{kind:"link",href:`/${At}/`,title:"Docs"},items:[...No?[]:[{kind:"link",href:`${Mo}/${At}/documentation`,title:Et}],{kind:"link",href:`${Mo}/${At}/learn/`,title:"Learn"},...ce.qna&&!No?[{kind:"link",href:`${Mo}/${At}/answers/products/`,title:"Q&A"}]:[],...ce.codeSamples&&!No?[{kind:"link",href:`${Mo}/${At}/samples/browse/`,title:ko}]:[],...No?[{kind:"link",href:`https://support.azure.cn/${At}/support/contact/`,title:Dc}]:[],{kind:"link",href:`${Mo}/${At}/shows/`,title:Ro},{kind:"link",href:No?"https://chinaevent.microsoft.com/events":`${Mo}/${At}/events/`,title:Io},{kind:"menu",title:Le,items:[]}],cookieBanner:null};var{userLocale:il}=f.data,cl={category:{kind:"link",href:`/${il}/`,title:hn},items:[{kind:"link",href:`/${il}/about/`,title:ui},{kind:"menu",title:Le,items:[]}],cookieBanner:null};var ll={category:{kind:"link",href:"/",title:fn},items:[{kind:"link",href:"https://docs.microsoft.com/en-us/learn/topics/startups",title:Gi},{kind:"link",href:"/blog/",title:jn},{kind:"menu",title:Le,items:[]}],callToAction:{primary:{kind:"link",href:"https://portal.startups.microsoft.com/",title:Mc}},cookieBanner:null};var ul={DEV_Homeheader:sl,"MSDocsHeader-DocsL1":al,"MSDocsHeader-RegionalDirectors":cl,startups:ll};function dl(o){return o in ul?ul[o]:null}var oo,Xe,pl,ar=new Promise(o=>pl=o),Es,ks=new Promise(o=>Es=o),sr,bn=new Promise(o=>sr=o);async function ml(){await Promise.all([ks,bn]),pl()}async function gl(){let o=el(j),e=dl(o);if(e){oo=e,Es();return}oo=await Cs(o),Es()}async function fl(){if(!rr){Xe=null,sr();return}let o=tl();if(!o){Xe=null,sr();return}Xe=await Cs(o),Xe&&Xc(Xe.items),sr()}var Eg="<wbr>",Gb=`$1${Eg}$2`;var kg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hl=/[&<>"']/g,Ag=RegExp(hl.source);function vn(o){return o&&Ag.test(o)?o.replace(hl,e=>kg[e]):o}function _l(o,e={year:"numeric",month:"short",day:"numeric"},t=f.data.userLocale){return new Date(o).toLocaleDateString(t,e).replace(/\u200E/g,"")}var It=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="none"><circle cx="16" cy="16" r="16" fill="#F4F5F6"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.11865 26.7162C6.1436 22.1697 10.7016 19 16 19C21.2983 19 25.8564 22.1697 27.8813 26.7162C24.9531 29.9608 20.7147 32 16 32C11.2853 32 7.04689 29.9608 4.11865 26.7162ZM23 10C23 13.866 19.866 17 16 17C12.134 17 8.99999 13.866 8.99999 10C8.99999 6.13401 12.134 3 16 3C19.866 3 23 6.13401 23 10Z" fill="#B8B9BA"/></svg>')}`,Zb=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 448"><path fill="#919191" d="M277.733 252.81c31.966-18.644 53.742-52.923 53.742-92.527 0-59.267-48.22-107.475-107.475-107.475-59.267 0-107.475 48.208-107.475 107.475 0 39.604 21.77 73.884 53.738 92.528C112.35 274.105 72 328.998 72 395.193h24.566c0-71.466 55.98-127.434 127.434-127.434 72.64 0 127.434 54.793 127.434 127.434H376c0-66.197-40.35-121.09-98.267-142.383zM141.09 160.282c0-45.713 37.197-82.91 82.91-82.91 45.725 0 82.91 37.197 82.91 82.91s-37.186 82.91-82.91 82.91c-45.713 0-82.91-37.197-82.91-82.91z"/></svg>')}`,ev=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="3 3 42 42"><path d="M32.5 14a1.492 1.492 0 011.5 1.5v23a1.494 1.494 0 01-1.5 1.5h-17a1.494 1.494 0 01-1.5-1.5v-23a1.494 1.494 0 011.5-1.5h4.873l-3-6h2.25l3 6h2.751l3-6h2.25l-3 6zm-.5 2h-8.377l1.266 2.546A1.13 1.13 0 0125 19a1.009 1.009 0 01-1 1 1 1 0 01-.534-.149.974.974 0 01-.368-.4L21.375 16H16v22h16zM20 26a3.92 3.92 0 01.312-1.555 4.023 4.023 0 012.133-2.133 4.041 4.041 0 013.109 0 4.014 4.014 0 012.133 2.133A3.886 3.886 0 0128 26a3.937 3.937 0 01-.288 1.485 3.987 3.987 0 01-.8 1.266 5.7 5.7 0 011.288.949 5.907 5.907 0 01.968 1.251 6.388 6.388 0 01.616 1.461A5.786 5.786 0 0130 34h-2a3.877 3.877 0 00-.312-1.554 4 4 0 00-2.133-2.133 4.011 4.011 0 00-3.109 0 4.023 4.023 0 00-2.133 2.133A3.912 3.912 0 0020 33.995h-2a5.786 5.786 0 01.218-1.586 6.388 6.388 0 01.616-1.461A5.933 5.933 0 0119.8 29.7a5.694 5.694 0 011.288-.951 3.991 3.991 0 01-.8-1.267A3.945 3.945 0 0120 26zm6 0a1.92 1.92 0 00-.157-.781 2.039 2.039 0 00-1.061-1.062 2.024 2.024 0 00-1.563 0 2.048 2.048 0 00-1.061 1.062 2.021 2.021 0 000 1.562 2.042 2.042 0 001.061 1.061 2.024 2.024 0 001.563 0 2.032 2.032 0 001.061-1.061A1.927 1.927 0 0026 26z" fill="#919191"/></svg>')}`,Fe=class{},xl="72f988bf-86f1-41af-91ab-2d7cd011db47",Ig="9188040d-6c67-4c5b-b112-36a304b66dad",As={[xl]:"microsoft",[Ig]:"standard"},Is=new Date("2019-11-21T00:00:00.000Z"),He=(o,e)=>Rg(o,e).toString(),bl=class extends wt{constructor(){super();this.setAnonymous()}setAnonymous(){this.isAuthenticated!==!1&&(this.userId="00000000-0000-0000-0000-000000000000",this.upn="anonymous@anonymous.com",this.email="anonymous@anonymous.com",this.userName="Anonymous",this.displayName="Anonymous",this.locale="en-us",this.country=null,this.contactPointTopicSetting=null,this.authenticationMode="AAD",this.authenticationModes=[],this.isAuthenticated=!1,this.avatarUrl=It,this.avatarThumbnailUrl=It,this.profileUrl="#",this.createdOn=null,this.userType="standard",this.acceptedPrivacyNotice=Is,this.isAvatarTakenDown=!1,this.followerCount=0,this.followingCount=0,this.answersAccepted=0,this.isMicrosoftUser=!1,this.isMvp=!1,this.reputationPoints=1,this.qnaUserId=0,this.interests=null,this.isPrivate=!1,this.gsi=null,this.tenantId=null,this.credentialId=null,this.source=null,this.publish(new Fe))}mapIdTokenToProfile(e){this.email=e.email||e.preferred_username,this.upn=e.preferred_username,this.userName=e.name,this.displayName=e.name,this.authenticationMode=As[e.tid]==="standard"?"MSA":"AAD",this.userType=As[e.tid]||"aad",this.isAuthenticated=!0,this.country="",this.credentialId=this.authenticationMode==="AAD"?e.oid:e.puid,this.publish(new Fe)}readUserProfile(e){this.userId=e.userId,this.email=e.email||"",this.userName=e.userName,this.displayName=e.displayName||e.userName||e.email,this.locale=e.locale,this.country=e.country,this.contactPointTopicSetting=e.contactPointTopicSetting,this.isAuthenticated=!0,this.avatarUrl=e.avatarUrl||It,this.avatarThumbnailUrl=e.avatarThumbnailUrl||e.avatarUrl||It,this.profileUrl=He(e.userName),this.authenticationModes=e.authenticationModes,this.userType=Pg(e.authenticationModes),this.acceptedPrivacyNotice=new Date(e.acceptedPrivacyNotice),this.isAvatarTakenDown=e.isAvatarTakenDown,this.followingCount=e.followingCount,this.followerCount=e.followerCount,this.answersAccepted=e.answersAccepted,this.isMicrosoftUser=e.isMicrosoftUser,this.isMvp=e.isMvp,this.reputationPoints=e.reputationPoints,this.createdOn=new Date(e.createdOn),this.qnaUserId=e.qnaUserId,this.interests=e.interests,this.isPrivate=e.isPrivate,this.gsi=e.gsi,this.source=e.source,this.transcriptSettings=e.transcriptSettings,this.publish(new Fe)}readUserFromToken(e){this.isAuthenticated=!0,this.userId=e.sub,this.upn=e.cred_upn,this.tenantId=e.tid,this.credentialId=e.cred_id,this.userName=e.preferred_username,this.displayName=e.name||e.preferred_username||e.email,this.avatarUrl=e.picture||It,this.avatarThumbnailUrl=e.thumbnail||e.picture||It,this.authenticationMode=e.cred_type,this.locale=e.locale,this.acceptedPrivacyNotice=e.accepted_privacy_notice,this.userType=As[e.tid]||"aad",this.profileUrl=He(e.preferred_username),this.publish(new Fe)}whenAuthenticated(){return M.isAuthenticated?Promise.resolve():new Promise(e=>this.subscribe(Fe,()=>{this.isAuthenticated&&e()}))}},M=new bl;var vl=()=>M.userName&&M.userName!=="Anonymous";function yl(o,e){Array.from(o.querySelectorAll("[data-profile-property]")).forEach(t=>{let n=t.getAttribute("data-profile-property"),r=e.profileUrl;t instanceof HTMLImageElement&&n==="avatarUrl"?(t.onerror=()=>t.src=It,t.src=e[n]):t instanceof HTMLImageElement&&n==="avatarThumbnailUrl"?(t.onerror=()=>t.src=e.avatarUrl||It,t.src=e[n]):t instanceof HTMLAnchorElement&&n==="profileUrl"?(t.href=He("me","activity"),r==="#"&&(t.href=new URL("./register",zo()).toString())):t instanceof HTMLAnchorElement&&n==="bookmarksUrl"?(t.href=r+(Ue?"collections/bookmarks":"&section=collections&detail=bookmarks"),r==="#"&&t.parentElement.remove()):t instanceof HTMLAnchorElement&&n==="collectionsUrl"?(t.href=r+(Ue?"collections":"&section=collections"),r==="#"&&t.parentElement.remove()):t instanceof HTMLAnchorElement&&n==="settingsUrl"?t.href=He("me","settings"):t instanceof HTMLInputElement?t.type!=="file"&&(t.value=e[n]):n==="createdOn"?t.textContent=_l(e[n]):t.textContent=e[n]})}function Rg(o,e){let t=zo(),n=new URLSearchParams(J.search);if(O("page_type")==="profile"&&(n.has("section")&&t.searchParams.set("section",n.get("section")),t.hash=J.hash),!Ue)n.has("branch")&&t.searchParams.set("branch",n.get("branch")),t.searchParams.set("username",o),e&&t.searchParams.set("section",e),n.has("themebranch")&&t.searchParams.set("themebranch",n.get("themebranch")),n.has("preview")&&t.searchParams.set("preview",n.get("preview"));else{let r=`./${o}/`;e&&(r+=`${e}/`);let s=new URL(r,t);s.hash=t.hash,s.search=t.search,t=s}return t}function zo(o=f.data.userLocale){let e=new URL(`${o&&o.length?`/${o}`:""}/`,J.origin),t=new URL("./users/",e);return Ue||(t=new URL("./test/profile/profile",e)),t}function Pg(o){let e="standard";return o&&o.length&&(o.find(t=>t.tenantId===xl)!==void 0?e="microsoft":o.find(t=>t.type==="AAD")!==void 0&&(e="aad")),e}var ir=class{};function Tl(o){let e={method:"GET"},t=Z(te.auth.docs,e,!1);return t.headers.set("Authorization",`Bearer ${o}`),B(t).then(n=>{if(n.ok)return n.text();throw n.status===404||n.status===204?new ir:n.status===401?new kt({detail:"token not accepted"}):new Error(`get docs auth token failed (${n.status} ${n.statusText})`)})}function cr(o,e=!0){try{if(o.ok&&o.headers.has("Authorization")){let t=o.headers.get("Authorization");if(t){let n=eo(t);nr(t),e&&M.readUserFromToken(n)}}return o}catch{return o}}async function Sl(o){let e={method:"POST",body:JSON.stringify(o)},t=await B(Z(te.privacy.cookieConsentDeleteService,e));if(!t.ok)throw new Error(`Cookie Deletion Error ${t.status}: ${t.statusText}`)}var wl;(function(o){wl=o()})(function(){let o=function(){let t=0,n={};for(;t<arguments.length;t++){let r=arguments[t];for(let s in r)n[s]=r[s]}return n};function e(t){let n=function(r,s,a){let i;if(typeof document>"u")return;if(arguments.length>1){if(a=o({path:"/"},n.defaults,a),typeof a.expires=="number"){let p=new Date;p.setMilliseconds(p.getMilliseconds()+a.expires*864e5),a.expires=p}a.expires=a.expires?a.expires.toUTCString():"";try{i=JSON.stringify(s),/^[\{\[]/.test(i)&&(s=i)}catch{}t.write?s=t.write(s,r):s=encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),r=encodeURIComponent(String(r)),r=r.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),r=r.replace(/[\(\)]/g,escape);let u="";for(let p in a)!a[p]||(u+="; "+p,a[p]!==!0&&(u+="="+a[p]));return document.cookie=r+"="+s+u}r||(i={});let c=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;for(;d<c.length;d++){let u=c[d].split("="),p=u.slice(1).join("=");p.charAt(0)==='"'&&(p=p.slice(1,-1));try{let m=u[0].replace(l,decodeURIComponent);if(p=t.read?t.read(p,m):t(p,m)||p.replace(l,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch{}if(r===m){i=p;break}r||(i[m]=p)}catch{}}return i};return n.set=n,n.get=function(r){return n.call(n,r)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(r,s){n(r,"",o(s,{expires:-1}))},n.withConverter=e,n}return e(function(){})});var Rs=wl;function no(){window.dispatchEvent(new CustomEvent("content-update"))}var Cl=!!window.matchMedia,mv=window.matchMedia(`screen and (min-width: ${768}px), screen and (min-height: ${1024}px)`),lr=window.matchMedia(`screen and (min-width: ${1088}px)`),yn=window.matchMedia(`screen and (min-width: ${768}px)`),gv=window.matchMedia(`screen and (max-width: ${768}px)`),El=window.matchMedia("print"),Lg=window.matchMedia("(prefers-color-scheme: dark)");var kl="light",Al={light:{documentClass:"theme-light",name:"light",text:Ki,icon:"docon-sun"},dark:{documentClass:"theme-dark",name:"dark",text:Ni,icon:"docon-clear-night"},"high-contrast":{documentClass:"theme-high-contrast",name:"high-contrast",text:$i,icon:"docon-clear-night"}},Mg=Object.keys(Al),Sv=Mg.map(o=>Al[o].documentClass);var Tn,Lv=new Promise(o=>Tn=o),ro,Rl=new Promise(o=>ro=o),Il=o=>{for(let e of Object.values(o))if(!e)return!1;return!0};async function Pl(){if(!ce.cookieConsent)return;if(ce.chromeless){ro(!0),Tn();return}let o=Rs.get("MSCC")!==void 0,e=H.WcpConsent;if(e===void 0||typeof e.init!="function"){ro(!1);return}await ie;let t=document.getElementById("cookie-consent-holder"),n=Array.from(document.querySelectorAll(".manage-cookies-holder"));if(!t||!n.length){console.log("No container for cookie banner");return}e.init(f.data.userLocale,t,function(r,s){if(r!==void 0){ro(!1);return}if(!s.isConsentRequired){ro(!0),Tn();return}let a=document.createElement("button");if(a.setAttribute("data-bi-name","manageCookies"),a.textContent=Wi,n.forEach(i=>{i.appendChild(a.cloneNode(!0)).addEventListener("click",()=>{s.manageConsent()}),i.hidden=!1}),t.hidden=!1,no(),Il(s.getConsent())){ro(!0),Tn();return}ro(!1)},async function(r){if(Il(r)){Tn();return}await Sl({domain:document.location.hostname,analytics:!r.Analytics,advertising:!r.Advertising,social:!r.SocialMedia}),o&&(H.location.href=H.location.pathname+H.location.search+H.location.hash)},kl)}function Ll(o=location.hostname){return{"developer.microsoft.com":"DevCenter","dev.docs.microsoft.com":"DocsDev","docs.azure.cn":"DocsCN","docs.microsoft.com":"Docs","internal.docs.microsoft.com":"DocsInternal","ppe.docs.microsoft.com":"DocsPPE","review.docs.microsoft.com":"DocsReview","startups.microsoft.com":"supcom"}[o]||"OneDSTest"}function Ml(o=location.hostname){return{"developer.microsoft.com":"d1574ad452ea4a37a5dda6f9f1fb5ef2-b55b2da9-95eb-4cf9-a633-191aa7b0ee25-6798","dev.docs.microsoft.com":"8617064329544862a1d4dbcc1cdda9d3-079a9ef7-af43-443d-a28b-f60ba4efc9ff-7531","docs.azure.cn":"54ae4d70fff842118ff98bccfdc28deb-7f4f32ec-ae5a-4562-881c-5c0188170faf-7594","docs.microsoft.com":"c6c27850c9c24cbfae921778d2465031-4c28c161-db47-426b-9d28-733d45d05dd9-7278","internal.docs.microsoft.com":"544ac96504db48bebdddbe3cf1e1f116-e2157ba3-a60b-464f-b49b-8dd89dac355f-7571","ppe.docs.microsoft.com":"1b68dbc9b56749fca3e6f2db2a7ff3f5-b0e31456-1fc6-40de-ad91-dad67a5c6e9e-7319","review.docs.microsoft.com":"d94fc739fadb4805bce966a4f24e2e21-a6b89116-ce98-4ffb-b1cf-d46e361ea690-7616","rd.microsoft.com":"066aa48b4fe64bd5aa1bfee3086793b0-2a9b1be5-d541-4bf6-9c2e-a5263feed23c-7531","startups.microsoft.com":"228c4e4af6ee4420925f1fa5cfd7dd7b-3090334e-ee46-4cbb-b357-8316634c0ed9-7369"}[o]||""}var Nl=!1;var Ng={audience:"aud",author:"author",manager:"manager","ms.assetid":"asst","ms.author":"pgauth","ms.contentsource":"pgpubl","ms.custom":"custom","ms.date":"date",depot_name:"depotname","ms.devlang":"pgdevlng",gitcommit:"gitcommit",original_content_git_url:"giturl",updated_at:"publishtime","ms.lasthandoff":"lasthandoff","ms.locfileid":"locfileid","ms.prod":"product","ms.reviewer":"reviewer","ms.service":"pgsrvcs","ms.suite":"suite","ms.technology":"technology","ms.tgt_pltfrm":"pgtrgtplf","ms.topic":"pgtop","ms.workload":"workload","ms.search.region":"searchregion","ms.prod_service":"prod_service","ms.component":"component",experimental:"experimental",experiment_id:"experiment_id","ms.assigned_experiments":"assigned_experiments","ms.translationtype":"translationtype",document_version_independent_id:"document_version_independent_id","ms.collection":"collection","ms.subservice":"subservice"};function ur(o){let e=document.querySelectorAll("meta");for(let t=0;t<e.length;t++){let n=e.item(t),r=Ng[n.name];n.name==="ms.collection"||n.name==="ms.custom"?o[r]=o[r]?`${o[r]},${n.content}`:n.content:r&&(o[r]=n.content)}o.contentlocale=f.data.contentLocale,o.highContrast=Nl.toString()}var zl;async function Dl(){let o=window.awa;if(!ce.oneDS||!o)return;let e=await Rl;zg(o,e),zl(o)}function zg(o,e){let t={instrumentationKey:Ml(),useShortNameForContentBlob:!1,syncMuid:e,urlCollectHash:!0,urlCollectQuery:!0,autoCapture:{pageView:!0,onLoad:!0,click:!0,scroll:!0,resize:!0,jsError:!0,addin:!0,msTags:!1,perf:!0,assets:!1,lineage:!0},coreData:{appId:Ll(),pageName:O("document_id")||"missing document_id",market:f.data.userLocale,pageType:O("page_type"),pageTags:{}},callback:{signedinStatus:()=>M.isAuthenticated,pageViewPageTags:dr,pageActionPageTags:dr,contentUpdatePageTags:dr,pageActionContentTags:dr},shareAuthStatus:!0,isLoggedIn:!1};ur(t.coreData.pageTags),o.init(t)}function dr(){return M.isAuthenticated?{"ext-app-user-id":`c:${M.userId}`}:{}}var Rt=new Promise(o=>zl=o);var Ae={CLICKLEFT:"CL",CLICKRIGHT:"CR",CLICKMIDDLE:"CM",SCROLL:"S",ZOOM:"Z",RESIZE:"R",KEYBOARDENTER:"KE",KEYBOARDSPACE:"KS",GAMEPADA:"CGA",GAMEPADMENU:"CGM",OTHER:"O",AUTO:"A"},we={UNDEFINED:0,NAVIGATIONBACK:1,NAVIGATION:2,NAVIGATIONFORWARD:3,APPLY:4,REMOVE:5,SORT:6,EXPAND:7,REDUCE:8,CONTEXTMENU:9,TAB:10,COPY:11,EXPERIMENTATION:12,PRINT:13,SHOW:14,HIDE:15,MAXIMIZE:16,MINIMIZE:17,BACKBUTTON:18,STARTPROCESS:20,PROCESSCHECKPOINT:21,COMPLETEPROCESS:22,SCENARIOCANCEL:23,DOWNLOADCOMMIT:40,DOWNLOAD:41,SEARCHAUTOCOMPLETE:60,SEARCH:61,SEARCHINITIATE:62,TEXTBOXINPUT:63,PURCHASE:80,ADDTOCART:81,VIEWCART:82,ADDWISHLIST:83,FINDSTORE:84,CHECKOUT:85,REMOVEFROMCART:86,PURCHASECOMPLETE:87,VIEWCHECKOUTPAGE:88,VIEWCARTPAGE:89,VIEWPDP:90,UPDATEITEMQUANTITY:91,INTENTTOBUY:92,PUSHTOINSTALL:93,SIGNIN:100,SIGNOUT:101,SOCIALSHARE:120,SOCIALLIKE:121,SOCIALREPLY:122,CALL:123,EMAIL:124,COMMUNITY:125,SOCIALFOLLOW:126,VOTE:140,SURVEYINITIATE:141,SURVEYCOMPLETE:142,REPORTAPPLICATION:143,REPORTREVIEW:144,SURVEYCHECKPOINT:145,CONTACT:160,REGISTRATIONINITIATE:161,REGISTRATIONCOMPLETE:162,CANCELSUBSCRIPTION:163,RENEWSUBSCRIPTION:164,CHANGESUBSCRIPTION:165,REGISTRATIONCHECKPOINT:166,CHATINITIATE:180,CHATEND:181,TRIALSIGNUP:200,TRIALINITIATE:201,SIGNUP:210,FREESIGNUP:211,PARTNERREFERRAL:220,LEARNLOWFUNNEL:230,LEARNHIGHFUNNEL:231,SHOPPINGINTENT:232,VIDEOSTART:240,VIDEOPAUSE:241,VIDEOCONTINUE:242,VIDEOCHECKPOINT:243,VIDEOJUMP:244,VIDEOCOMPLETE:245,VIDEOBUFFERING:246,VIDEOERROR:247,VIDEOMUTE:248,VIDEOUNMUTE:249,VIDEOFULLSCREEN:250,VIDEOUNFULLSCREEN:251,VIDEOREPLAY:252,VIDEOPLAYERLOAD:253,VIDEOPLAYERCLICK:254,VIDEOVOLUMECONTROL:255,VIDEOAUDIOTRACKCONTROL:256,VIDEOCLOSEDCAPTIONCONTROL:257,VIDEOCLOSEDCAPTIONSTYLE:258,VIDEORESOLUTIONCONTROL:259,VIRTUALEVENTJOIN:260,VIRTUALEVENTEND:261,IMPRESSION:280,CLICK:281,RICHMEDIACOMPLETE:282,ADBUFFERING:283,ADERROR:284,ADSTART:285,ADCOMPLETE:286,ADSKIP:287,ADTIMEOUT:288,OTHER:300},pr={id:"data-bi-id",name:"data-bi-name",type:"data-bi-type",scenario:"data-bi-scn",scenarioStep:"data-bi-scnstp",scenarioStepNumber:"data-bi-subnm",satisfaction:"data-bi-sat"};var Ps=o=>{for(;o&&o.hasAttribute&&!o.hasAttribute(pr.name);)o=o.parentElement;return o?o.getAttribute(pr.name):""},Ol=()=>{Rt.then(o=>{o.sku.getAuthExtension().signOut()})},Ul=(o,e)=>{Rt.then(t=>{let n=t.sku.getAuthExtension();if(!e){n.setAuthType(0);return}n.setAuthType(o==="MSA"?1:o==="AAD"?2:0)})},Fl=o=>{Rt.then(e=>e.extendCoreData(o))},Sn=(o,e)=>{Rt.then(t=>t.ct.capturePageAction(o,e))},Ne=o=>{Rt.then(e=>e.ct.captureContentPageAction(o))},Ls=o=>{Rt.then(e=>e.ct.captureContentUpdate(o))},Ms=o=>{Rt.then(e=>e.ct.capturePageView(o||{}))};function Do(o=null,e=`${J.origin}${J.pathname}`){let t=o?new URL(o):new URL(e);if(t.protocol==="https:"&&(t.hostname===J.hostname||t.hostname.endsWith("docs.microsoft.com")))return t;let n=`${J.origin}${J.pathname}`;return e===n?new URL(`${t.pathname}${t.search}${t.hash}`,`${J.origin}`):Do(e)}var Ns=function(o,e){return Ns=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},Ns(o,e)};function oe(o,e){Ns(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Q=function(){return Q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Q.apply(this,arguments)};function b(o,e,t,n){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function i(d){try{l(n.next(d))}catch(u){a(u)}}function c(d){try{l(n.throw(d))}catch(u){a(u)}}function l(d){d.done?s(d.value):r(d.value).then(i,c)}l((n=n.apply(o,e||[])).next())})}function v(o,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,r,s,a;return a={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(l){return function(d){return c([l,d])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(o,t)}catch(d){l=[6,d],r=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Dg(o,e){var t=typeof Symbol=="function"&&o[Symbol.iterator];if(!t)return o;var n=t.call(o),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(i){a={error:i}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function mr(){for(var o=[],e=0;e<arguments.length;e++)o=o.concat(Dg(arguments[e]));return o}var zs=function(o,e){return zs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},zs(o,e)};function le(o,e){zs(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var me=function(){return me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},me.apply(this,arguments)};function z(o,e,t,n){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function i(d){try{l(n.next(d))}catch(u){a(u)}}function c(d){try{l(n.throw(d))}catch(u){a(u)}}function l(d){d.done?s(d.value):r(d.value).then(i,c)}l((n=n.apply(o,e||[])).next())})}function D(o,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,r,s,a;return a={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(l){return function(d){return c([l,d])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(o,t)}catch(d){l=[6,d],r=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Pt(){for(var o=0,e=0,t=arguments.length;e<t;e++)o+=arguments[e].length;for(var n=Array(o),r=0,e=0;e<t;e++)for(var s=arguments[e],a=0,i=s.length;a<i;a++,r++)n[r]=s[a];return n}var _={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},xt=[_.OPENID_SCOPE,_.PROFILE_SCOPE,_.OFFLINE_ACCESS_SCOPE],Ds=Pt(xt,[_.EMAIL_SCOPE]),qe;(function(o){o.CONTENT_TYPE="Content-Type",o.RETRY_AFTER="Retry-After",o.CCS_HEADER="X-AnchorMailbox",o.WWWAuthenticate="WWW-Authenticate",o.AuthenticationInfo="Authentication-Info"})(qe||(qe={}));var fe;(function(o){o.ID_TOKEN="idtoken",o.CLIENT_INFO="client.info",o.ADAL_ID_TOKEN="adal.idtoken",o.ERROR="error",o.ERROR_DESC="error.description",o.ACTIVE_ACCOUNT="active-account"})(fe||(fe={}));var wn;(function(o){o.COMMON="common",o.ORGANIZATIONS="organizations",o.CONSUMERS="consumers"})(wn||(wn={}));var G;(function(o){o.CLIENT_ID="client_id",o.REDIRECT_URI="redirect_uri",o.RESPONSE_TYPE="response_type",o.RESPONSE_MODE="response_mode",o.GRANT_TYPE="grant_type",o.CLAIMS="claims",o.SCOPE="scope",o.ERROR="error",o.ERROR_DESCRIPTION="error_description",o.ACCESS_TOKEN="access_token",o.ID_TOKEN="id_token",o.REFRESH_TOKEN="refresh_token",o.EXPIRES_IN="expires_in",o.STATE="state",o.NONCE="nonce",o.PROMPT="prompt",o.SESSION_STATE="session_state",o.CLIENT_INFO="client_info",o.CODE="code",o.CODE_CHALLENGE="code_challenge",o.CODE_CHALLENGE_METHOD="code_challenge_method",o.CODE_VERIFIER="code_verifier",o.CLIENT_REQUEST_ID="client-request-id",o.X_CLIENT_SKU="x-client-SKU",o.X_CLIENT_VER="x-client-VER",o.X_CLIENT_OS="x-client-OS",o.X_CLIENT_CPU="x-client-CPU",o.X_CLIENT_CURR_TELEM="x-client-current-telemetry",o.X_CLIENT_LAST_TELEM="x-client-last-telemetry",o.X_MS_LIB_CAPABILITY="x-ms-lib-capability",o.POST_LOGOUT_URI="post_logout_redirect_uri",o.ID_TOKEN_HINT="id_token_hint",o.DEVICE_CODE="device_code",o.CLIENT_SECRET="client_secret",o.CLIENT_ASSERTION="client_assertion",o.CLIENT_ASSERTION_TYPE="client_assertion_type",o.TOKEN_TYPE="token_type",o.REQ_CNF="req_cnf",o.OBO_ASSERTION="assertion",o.REQUESTED_TOKEN_USE="requested_token_use",o.ON_BEHALF_OF="on_behalf_of",o.FOCI="foci",o.CCS_HEADER="X-AnchorMailbox",o.RETURN_SPA_CODE="return_spa_code",o.LOGOUT_HINT="logout_hint"})(G||(G={}));var so;(function(o){o.ACCESS_TOKEN="access_token",o.XMS_CC="xms_cc"})(so||(so={}));var tt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"},Oo;(function(o){o.ACCOUNT="account",o.SID="sid",o.LOGIN_HINT="login_hint",o.ID_TOKEN="id_token",o.DOMAIN_HINT="domain_hint",o.ORGANIZATIONS="organizations",o.CONSUMERS="consumers",o.ACCOUNT_ID="accountIdentifier",o.HOMEACCOUNT_ID="homeAccountIdentifier"})(Oo||(Oo={}));var Os={PLAIN:"plain",S256:"S256"},ao;(function(o){o.QUERY="query",o.FRAGMENT="fragment",o.FORM_POST="form_post"})(ao||(ao={}));var Uo;(function(o){o.IMPLICIT_GRANT="implicit",o.AUTHORIZATION_CODE_GRANT="authorization_code",o.CLIENT_CREDENTIALS_GRANT="client_credentials",o.RESOURCE_OWNER_PASSWORD_GRANT="password",o.REFRESH_TOKEN_GRANT="refresh_token",o.DEVICE_CODE_GRANT="device_code",o.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"})(Uo||(Uo={}));var Ze;(function(o){o.MSSTS_ACCOUNT_TYPE="MSSTS",o.ADFS_ACCOUNT_TYPE="ADFS",o.MSAV1_ACCOUNT_TYPE="MSA",o.GENERIC_ACCOUNT_TYPE="Generic"})(Ze||(Ze={}));var he;(function(o){o.CACHE_KEY_SEPARATOR="-",o.CLIENT_INFO_SEPARATOR="."})(he||(he={}));var V;(function(o){o.ID_TOKEN="IdToken",o.ACCESS_TOKEN="AccessToken",o.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",o.REFRESH_TOKEN="RefreshToken"})(V||(V={}));var ut;(function(o){o.ACCOUNT="Account",o.CREDENTIAL="Credential",o.ID_TOKEN="IdToken",o.ACCESS_TOKEN="AccessToken",o.REFRESH_TOKEN="RefreshToken",o.APP_METADATA="AppMetadata",o.TEMPORARY="TempCache",o.TELEMETRY="Telemetry",o.UNDEFINED="Undefined",o.THROTTLING="Throttling"})(ut||(ut={}));var Be;(function(o){o[o.ADFS=1001]="ADFS",o[o.MSA=1002]="MSA",o[o.MSSTS=1003]="MSSTS",o[o.GENERIC=1004]="GENERIC",o[o.ACCESS_TOKEN=2001]="ACCESS_TOKEN",o[o.REFRESH_TOKEN=2002]="REFRESH_TOKEN",o[o.ID_TOKEN=2003]="ID_TOKEN",o[o.APP_METADATA=3001]="APP_METADATA",o[o.UNDEFINED=9999]="UNDEFINED"})(Be||(Be={}));var En="appmetadata",Hl="client_info",Fo="1",co={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},et;(function(o){o.CONFIG="config",o.CACHE="cache",o.NETWORK="network"})(et||(et={}));var _e={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ee;(function(o){o.BEARER="Bearer",o.POP="pop",o.SSH="ssh-cert"})(ee||(ee={}));var Mt={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Us={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Cn;(function(o){o.username="username",o.password="password"})(Cn||(Cn={}));var io;(function(o){o[o.httpSuccess=200]="httpSuccess",o[o.httpBadRequest=400]="httpBadRequest"})(io||(io={}));var ht;(function(o){o.FAILED_AUTO_DETECTION="1",o.INTERNAL_CACHE="2",o.ENVIRONMENT_VARIABLE="3",o.IMDS="4"})(ht||(ht={}));var Lt;(function(o){o.CONFIGURED_MATCHES_DETECTED="1",o.CONFIGURED_NO_AUTO_DETECTION="2",o.CONFIGURED_NOT_DETECTED="3",o.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",o.AUTO_DETECTION_REQUESTED_FAILED="5"})(Lt||(Lt={}));var _t;(function(o){o.NO_CACHE_HIT="0",o.FORCE_REFRESH="1",o.NO_CACHED_ACCESS_TOKEN="2",o.CACHED_ACCESS_TOKEN_EXPIRED="3",o.REFRESH_CACHED_ACCESS_TOKEN="4"})(_t||(_t={}));var gr={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},L=function(o){le(e,o);function e(t,n,r){var s=this,a=n?t+": "+n:t;return s=o.call(this,a)||this,Object.setPrototypeOf(s,e.prototype),s.errorCode=t||_.EMPTY_STRING,s.errorMessage=n||"",s.subError=r||"",s.name="AuthError",s}return e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(gr.unexpectedError.code,gr.unexpectedError.desc+": "+t)},e}(Error);var Nt={createNewGuid:function(){var o="Crypto interface - createNewGuid() has not been implemented";throw L.createUnexpectedError(o)},base64Decode:function(){var o="Crypto interface - base64Decode() has not been implemented";throw L.createUnexpectedError(o)},base64Encode:function(){var o="Crypto interface - base64Encode() has not been implemented";throw L.createUnexpectedError(o)},generatePkceCodes:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - generatePkceCodes() has not been implemented",L.createUnexpectedError(o)})})},getPublicKeyThumbprint:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - getPublicKeyThumbprint() has not been implemented",L.createUnexpectedError(o)})})},removeTokenBindingKey:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - removeTokenBindingKey() has not been implemented",L.createUnexpectedError(o)})})},clearKeystore:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - clearKeystore() has not been implemented",L.createUnexpectedError(o)})})},signJwt:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - signJwt() has not been implemented",L.createUnexpectedError(o)})})},hashString:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Crypto interface - hashString() has not been implemented",L.createUnexpectedError(o)})})}};var S={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."}},C=function(o){le(e,o);function e(t,n){var r=o.call(this,t,n)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,e.prototype),r}return e.createClientInfoDecodingError=function(t){return new e(S.clientInfoDecodingError.code,S.clientInfoDecodingError.desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(S.clientInfoEmptyError.code,""+S.clientInfoEmptyError.desc)},e.createTokenParsingError=function(t){return new e(S.tokenParsingError.code,S.tokenParsingError.desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(S.nullOrEmptyToken.code,S.nullOrEmptyToken.desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(S.endpointResolutionError.code,S.endpointResolutionError.desc+" Detail: "+t)},e.createNetworkError=function(t,n){return new e(S.networkError.code,S.networkError.desc+" | Fetch client threw: "+n+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(S.unableToGetOpenidConfigError.code,S.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(S.hashNotDeserialized.code,S.hashNotDeserialized.desc+" Given Object: "+t)},e.createInvalidStateError=function(t,n){return new e(S.invalidStateError.code,S.invalidStateError.desc+" Invalid State: "+t+", Root Err: "+n)},e.createStateMismatchError=function(){return new e(S.stateMismatchError.code,S.stateMismatchError.desc)},e.createStateNotFoundError=function(t){return new e(S.stateNotFoundError.code,S.stateNotFoundError.desc+":  "+t)},e.createNonceMismatchError=function(){return new e(S.nonceMismatchError.code,S.nonceMismatchError.desc)},e.createNonceNotFoundError=function(t){return new e(S.nonceNotFoundError.code,S.nonceNotFoundError.desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(S.multipleMatchingTokens.code,S.multipleMatchingTokens.desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(S.multipleMatchingAccounts.code,S.multipleMatchingAccounts.desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(S.multipleMatchingAppMetadata.code,S.multipleMatchingAppMetadata.desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(S.tokenRequestCannotBeMade.code,S.tokenRequestCannotBeMade.desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(S.appendEmptyScopeError.code,S.appendEmptyScopeError.desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(S.removeEmptyScopeError.code,S.removeEmptyScopeError.desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(S.appendScopeSetError.code,S.appendScopeSetError.desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(S.emptyInputScopeSetError.code,""+S.emptyInputScopeSetError.desc)},e.createDeviceCodeCancelledError=function(){return new e(S.DeviceCodePollingCancelled.code,""+S.DeviceCodePollingCancelled.desc)},e.createDeviceCodeExpiredError=function(){return new e(S.DeviceCodeExpired.code,""+S.DeviceCodeExpired.desc)},e.createDeviceCodeUnknownError=function(){return new e(S.DeviceCodeUnknownError.code,""+S.DeviceCodeUnknownError.desc)},e.createNoAccountInSilentRequestError=function(){return new e(S.NoAccountInSilentRequest.code,""+S.NoAccountInSilentRequest.desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(S.invalidCacheRecord.code,S.invalidCacheRecord.desc)},e.createInvalidCacheEnvironmentError=function(){return new e(S.invalidCacheEnvironment.code,S.invalidCacheEnvironment.desc)},e.createNoAccountFoundError=function(){return new e(S.noAccountFound.code,S.noAccountFound.desc)},e.createCachePluginError=function(){return new e(S.CachePluginError.code,""+S.CachePluginError.desc)},e.createNoCryptoObjectError=function(t){return new e(S.noCryptoObj.code,""+S.noCryptoObj.desc+t)},e.createInvalidCacheTypeError=function(){return new e(S.invalidCacheType.code,""+S.invalidCacheType.desc)},e.createUnexpectedAccountTypeError=function(){return new e(S.unexpectedAccountType.code,""+S.unexpectedAccountType.desc)},e.createUnexpectedCredentialTypeError=function(){return new e(S.unexpectedCredentialType.code,""+S.unexpectedCredentialType.desc)},e.createInvalidAssertionError=function(){return new e(S.invalidAssertion.code,""+S.invalidAssertion.desc)},e.createInvalidCredentialError=function(){return new e(S.invalidClientCredential.code,""+S.invalidClientCredential.desc)},e.createRefreshRequiredError=function(){return new e(S.tokenRefreshRequired.code,S.tokenRefreshRequired.desc)},e.createUserTimeoutReachedError=function(){return new e(S.userTimeoutReached.code,S.userTimeoutReached.desc)},e.createTokenClaimsRequiredError=function(){return new e(S.tokenClaimsRequired.code,S.tokenClaimsRequired.desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(S.noAuthorizationCodeFromServer.code,S.noAuthorizationCodeFromServer.desc)},e.createBindingKeyNotRemovedError=function(){return new e(S.bindingKeyNotRemovedError.code,S.bindingKeyNotRemovedError.desc)},e.createLogoutNotSupportedError=function(){return new e(S.logoutNotSupported.code,S.logoutNotSupported.desc)},e}(L);var x=function(){function o(){}return o.decodeAuthToken=function(e){if(o.isEmpty(e))throw C.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,n=t.exec(e);if(!n||n.length<4)throw C.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));var r={header:n[1],JWSPayload:n[2],JWSSig:n[3]};return r},o.isEmpty=function(e){return typeof e>"u"||!e||e.length===0},o.isEmptyObj=function(e){if(e&&!o.isEmpty(e))try{var t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0},o.startsWith=function(e,t){return e.indexOf(t)===0},o.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},o.queryStringToObject=function(e){var t={},n=e.split("&"),r=function(s){return decodeURIComponent(s.replace(/\+/g," "))};return n.forEach(function(s){if(s.trim()){var a=s.split(/=(.+)/g,2),i=a[0],c=a[1];i&&c&&(t[r(i)]=r(c))}}),t},o.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},o.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!o.isEmpty(t)})},o.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},o.matchPattern=function(e,t){var n=new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return n.test(t)},o}();var se;(function(o){o[o.Error=0]="Error",o[o.Warning=1]="Warning",o[o.Info=2]="Info",o[o.Verbose=3]="Verbose",o[o.Trace=4]="Trace"})(se||(se={}));var Ho=function(){function o(e,t,n){this.level=se.Info;var r=function(){};this.localCallback=e.loggerCallback||r,this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=typeof e.logLevel=="number"?e.logLevel:se.Info,this.correlationId=e.correlationId||"",this.packageName=t||_.EMPTY_STRING,this.packageVersion=n||_.EMPTY_STRING}return o.prototype.clone=function(e,t,n){return new o({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)},o.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var n=new Date().toUTCString(),r;x.isEmpty(t.correlationId)?x.isEmpty(this.correlationId)?r="["+n+"]":r="["+n+"] : ["+this.correlationId+"]":r="["+n+"] : ["+t.correlationId+"]";var s=r+" : "+this.packageName+"@"+this.packageVersion+" : "+se[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,s,t.containsPii||!1)}},o.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},o.prototype.error=function(e,t){this.logMessage(e,{logLevel:se.Error,containsPii:!1,correlationId:t||""})},o.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:se.Error,containsPii:!0,correlationId:t||""})},o.prototype.warning=function(e,t){this.logMessage(e,{logLevel:se.Warning,containsPii:!1,correlationId:t||""})},o.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:se.Warning,containsPii:!0,correlationId:t||""})},o.prototype.info=function(e,t){this.logMessage(e,{logLevel:se.Info,containsPii:!1,correlationId:t||""})},o.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:se.Info,containsPii:!0,correlationId:t||""})},o.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:se.Verbose,containsPii:!1,correlationId:t||""})},o.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:se.Verbose,containsPii:!0,correlationId:t||""})},o.prototype.trace=function(e,t){this.logMessage(e,{logLevel:se.Trace,containsPii:!1,correlationId:t||""})},o.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:se.Trace,containsPii:!0,correlationId:t||""})},o.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},o}();var ql="@azure/msal-common",fr="6.1.0";var dt;(function(o){o[o.None=0]="None",o.AzurePublic="https://login.microsoftonline.com",o.AzureChina="https://login.chinacloudapi.cn",o.AzureGermany="https://login.microsoftonline.de",o.AzureUsGovernment="https://login.microsoftonline.us"})(dt||(dt={}));var bt=function(){function o(){}return o.prototype.generateAccountId=function(){return o.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},o.prototype.generateCredentialId=function(){return o.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},o.prototype.generateTarget=function(){return o.generateTargetForCacheKey(this.target)},o.prototype.generateCredentialKey=function(){return o.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},o.prototype.generateType=function(){switch(this.credentialType){case V.ID_TOKEN:return Be.ID_TOKEN;case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Be.ACCESS_TOKEN;case V.REFRESH_TOKEN:return Be.REFRESH_TOKEN;default:throw C.createUnexpectedCredentialTypeError()}},o.getCredentialType=function(e){return e.indexOf(V.ACCESS_TOKEN.toLowerCase())!==-1?e.indexOf(V.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())!==-1?V.ACCESS_TOKEN_WITH_AUTH_SCHEME:V.ACCESS_TOKEN:e.indexOf(V.ID_TOKEN.toLowerCase())!==-1?V.ID_TOKEN:e.indexOf(V.REFRESH_TOKEN.toLowerCase())!==-1?V.REFRESH_TOKEN:_.NOT_DEFINED},o.generateCredentialCacheKey=function(e,t,n,r,s,a,i,c,l){var d=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(n,r,s,i),this.generateTargetForCacheKey(a),this.generateClaimsHashForCacheKey(l),this.generateSchemeForCacheKey(c)];return d.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.generateAccountIdForCacheKey=function(e,t){var n=[e,t];return n.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.generateCredentialIdForCacheKey=function(e,t,n,r){var s=e===V.REFRESH_TOKEN&&r||t,a=[e,s,n||""];return a.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},o.generateClaimsHashForCacheKey=function(e){return(e||"").toLowerCase()},o.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==ee.BEARER.toLowerCase()?e.toLowerCase():""},o}();var q={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},Y=function(o){le(e,o);function e(t,n){var r=o.call(this,t,n)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,e.prototype),r}return e.createRedirectUriEmptyError=function(){return new e(q.redirectUriNotSet.code,q.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(q.postLogoutUriNotSet.code,q.postLogoutUriNotSet.desc)},e.createClaimsRequestParsingError=function(t){return new e(q.claimsRequestParsingError.code,q.claimsRequestParsingError.desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(q.authorityUriInsecure.code,q.authorityUriInsecure.desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(q.urlParseError.code,q.urlParseError.desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(q.urlEmptyError.code,q.urlEmptyError.desc)},e.createEmptyScopesArrayError=function(){return new e(q.emptyScopesError.code,""+q.emptyScopesError.desc)},e.createClientIdSingleScopeError=function(t){return new e(q.clientIdSingleScopeError.code,q.clientIdSingleScopeError.desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(q.invalidPrompt.code,q.invalidPrompt.desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(q.invalidClaimsRequest.code,q.invalidClaimsRequest.desc)},e.createEmptyLogoutRequestError=function(){return new e(q.logoutRequestEmptyError.code,q.logoutRequestEmptyError.desc)},e.createEmptyTokenRequestError=function(){return new e(q.tokenRequestEmptyError.code,q.tokenRequestEmptyError.desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(q.invalidCodeChallengeMethod.code,q.invalidCodeChallengeMethod.desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(q.invalidCodeChallengeParams.code,q.invalidCodeChallengeParams.desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(q.invalidCloudDiscoveryMetadata.code,q.invalidCloudDiscoveryMetadata.desc)},e.createInvalidAuthorityMetadataError=function(){return new e(q.invalidAuthorityMetadata.code,q.invalidAuthorityMetadata.desc)},e.createUntrustedAuthorityError=function(){return new e(q.untrustedAuthority.code,q.untrustedAuthority.desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(q.invalidAzureCloudInstance.code,q.invalidAzureCloudInstance.desc)},e.createMissingSshJwkError=function(){return new e(q.missingSshJwk.code,q.missingSshJwk.desc)},e.createMissingSshKidError=function(){return new e(q.missingSshKid.code,q.missingSshKid.desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(q.missingNonceAuthenticationHeader.code,q.missingNonceAuthenticationHeader.desc)},e.createInvalidAuthenticationHeaderError=function(t,n){return new e(q.invalidAuthenticationHeader.code,q.invalidAuthenticationHeader.desc+". Invalid header: "+t+". Details: "+n)},e}(C);var Ce=function(){function o(e){var t=this,n=e?x.trimArrayEntries(Pt(e)):[],r=n?x.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(function(s){return t.scopes.add(s)})}return o.fromString=function(e){var t=e||"",n=t.split(" ");return new o(n)},o.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Y.createEmptyScopesArrayError()},o.prototype.containsScope=function(e){var t=this.printScopesLowerCase().split(" "),n=new o(t);return x.isEmpty(e)?!1:n.scopes.has(e.toLowerCase())},o.prototype.containsScopeSet=function(e){var t=this;return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(function(n){return t.containsScope(n)})},o.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return Ds.forEach(function(n){e.containsScope(n)&&(t+=1)}),this.scopes.size===t},o.prototype.appendScope=function(e){x.isEmpty(e)||this.scopes.add(e.trim())},o.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(n){return t.appendScope(n)})}catch(n){throw C.createAppendScopeSetError(n)}},o.prototype.removeScope=function(e){if(x.isEmpty(e))throw C.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},o.prototype.removeOIDCScopes=function(){var e=this;Ds.forEach(function(t){e.scopes.delete(t)})},o.prototype.unionScopeSets=function(e){if(!e)throw C.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(n){return t.add(n.toLowerCase())}),this.scopes.forEach(function(n){return t.add(n.toLowerCase())}),t},o.prototype.intersectingScopeSets=function(e){if(!e)throw C.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount(),s=t.size;return s<r+n},o.prototype.getScopeCount=function(){return this.scopes.size},o.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},o.prototype.printScopes=function(){if(this.scopes){var e=this.asArray();return e.join(" ")}return""},o.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},o}();function lo(o,e){if(x.isEmpty(o))throw C.createClientInfoEmptyError();try{var t=e.base64Decode(o);return JSON.parse(t)}catch(n){throw C.createClientInfoDecodingError(n)}}function zt(o){if(x.isEmpty(o))throw C.createClientInfoDecodingError("Home account ID was empty.");var e=o.split(he.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?_.EMPTY_STRING:e[1]}}var ot;(function(o){o[o.Default=0]="Default",o[o.Adfs=1]="Adfs"})(ot||(ot={}));var de=function(){function o(){}return o.prototype.generateAccountId=function(){var e=[this.homeAccountId,this.environment];return e.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.prototype.generateAccountKey=function(){return o.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},o.prototype.generateType=function(){switch(this.authorityType){case Ze.ADFS_ACCOUNT_TYPE:return Be.ADFS;case Ze.MSAV1_ACCOUNT_TYPE:return Be.MSA;case Ze.MSSTS_ACCOUNT_TYPE:return Be.MSSTS;case Ze.GENERIC_ACCOUNT_TYPE:return Be.GENERIC;default:throw C.createUnexpectedAccountTypeError()}},o.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},o.generateAccountCacheKey=function(e){var t=[e.homeAccountId,e.environment||"",e.tenantId||""];return t.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.createAccount=function(e,t,n,r,s,a,i,c){var l,d,u,p,m,g,y=new o;y.authorityType=Ze.MSSTS_ACCOUNT_TYPE,y.clientInfo=e,y.homeAccountId=t;var E=c||r&&r.getPreferredCache();if(!E)throw C.createInvalidCacheEnvironmentError();return y.environment=E,y.realm=((l=n?.claims)===null||l===void 0?void 0:l.tid)||"",y.oboAssertion=s,n&&(y.idTokenClaims=n.claims,y.localAccountId=((d=n?.claims)===null||d===void 0?void 0:d.oid)||((u=n?.claims)===null||u===void 0?void 0:u.sub)||"",y.username=((p=n?.claims)===null||p===void 0?void 0:p.preferred_username)||(!((m=n?.claims)===null||m===void 0)&&m.emails?n.claims.emails[0]:""),y.name=(g=n?.claims)===null||g===void 0?void 0:g.name),y.cloudGraphHostName=a,y.msGraphHost=i,y},o.createGenericAccount=function(e,t,n,r,s,a,i){var c,l,d,u,p=new o;p.authorityType=n&&n.authorityType===ot.Adfs?Ze.ADFS_ACCOUNT_TYPE:Ze.GENERIC_ACCOUNT_TYPE,p.homeAccountId=e,p.realm="",p.oboAssertion=r;var m=i||n&&n.getPreferredCache();if(!m)throw C.createInvalidCacheEnvironmentError();return t&&(p.localAccountId=((c=t?.claims)===null||c===void 0?void 0:c.oid)||((l=t?.claims)===null||l===void 0?void 0:l.sub)||"",p.username=((d=t?.claims)===null||d===void 0?void 0:d.upn)||"",p.name=((u=t?.claims)===null||u===void 0?void 0:u.name)||"",p.idTokenClaims=t?.claims),p.environment=m,p.cloudGraphHostName=s,p.msGraphHost=a,p},o.generateHomeAccountId=function(e,t,n,r,s){var a,i=!((a=s?.claims)===null||a===void 0)&&a.sub?s.claims.sub:_.EMPTY_STRING;if(t===ot.Adfs)return i;if(e)try{var c=lo(e,r);if(!x.isEmpty(c.uid)&&!x.isEmpty(c.utid))return""+c.uid+he.CLIENT_INFO_SEPARATOR+c.utid}catch{}return n.verbose("No client info in response"),i},o.isAccountEntity=function(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1},o.accountInfoIsEqual=function(e,t,n){if(!e||!t)return!1;var r=!0;if(n){var s=e.idTokenClaims||{},a=t.idTokenClaims||{};r=s.iat===a.iat&&s.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&r},o}();var ye=function(){function o(e,t){if(x.isEmpty(e))throw C.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=o.extractTokenClaims(e,t)}return o.extractTokenClaims=function(e,t){var n=x.decodeAuthToken(e);try{var r=n.JWSPayload,s=t.base64Decode(r);return JSON.parse(s)}catch(a){throw C.createTokenParsingError(a)}},o}();var Ie=function(){function o(e,t){this.clientId=e,this.cryptoImpl=t}return o.prototype.getAllAccounts=function(){var e=this,t=this.getAccountsFilteredBy(),n=Object.keys(t).map(function(a){return t[a]}),r=n.length;if(r<1)return[];var s=n.map(function(a){var i=o.toObject(new de,a),c=i.getAccountInfo(),l=e.readIdTokenFromCache(e.clientId,c);return l&&!c.idTokenClaims&&(c.idTokenClaims=new ye(l.secret,e.cryptoImpl).claims),c});return s},o.prototype.saveCacheRecord=function(e){return z(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:if(!e)throw C.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},o.prototype.saveAccessToken=function(e){return z(this,void 0,void 0,function(){var t,n,r,s,a=this;return D(this,function(i){switch(i.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),n=Ce.fromString(e.target),r=Object.keys(t.accessTokens).map(function(c){return t.accessTokens[c]}),r?(s=[],r.forEach(function(c){var l=Ce.fromString(c.target);l.intersectingScopeSets(n)&&s.push(a.removeCredential(c))}),[4,Promise.all(s)]):[3,2];case 1:i.sent(),i.label=2;case 2:return this.setAccessTokenCredential(e),[2]}})})},o.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},o.prototype.getAccountsFilteredByInternal=function(e,t,n){var r=this,s=this.getKeys(),a={};return s.forEach(function(i){var c=r.getAccount(i);!c||!!e&&!r.matchHomeAccountId(c,e)||!!t&&!r.matchEnvironment(c,t)||!!n&&!r.matchRealm(c,n)||(a[i]=c)}),a},o.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId,e.requestedClaimsHash)},o.prototype.getCredentialsFilteredByInternal=function(e,t,n,r,s,a,i,c,l,d,u){var p=this,m=this.getKeys(),g={idTokens:{},accessTokens:{},refreshTokens:{}};return m.forEach(function(y){var E=bt.getCredentialType(y);if(E!==_.NOT_DEFINED){var I=p.getSpecificCredential(y,E);if(!!I&&!(!!c&&!p.matchOboAssertion(I,c))&&!(!!e&&!p.matchHomeAccountId(I,e))&&!(!!t&&!p.matchEnvironment(I,t))&&!(!!a&&!p.matchRealm(I,a))&&!(!!n&&!p.matchCredentialType(I,n))&&!(!!r&&!p.matchClientId(I,r))&&!(!!s&&!p.matchFamilyId(I,s))&&!(!!i&&!p.matchTarget(I,i))&&!((u||I.requestedClaimsHash)&&I.requestedClaimsHash!==u)&&!(n===V.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(!!l&&!p.matchTokenType(I,l)||l===ee.SSH&&d&&!p.matchKeyId(I,d)))){var N=p.updateCredentialCacheKey(y,I);switch(E){case V.ID_TOKEN:g.idTokens[N]=I;break;case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:g.accessTokens[N]=I;break;case V.REFRESH_TOKEN:g.refreshTokens[N]=I;break}}}}),g},o.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},o.prototype.getAppMetadataFilteredByInternal=function(e,t){var n=this,r=this.getKeys(),s={};return r.forEach(function(a){if(!!n.isAppMetadata(a)){var i=n.getAppMetadata(a);!i||!!e&&!n.matchEnvironment(i,e)||!!t&&!n.matchClientId(i,t)||(s[a]=i)}}),s},o.prototype.getAuthorityMetadataByAlias=function(e){var t=this,n=this.getAuthorityMetadataKeys(),r=null;return n.forEach(function(s){if(!(!t.isAuthorityMetadata(s)||s.indexOf(t.clientId)===-1)){var a=t.getAuthorityMetadata(s);!a||a.aliases.indexOf(e)!==-1&&(r=a)}}),r},o.prototype.removeAllAccounts=function(){return z(this,void 0,void 0,function(){var e,t,n=this;return D(this,function(r){switch(r.label){case 0:return e=this.getKeys(),t=[],e.forEach(function(s){var a=n.getAccount(s);!a||t.push(n.removeAccount(s))}),[4,Promise.all(t)];case 1:return r.sent(),[2,!0]}})})},o.prototype.removeAccount=function(e){return z(this,void 0,void 0,function(){var t;return D(this,function(n){switch(n.label){case 0:if(t=this.getAccount(e),!t)throw C.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,n.sent()&&this.removeItem(e,ut.ACCOUNT)]}})})},o.prototype.removeAccountContext=function(e){return z(this,void 0,void 0,function(){var t,n,r,s=this;return D(this,function(a){switch(a.label){case 0:return t=this.getKeys(),n=e.generateAccountId(),r=[],t.forEach(function(i){var c=bt.getCredentialType(i);if(c!==_.NOT_DEFINED){var l=s.getSpecificCredential(i,c);!!l&&n===l.generateAccountId()&&r.push(s.removeCredential(l))}}),[4,Promise.all(r)];case 1:return a.sent(),[2,!0]}})})},o.prototype.removeCredential=function(e){return z(this,void 0,void 0,function(){var t,n,r;return D(this,function(s){switch(s.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==V.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==ee.POP)return[3,4];if(n=e,r=n.keyId,!r)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return s.sent(),[3,4];case 3:throw s.sent(),C.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,ut.CREDENTIAL)]}})})},o.prototype.removeAppMetadata=function(){var e=this,t=this.getKeys();return t.forEach(function(n){e.isAppMetadata(n)&&e.removeItem(n,ut.APP_METADATA)}),!0},o.prototype.readCacheRecord=function(e,t,n,r){var s=this.readAccountFromCache(e),a=this.readIdTokenFromCache(t,e),i=this.readAccessTokenFromCache(t,e,n),c=this.readRefreshTokenFromCache(t,e,!1),l=this.readAppMetadataFromCache(r,t);return s&&a&&(s.idTokenClaims=new ye(a.secret,this.cryptoImpl).claims),{account:s,idToken:a,accessToken:i,refreshToken:c,appMetadata:l}},o.prototype.readAccountFromCache=function(e){var t=de.generateAccountCacheKey(e);return this.getAccount(t)},o.prototype.readIdTokenFromCache=function(e,t){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:V.ID_TOKEN,clientId:e,realm:t.tenantId},r=this.getCredentialsFilteredBy(n),s=Object.keys(r.idTokens).map(function(i){return r.idTokens[i]}),a=s.length;if(a<1)return null;if(a>1)throw C.createMultipleMatchingTokensInCacheError();return s[0]},o.prototype.readAccessTokenFromCache=function(e,t,n){var r=new Ce(n.scopes||[]),s=n.authenticationScheme||ee.BEARER,a=s&&s.toLowerCase()!==ee.BEARER.toLowerCase()?V.ACCESS_TOKEN_WITH_AUTH_SCHEME:V.ACCESS_TOKEN,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:a,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase(),tokenType:s,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},c=this.getCredentialsFilteredBy(i),l=Object.keys(c.accessTokens).map(function(u){return c.accessTokens[u]}),d=l.length;if(d<1)return null;if(d>1)throw C.createMultipleMatchingTokensInCacheError();return l[0]},o.prototype.readRefreshTokenFromCache=function(e,t,n){var r=n?Fo:void 0,s={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:V.REFRESH_TOKEN,clientId:e,familyId:r},a=this.getCredentialsFilteredBy(s),i=Object.keys(a.refreshTokens).map(function(l){return a.refreshTokens[l]}),c=i.length;return c<1?null:i[0]},o.prototype.readAppMetadataFromCache=function(e,t){var n={environment:e,clientId:t},r=this.getAppMetadataFilteredBy(n),s=Object.keys(r).map(function(i){return r[i]}),a=s.length;if(a<1)return null;if(a>1)throw C.createMultipleMatchingAppMetadataInCacheError();return s[0]},o.prototype.isAppMetadataFOCI=function(e,t){var n=this.readAppMetadataFromCache(e,t);return!!(n&&n.familyId===Fo)},o.prototype.matchHomeAccountId=function(e,t){return!!(e.homeAccountId&&t===e.homeAccountId)},o.prototype.matchOboAssertion=function(e,t){return!!(e.oboAssertion&&t===e.oboAssertion)},o.prototype.matchEnvironment=function(e,t){var n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)},o.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},o.prototype.matchClientId=function(e,t){return!!(e.clientId&&t===e.clientId)},o.prototype.matchFamilyId=function(e,t){return!!(e.familyId&&t===e.familyId)},o.prototype.matchRealm=function(e,t){return!!(e.realm&&t===e.realm)},o.prototype.matchTarget=function(e,t){var n=e.credentialType!==V.ACCESS_TOKEN&&e.credentialType!==V.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(n||!e.target)return!1;var r=Ce.fromString(e.target),s=Ce.fromString(t);return s.containsOnlyOIDCScopes()?s.removeScope(_.OFFLINE_ACCESS_SCOPE):s.removeOIDCScopes(),r.containsScopeSet(s)},o.prototype.matchTokenType=function(e,t){return!!(e.tokenType&&e.tokenType===t)},o.prototype.matchKeyId=function(e,t){return!!(e.keyId&&e.keyId===t)},o.prototype.isAppMetadata=function(e){return e.indexOf(En)!==-1},o.prototype.isAuthorityMetadata=function(e){return e.indexOf(co.CACHE_KEY)!==-1},o.prototype.generateAuthorityMetadataCacheKey=function(e){return co.CACHE_KEY+"-"+this.clientId+"-"+e},o.prototype.getSpecificCredential=function(e,t){switch(t){case V.ID_TOKEN:return this.getIdTokenCredential(e);case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case V.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},o.toObject=function(e,t){for(var n in t)e[n]=t[n];return e},o}(),Fs=function(o){le(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.setAccount=function(){var t="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getAccount=function(){var t="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setIdTokenCredential=function(){var t="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getIdTokenCredential=function(){var t="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setAccessTokenCredential=function(){var t="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getAccessTokenCredential=function(){var t="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setRefreshTokenCredential=function(){var t="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getRefreshTokenCredential=function(){var t="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setAppMetadata=function(){var t="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getAppMetadata=function(){var t="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setServerTelemetry=function(){var t="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getServerTelemetry=function(){var t="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setAuthorityMetadata=function(){var t="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getAuthorityMetadata=function(){var t="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getAuthorityMetadataKeys=function(){var t="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.setThrottlingCache=function(){var t="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getThrottlingCache=function(){var t="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.removeItem=function(){var t="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.containsKey=function(){var t="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.getKeys=function(){var t="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e.prototype.clear=function(){return z(this,void 0,void 0,function(){var t;return D(this,function(n){throw t="Storage interface - clear() has not been implemented for the cacheStorage interface.",L.createUnexpectedError(t)})})},e.prototype.updateCredentialCacheKey=function(){var t="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw L.createUnexpectedError(t)},e}(Ie);var Og=300,hr={tokenRenewalOffsetSeconds:Og,preventCorsPreflight:!1,proxyUrl:""},Ug={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:se.Info,correlationId:""},Fg={sendGetRequestAsync:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Network interface - sendGetRequestAsync() has not been implemented",L.createUnexpectedError(o)})})},sendPostRequestAsync:function(){return z(this,void 0,void 0,function(){var o;return D(this,function(e){throw o="Network interface - sendPostRequestAsync() has not been implemented",L.createUnexpectedError(o)})})}},Hg={sku:_.SKU,version:fr,cpu:"",os:""},qg={clientSecret:"",clientAssertion:void 0},Bg={azureCloudInstance:dt.None,tenant:""+_.DEFAULT_COMMON_TENANT};function Bl(o){var e=o.authOptions,t=o.systemOptions,n=o.loggerOptions,r=o.storageInterface,s=o.networkInterface,a=o.cryptoInterface,i=o.clientCredentials,c=o.libraryInfo,l=o.serverTelemetryManager,d=o.persistencePlugin,u=o.serializableCache,p=me(me({},Ug),n);return{authOptions:$g(e),systemOptions:me(me({},hr),t),loggerOptions:p,storageInterface:r||new Fs(e.clientId,Nt),networkInterface:s||Fg,cryptoInterface:a||Nt,clientCredentials:i||qg,libraryInfo:me(me({},Hg),c),serverTelemetryManager:l||null,persistencePlugin:d||null,serializableCache:u||null}}function $g(o){return me({clientCapabilities:[],azureCloudOptions:Bg},o)}var nt=function(o){le(e,o);function e(t,n,r){var s=o.call(this,t,n,r)||this;return s.name="ServerError",Object.setPrototypeOf(s,e.prototype),s}return e}(L);var Dt=function(){function o(){}return o.generateThrottlingStorageKey=function(e){return Mt.THROTTLING_PREFIX+"."+JSON.stringify(e)},o.preProcess=function(e,t){var n,r=o.generateThrottlingStorageKey(t),s=e.getThrottlingCache(r);if(s){if(s.throttleTime<Date.now()){e.removeItem(r,ut.THROTTLING);return}throw new nt(((n=s.errorCodes)===null||n===void 0?void 0:n.join(" "))||_.EMPTY_STRING,s.errorMessage,s.subError)}},o.postProcess=function(e,t,n){if(o.checkResponseStatus(n)||o.checkResponseForRetryAfter(n)){var r={throttleTime:o.calculateThrottleTime(parseInt(n.headers[qe.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(o.generateThrottlingStorageKey(t),r)}},o.checkResponseStatus=function(e){return e.status===429||e.status>=500&&e.status<600},o.checkResponseForRetryAfter=function(e){return e.headers?e.headers.hasOwnProperty(qe.RETRY_AFTER)&&(e.status<200||e.status>=300):!1},o.calculateThrottleTime=function(e){var t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Mt.DEFAULT_THROTTLE_TIME_SECONDS),n+Mt.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)},o.removeThrottle=function(e,t,n,r){var s={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(s);return e.removeItem(a,ut.THROTTLING)},o}();var $l=function(){function o(e,t){this.networkClient=e,this.cacheManager=t}return o.prototype.sendPostRequest=function(e,t,n){return z(this,void 0,void 0,function(){var r,s;return D(this,function(a){switch(a.label){case 0:Dt.preProcess(this.cacheManager,e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,n)];case 2:return r=a.sent(),[3,4];case 3:throw s=a.sent(),s instanceof L?s:C.createNetworkError(t,s);case 4:return Dt.postProcess(this.cacheManager,e,r),[2,r]}})})},o}();var be;(function(o){o.HOME_ACCOUNT_ID="home_account_id",o.UPN="UPN"})(be||(be={}));var qo=function(){function o(e){this.config=Bl(e),this.logger=new Ho(this.config.loggerOptions,ql,fr),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new $l(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return o.prototype.createTokenRequestHeaders=function(e){var t={};if(t[qe.CONTENT_TYPE]=_.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case be.HOME_ACCOUNT_ID:try{var n=zt(e.credential);t[qe.CCS_HEADER]="Oid:"+n.uid+"@"+n.utid}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case be.UPN:t[qe.CCS_HEADER]="UPN: "+e.credential;break}return t},o.prototype.executePostToTokenEndpoint=function(e,t,n,r){return z(this,void 0,void 0,function(){var s;return D(this,function(a){switch(a.label){case 0:return[4,this.networkManager.sendPostRequest(r,e,{body:t,headers:n,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return s=a.sent(),this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,s]}})})},o.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw C.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},o}();var vt=function(){function o(){}return o.validateRedirectUri=function(e){if(x.isEmpty(e))throw Y.createRedirectUriEmptyError()},o.validatePrompt=function(e){var t=[];for(var n in tt)t.push(tt[n]);if(t.indexOf(e)<0)throw Y.createInvalidPromptError(e)},o.validateClaims=function(e){try{JSON.parse(e)}catch{throw Y.createInvalidClaimsRequestError()}},o.validateCodeChallengeParams=function(e,t){if(x.isEmpty(e)||x.isEmpty(t))throw Y.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},o.validateCodeChallengeMethod=function(e){if([Os.PLAIN,Os.S256].indexOf(e)<0)throw Y.createInvalidCodeChallengeMethodError()},o.sanitizeEQParams=function(e,t){return e?(t.forEach(function(n,r){e[r]&&delete e[r]}),e):{}},o}();var Ot=function(){function o(){this.parameters=new Map}return o.prototype.addResponseTypeCode=function(){this.parameters.set(G.RESPONSE_TYPE,encodeURIComponent(_.CODE_RESPONSE_TYPE))},o.prototype.addResponseMode=function(e){this.parameters.set(G.RESPONSE_MODE,encodeURIComponent(e||ao.QUERY))},o.prototype.addScopes=function(e,t){t===void 0&&(t=!0);var n=t?Pt(e||[],xt):e||[],r=new Ce(n);this.parameters.set(G.SCOPE,encodeURIComponent(r.printScopes()))},o.prototype.addClientId=function(e){this.parameters.set(G.CLIENT_ID,encodeURIComponent(e))},o.prototype.addRedirectUri=function(e){vt.validateRedirectUri(e),this.parameters.set(G.REDIRECT_URI,encodeURIComponent(e))},o.prototype.addPostLogoutRedirectUri=function(e){vt.validateRedirectUri(e),this.parameters.set(G.POST_LOGOUT_URI,encodeURIComponent(e))},o.prototype.addIdTokenHint=function(e){this.parameters.set(G.ID_TOKEN_HINT,encodeURIComponent(e))},o.prototype.addDomainHint=function(e){this.parameters.set(Oo.DOMAIN_HINT,encodeURIComponent(e))},o.prototype.addLoginHint=function(e){this.parameters.set(Oo.LOGIN_HINT,encodeURIComponent(e))},o.prototype.addCcsUpn=function(e){this.parameters.set(qe.CCS_HEADER,encodeURIComponent("UPN:"+e))},o.prototype.addCcsOid=function(e){this.parameters.set(qe.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},o.prototype.addSid=function(e){this.parameters.set(Oo.SID,encodeURIComponent(e))},o.prototype.addClaims=function(e,t){var n=this.addClientCapabilitiesToClaims(e,t);vt.validateClaims(n),this.parameters.set(G.CLAIMS,encodeURIComponent(n))},o.prototype.addCorrelationId=function(e){this.parameters.set(G.CLIENT_REQUEST_ID,encodeURIComponent(e))},o.prototype.addLibraryInfo=function(e){this.parameters.set(G.X_CLIENT_SKU,e.sku),this.parameters.set(G.X_CLIENT_VER,e.version),this.parameters.set(G.X_CLIENT_OS,e.os),this.parameters.set(G.X_CLIENT_CPU,e.cpu)},o.prototype.addPrompt=function(e){vt.validatePrompt(e),this.parameters.set(""+G.PROMPT,encodeURIComponent(e))},o.prototype.addState=function(e){x.isEmpty(e)||this.parameters.set(G.STATE,encodeURIComponent(e))},o.prototype.addNonce=function(e){this.parameters.set(G.NONCE,encodeURIComponent(e))},o.prototype.addCodeChallengeParams=function(e,t){if(vt.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(G.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(G.CODE_CHALLENGE_METHOD,encodeURIComponent(t));else throw Y.createInvalidCodeChallengeParamsError()},o.prototype.addAuthorizationCode=function(e){this.parameters.set(G.CODE,encodeURIComponent(e))},o.prototype.addDeviceCode=function(e){this.parameters.set(G.DEVICE_CODE,encodeURIComponent(e))},o.prototype.addRefreshToken=function(e){this.parameters.set(G.REFRESH_TOKEN,encodeURIComponent(e))},o.prototype.addCodeVerifier=function(e){this.parameters.set(G.CODE_VERIFIER,encodeURIComponent(e))},o.prototype.addClientSecret=function(e){this.parameters.set(G.CLIENT_SECRET,encodeURIComponent(e))},o.prototype.addClientAssertion=function(e){this.parameters.set(G.CLIENT_ASSERTION,encodeURIComponent(e))},o.prototype.addClientAssertionType=function(e){this.parameters.set(G.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},o.prototype.addOboAssertion=function(e){this.parameters.set(G.OBO_ASSERTION,encodeURIComponent(e))},o.prototype.addRequestTokenUse=function(e){this.parameters.set(G.REQUESTED_TOKEN_USE,encodeURIComponent(e))},o.prototype.addGrantType=function(e){this.parameters.set(G.GRANT_TYPE,encodeURIComponent(e))},o.prototype.addClientInfo=function(){this.parameters.set(Hl,"1")},o.prototype.addExtraQueryParameters=function(e){var t=this;vt.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach(function(n){t.parameters.set(n,e[n])})},o.prototype.addClientCapabilitiesToClaims=function(e,t){var n;if(!e)n={};else try{n=JSON.parse(e)}catch{throw Y.createInvalidClaimsRequestError()}return t&&t.length>0&&(n.hasOwnProperty(so.ACCESS_TOKEN)||(n[so.ACCESS_TOKEN]={}),n[so.ACCESS_TOKEN][so.XMS_CC]={values:t}),JSON.stringify(n)},o.prototype.addUsername=function(e){this.parameters.set(Cn.username,e)},o.prototype.addPassword=function(e){this.parameters.set(Cn.password,e)},o.prototype.addPopToken=function(e){x.isEmpty(e)||(this.parameters.set(G.TOKEN_TYPE,ee.POP),this.parameters.set(G.REQ_CNF,encodeURIComponent(e)))},o.prototype.addSshJwk=function(e){x.isEmpty(e)||(this.parameters.set(G.TOKEN_TYPE,ee.SSH),this.parameters.set(G.REQ_CNF,encodeURIComponent(e)))},o.prototype.addServerTelemetry=function(e){this.parameters.set(G.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(G.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},o.prototype.addThrottling=function(){this.parameters.set(G.X_MS_LIB_CAPABILITY,Mt.X_MS_LIB_CAPABILITY_VALUE)},o.prototype.addLogoutHint=function(e){this.parameters.set(G.LOGOUT_HINT,encodeURIComponent(e))},o.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,n){e.push(n+"="+t)}),e.join("&")},o}();var Ut=function(o){le(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.createIdTokenEntity=function(t,n,r,s,a,i){var c=new e;return c.credentialType=V.ID_TOKEN,c.homeAccountId=t,c.environment=n,c.clientId=s,c.secret=r,c.realm=a,c.oboAssertion=i,c},e.isIdTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===V.ID_TOKEN:!1},e}(bt);var Se=function(){function o(){}return o.nowSeconds=function(){return Math.round(new Date().getTime()/1e3)},o.isTokenExpired=function(e,t){var n=Number(e)||0,r=o.nowSeconds()+t;return r>n},o.wasClockTurnedBack=function(e){var t=Number(e);return t>o.nowSeconds()},o.delay=function(e,t){return new Promise(function(n){return setTimeout(function(){return n(t)},e)})},o}();var Ft=function(o){le(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.createAccessTokenEntity=function(t,n,r,s,a,i,c,l,d,u,p,m,g,y,E){var I,N,w=new e;w.homeAccountId=t,w.credentialType=V.ACCESS_TOKEN,w.secret=r;var ke=Se.nowSeconds();if(w.cachedAt=ke.toString(),w.expiresOn=c.toString(),w.extendedExpiresOn=l.toString(),u&&(w.refreshOn=u.toString()),w.environment=n,w.clientId=s,w.realm=a,w.target=i,w.oboAssertion=m,w.tokenType=x.isEmpty(p)?ee.BEARER:p,y&&(w.requestedClaims=y,w.requestedClaimsHash=E),((I=w.tokenType)===null||I===void 0?void 0:I.toLowerCase())!==ee.BEARER.toLowerCase())switch(w.credentialType=V.ACCESS_TOKEN_WITH_AUTH_SCHEME,w.tokenType){case ee.POP:var gt=ye.extractTokenClaims(r,d);if(!(!((N=gt?.cnf)===null||N===void 0)&&N.kid))throw C.createTokenClaimsRequiredError();w.keyId=gt.cnf.kid;break;case ee.SSH:w.keyId=g}return w},e.isAccessTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===V.ACCESS_TOKEN||t.credentialType===V.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1},e}(bt);var Bo=function(o){le(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.createRefreshTokenEntity=function(t,n,r,s,a,i){var c=new e;return c.clientId=s,c.credentialType=V.REFRESH_TOKEN,c.environment=n,c.homeAccountId=t,c.secret=r,c.oboAssertion=i,a&&(c.familyId=a),c},e.isRefreshTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===V.REFRESH_TOKEN:!1},e}(bt);var Vl=["interaction_required","consent_required","login_required"],Vg=["message_only","additional_action","basic_action","user_password_expired","consent_required"],$o={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."}},$e=function(o){le(e,o);function e(t,n,r){var s=o.call(this,t,n,r)||this;return s.name="InteractionRequiredAuthError",Object.setPrototypeOf(s,e.prototype),s}return e.isInteractionRequiredError=function(t,n,r){var s=!!t&&Vl.indexOf(t)>-1,a=!!r&&Vg.indexOf(r)>-1,i=!!n&&Vl.some(function(c){return n.indexOf(c)>-1});return s||i||a},e.createNoTokensFoundError=function(){return new e($o.noTokensFoundError.code,$o.noTokensFoundError.desc)},e}(L);var Gl=function(){function o(e,t,n,r,s){this.account=e||null,this.idToken=t||null,this.accessToken=n||null,this.refreshToken=r||null,this.appMetadata=s||null}return o}();var rt=function(){function o(){}return o.setRequestState=function(e,t,n){var r=o.generateLibraryState(e,n);return x.isEmpty(t)?r:""+r+_.RESOURCE_DELIM+t},o.generateLibraryState=function(e,t){if(!e)throw C.createNoCryptoObjectError("generateLibraryState");var n={id:e.createNewGuid()};t&&(n.meta=t);var r=JSON.stringify(n);return e.base64Encode(r)},o.parseRequestState=function(e,t){if(!e)throw C.createNoCryptoObjectError("parseRequestState");if(x.isEmpty(t))throw C.createInvalidStateError(t,"Null, undefined or empty state");try{var n=t.split(_.RESOURCE_DELIM),r=n[0],s=n.length>1?n.slice(1).join(_.RESOURCE_DELIM):"",a=e.base64Decode(r),i=JSON.parse(a);return{userRequestState:x.isEmpty(s)?"":s,libraryState:i}}catch(c){throw C.createInvalidStateError(t,c)}},o}();var K=function(){function o(e){if(this._urlString=e,x.isEmpty(this._urlString))throw Y.createUrlEmptyError();x.isEmpty(this.getHash())&&(this._urlString=o.canonicalizeUri(e))}return Object.defineProperty(o.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),o.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return x.endsWith(t,"?")?t=t.slice(0,-1):x.endsWith(t,"?/")&&(t=t.slice(0,-2)),x.endsWith(t,"/")||(t+="/"),t}return e},o.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw Y.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw Y.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Y.createInsecureAuthorityUriError(this.urlString)},o.appendQueryString=function(e,t){return x.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},o.removeHashFromUrl=function(e){return o.canonicalizeUri(e.split("#")[0])},o.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===wn.COMMON||n[0]===wn.ORGANIZATIONS)&&(n[0]=e),o.constructAuthorityUriFromObject(t)},o.prototype.getHash=function(){return o.parseHash(this.urlString)},o.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Y.createUrlParseError("Given url string: "+this.urlString);var n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},r=n.AbsolutePath.split("/");return r=r.filter(function(s){return s&&s.length>0}),n.PathSegments=r,!x.isEmpty(n.QueryString)&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n},o.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Y.createUrlParseError("Given url string: "+e);return n[2]},o.getAbsoluteUrl=function(e,t){if(e[0]===_.FORWARD_SLASH){var n=new o(t),r=n.getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e},o.parseHash=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):""},o.constructAuthorityUriFromObject=function(e){return new o(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},o.getDeserializedHash=function(e){if(x.isEmpty(e))return{};var t=o.parseHash(e),n=x.queryStringToObject(x.isEmpty(t)?e:t);if(!n)throw C.createHashNotDeserializedError(JSON.stringify(n));return n},o.hashContainsKnownProperties=function(e){if(x.isEmpty(e)||e.indexOf("=")<0)return!1;var t=o.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},o}();var Hs;(function(o){o.SW="sw",o.UHW="uhw"})(Hs||(Hs={}));var Vo=function(){function o(e){this.cryptoUtils=e}return o.prototype.generateCnf=function(e){return z(this,void 0,void 0,function(){var t;return D(this,function(n){switch(n.label){case 0:return[4,this.generateKid(e)];case 1:return t=n.sent(),[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}})})},o.prototype.generateKid=function(e){return z(this,void 0,void 0,function(){var t;return D(this,function(n){switch(n.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return t=n.sent(),[2,{kid:t,xms_ksl:Hs.SW}]}})})},o.prototype.signPopToken=function(e,t){var n;return z(this,void 0,void 0,function(){var r;return D(this,function(s){if(r=ye.extractTokenClaims(e,this.cryptoUtils),!(!((n=r?.cnf)===null||n===void 0)&&n.kid))throw C.createTokenClaimsRequiredError();return[2,this.signPayload(e,r.cnf.kid,t)]})})},o.prototype.signPayload=function(e,t,n,r){return z(this,void 0,void 0,function(){var s,a,i,c,l,d;return D(this,function(u){switch(u.label){case 0:return s=n.resourceRequestMethod,a=n.resourceRequestUri,i=n.shrClaims,c=n.shrNonce,l=a?new K(a):void 0,d=l?.getUrlComponents(),[4,this.cryptoUtils.signJwt(me({at:e,ts:Se.nowSeconds(),m:s?.toUpperCase(),u:d?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:d?.AbsolutePath,q:d?.QueryString?[[],d.QueryString]:void 0,client_claims:i||void 0},r),t)];case 1:return[2,u.sent()]}})})},o}();var Go=function(){function o(){}return o.prototype.generateAppMetadataKey=function(){return o.generateAppMetadataCacheKey(this.environment,this.clientId)},o.generateAppMetadataCacheKey=function(e,t){var n=[En,e,t];return n.join(he.CACHE_KEY_SEPARATOR).toLowerCase()},o.createAppMetadataEntity=function(e,t,n){var r=new o;return r.clientId=e,r.environment=t,n&&(r.familyId=n),r},o.isAppMetadataEntity=function(e,t){return t?e.indexOf(En)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"):!1},o}();var Kl=function(){function o(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(o.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),o}();var uo=function(){function o(e,t,n,r,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=s,this.persistencePlugin=a}return o.prototype.validateServerAuthorizationCodeResponse=function(e,t,n){if(!e.state||!t)throw e.state?C.createStateNotFoundError("Cached State"):C.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw C.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw $e.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new $e(e.error||_.EMPTY_STRING,e.error_description,e.suberror):new nt(e.error||_.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&lo(e.client_info,n)},o.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if($e.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new $e(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new nt(e.error,t,e.suberror)}},o.prototype.handleServerTokenResponse=function(e,t,n,r,s,a,i){return z(this,void 0,void 0,function(){var c,l,d,u,p,m;return D(this,function(g){switch(g.label){case 0:if(e.id_token&&(c=new ye(e.id_token||_.EMPTY_STRING,this.cryptoObj),s&&!x.isEmpty(s.nonce)&&c.claims.nonce!==s.nonce))throw C.createNonceMismatchError();this.homeAccountIdentifier=de.generateHomeAccountId(e.client_info||_.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,c),!!s&&!!s.state&&(l=rt.parseRequestState(this.cryptoObj,s.state)),e.key_id=e.key_id||r.sshKid||void 0,d=this.generateCacheRecord(e,t,n,r,c,a,s),g.label=1;case 1:return g.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),u=new Kl(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(u)]):[3,3];case 2:g.sent(),g.label=3;case 3:return i&&d.account&&(p=d.account.generateAccountKey(),m=this.cacheStorage.getAccount(p),!m)?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,o.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,c,l)]):[4,this.cacheStorage.saveCacheRecord(d)];case 4:return g.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&u?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(u)]):[3,7];case 6:g.sent(),g.label=7;case 7:return[7];case 8:return[2,o.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,c,l,e.spa_code)]}})})},o.prototype.generateCacheRecord=function(e,t,n,r,s,a,i){var c=t.getPreferredCache();if(x.isEmpty(c))throw C.createInvalidCacheEnvironmentError();var l,d;!x.isEmpty(e.id_token)&&!!s&&(l=Ut.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token||_.EMPTY_STRING,this.clientId,s.claims.tid||_.EMPTY_STRING,a),d=this.generateAccountEntity(e,s,t,a,i));var u=null;if(!x.isEmpty(e.access_token)){var p=e.scope?Ce.fromString(e.scope):new Ce(r.scopes||[]),m=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,g=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,E=n+m,I=E+g,N=y&&y>0?n+y:void 0;u=Ft.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token||_.EMPTY_STRING,this.clientId,s?s.claims.tid||_.EMPTY_STRING:t.tenant,p.printScopes(),E,I,this.cryptoObj,N,e.token_type,a,e.key_id,r.claims,r.requestedClaimsHash)}var w=null;x.isEmpty(e.refresh_token)||(w=Bo.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token||_.EMPTY_STRING,this.clientId,e.foci,a));var ke=null;return x.isEmpty(e.foci)||(ke=Go.createAppMetadataEntity(this.clientId,c,e.foci)),new Gl(d,l,u,w,ke)},o.prototype.generateAccountEntity=function(e,t,n,r,s){var a=n.authorityType,i=s?s.cloud_graph_host_name:"",c=s?s.msgraph_host:"";if(a===ot.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),de.createGenericAccount(this.homeAccountIdentifier,t,n,r,i,c);if(x.isEmpty(e.client_info)&&n.protocolMode==="AAD")throw C.createClientInfoEmptyError();return e.client_info?de.createAccount(e.client_info,this.homeAccountIdentifier,t,n,r,i,c):de.createGenericAccount(this.homeAccountIdentifier,t,n,r,i,c)},o.generateAuthenticationResult=function(e,t,n,r,s,a,i,c){var l,d,u;return z(this,void 0,void 0,function(){var p,m,g,y,E,I,N,w;return D(this,function(ke){switch(ke.label){case 0:return p="",m=[],g=null,E=_.EMPTY_STRING,n.accessToken?n.accessToken.tokenType!==ee.POP?[3,2]:(I=new Vo(e),[4,I.signPopToken(n.accessToken.secret,s)]):[3,4];case 1:return p=ke.sent(),[3,3];case 2:p=n.accessToken.secret,ke.label=3;case 3:m=Ce.fromString(n.accessToken.target).asArray(),g=new Date(Number(n.accessToken.expiresOn)*1e3),y=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),ke.label=4;case 4:return n.appMetadata&&(E=n.appMetadata.familyId===Fo?Fo:_.EMPTY_STRING),N=a?.claims.oid||a?.claims.sub||_.EMPTY_STRING,w=a?.claims.tid||_.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:N,tenantId:w,scopes:m,account:n.account?n.account.getAccountInfo():null,idToken:a?a.rawToken:_.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:p,fromCache:r,expiresOn:g,correlationId:s.correlationId,extExpiresOn:y,familyId:E,tokenType:((l=n.accessToken)===null||l===void 0?void 0:l.tokenType)||_.EMPTY_STRING,state:i?i.userRequestState:_.EMPTY_STRING,cloudGraphHostName:((d=n.account)===null||d===void 0?void 0:d.cloudGraphHostName)||_.EMPTY_STRING,msGraphHost:((u=n.account)===null||u===void 0?void 0:u.msGraphHost)||_.EMPTY_STRING,code:c}]}})})},o}();var kn=function(o){le(e,o);function e(t){var n=o.call(this,t)||this;return n.includeRedirectUri=!0,n}return e.prototype.getAuthCodeUrl=function(t){return z(this,void 0,void 0,function(){var n;return D(this,function(r){return n=this.createAuthCodeUrlQueryString(t),[2,K.appendQueryString(this.authority.authorizationEndpoint,n)]})})},e.prototype.acquireToken=function(t,n){return z(this,void 0,void 0,function(){var r,s,a;return D(this,function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!t||x.isEmpty(t.code))throw C.createTokenRequestCannotBeMadeError();return r=Se.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return s=i.sent(),a=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),a.validateTokenResponse(s.body),[4,a.handleServerTokenResponse(s.body,this.authority,r,t,n)];case 2:return[2,i.sent()]}})})},e.prototype.handleFragmentResponse=function(t,n){var r=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),s=new K(t),a=K.getDeserializedHash(s.getHash());if(r.validateServerAuthorizationCodeResponse(a,n,this.cryptoUtils),!a.code)throw C.createNoAuthCodeInServerResponseError();return me(me({},a),{code:a.code})},e.prototype.getLogoutUri=function(t){if(!t)throw Y.createEmptyLogoutRequestError();var n=this.createLogoutUrlQueryString(t);return K.appendQueryString(this.authority.endSessionEndpoint,n)},e.prototype.executeTokenRequest=function(t,n){return z(this,void 0,void 0,function(){var r,s,a,i,c,l,d;return D(this,function(u){switch(u.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},[4,this.createTokenRequestBody(n)];case 1:if(s=u.sent(),a=this.createTokenQueryParameters(n),i=void 0,n.clientInfo)try{c=lo(n.clientInfo,this.cryptoUtils),i={credential:""+c.uid+he.CLIENT_INFO_SEPARATOR+c.utid,type:be.HOME_ACCOUNT_ID}}catch(p){this.logger.verbose("Could not parse client info for CCS Header: "+p)}return l=this.createTokenRequestHeaders(i||n.ccsCredential),d=x.isEmpty(a)?t.tokenEndpoint:t.tokenEndpoint+"?"+a,[2,this.executePostToTokenEndpoint(d,s,l,r)]}})})},e.prototype.createTokenQueryParameters=function(t){var n=new Ot;return t.tokenQueryParameters&&n.addExtraQueryParameters(t.tokenQueryParameters),n.createQueryString()},e.prototype.createTokenRequestBody=function(t){return z(this,void 0,void 0,function(){var n,r,s,a,i,c,l,l,d;return D(this,function(u){switch(u.label){case 0:return n=new Ot,n.addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(t.redirectUri):vt.validateRedirectUri(t.redirectUri),n.addScopes(t.scopes),n.addAuthorizationCode(t.code),n.addLibraryInfo(this.config.libraryInfo),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&n.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,n.addClientAssertion(r.assertion),n.addClientAssertionType(r.assertionType)),n.addGrantType(Uo.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),t.authenticationScheme!==ee.POP?[3,2]:(s=new Vo(this.cryptoUtils),[4,s.generateCnf(t)]);case 1:return a=u.sent(),n.addPopToken(a),[3,3];case 2:if(t.authenticationScheme===ee.SSH)if(t.sshJwk)n.addSshJwk(t.sshJwk);else throw Y.createMissingSshJwkError();u.label=3;case 3:if(i=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(i),(!x.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),c=void 0,t.clientInfo)try{l=lo(t.clientInfo,this.cryptoUtils),c={credential:""+l.uid+he.CLIENT_INFO_SEPARATOR+l.utid,type:be.HOME_ACCOUNT_ID}}catch(p){this.logger.verbose("Could not parse client info for CCS Header: "+p)}else c=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case be.HOME_ACCOUNT_ID:try{l=zt(c.credential),n.addCcsOid(l)}catch(p){this.logger.verbose("Could not parse home account ID for CCS Header: "+p)}break;case be.UPN:n.addCcsUpn(c.credential);break}return t.tokenBodyParameters&&n.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[G.RETURN_SPA_CODE])&&n.addExtraQueryParameters((d={},d[G.RETURN_SPA_CODE]="1",d)),[2,n.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){var n=new Ot;n.addClientId(this.config.authOptions.clientId);var r=Pt(t.scopes||[],t.extraScopesToConsent||[]);n.addScopes(r),n.addRedirectUri(t.redirectUri);var s=t.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(s),n.addResponseMode(t.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),n.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&n.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&n.addPrompt(t.prompt),t.domainHint&&n.addDomainHint(t.domainHint),t.prompt!==tt.SELECT_ACCOUNT)if(t.sid&&t.prompt===tt.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(t.sid);else if(t.account){var a=this.extractAccountSid(t.account);if(a&&t.prompt===tt.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(a);try{var i=zt(t.account.homeAccountId);n.addCcsOid(i)}catch(c){this.logger.verbose("Could not parse home account ID for CCS Header: "+c)}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(t.loginHint),n.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(t.account.username);try{var i=zt(t.account.homeAccountId);n.addCcsOid(i)}catch(c){this.logger.verbose("Could not parse home account ID for CCS Header: "+c)}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(t.loginHint),n.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&n.addNonce(t.nonce),t.state&&n.addState(t.state),(!x.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&n.addExtraQueryParameters(t.extraQueryParameters),n.createQueryString()},e.prototype.createLogoutUrlQueryString=function(t){var n=new Ot;return t.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&n.addCorrelationId(t.correlationId),t.idTokenHint&&n.addIdTokenHint(t.idTokenHint),t.state&&n.addState(t.state),t.logoutHint&&n.addLogoutHint(t.logoutHint),t.extraQueryParameters&&n.addExtraQueryParameters(t.extraQueryParameters),n.createQueryString()},e.prototype.extractAccountSid=function(t){if(t.idTokenClaims){var n=t.idTokenClaims;return n.sid||null}return null},e}(qo);var An=function(o){le(e,o);function e(t){return o.call(this,t)||this}return e.prototype.acquireToken=function(t){return z(this,void 0,void 0,function(){var n,r,s;return D(this,function(a){switch(a.label){case 0:return n=Se.nowSeconds(),[4,this.executeTokenRequest(t,this.authority)];case 1:return r=a.sent(),s=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),s.validateTokenResponse(r.body),[2,s.handleServerTokenResponse(r.body,this.authority,n,t,void 0,void 0,!0)]}})})},e.prototype.acquireTokenByRefreshToken=function(t){return z(this,void 0,void 0,function(){var n,r,s;return D(this,function(a){if(!t)throw Y.createEmptyTokenRequestError();if(!t.account)throw C.createNoAccountInSilentRequestError();if(n=this.cacheManager.isAppMetadataFOCI(t.account.environment,this.config.authOptions.clientId),n)try{return[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(i){if(r=i instanceof $e&&i.errorCode===$o.noTokensFoundError.code,s=i instanceof nt&&i.errorCode===Us.INVALID_GRANT_ERROR&&i.subError===Us.CLIENT_MISMATCH_ERROR,r||s)return[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw i}return[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,n){return z(this,void 0,void 0,function(){var r,s;return D(this,function(a){if(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,t.account,n),!r)throw $e.createNoTokensFoundError();return s=me(me({},t),{refreshToken:r.secret,authenticationScheme:t.authenticationScheme||ee.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:be.HOME_ACCOUNT_ID}}),[2,this.acquireToken(s)]})})},e.prototype.executeTokenRequest=function(t,n){return z(this,void 0,void 0,function(){var r,s,a,i,c;return D(this,function(l){switch(l.label){case 0:return[4,this.createTokenRequestBody(t)];case 1:return r=l.sent(),s=this.createTokenQueryParameters(t),a=this.createTokenRequestHeaders(t.ccsCredential),i={clientId:this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},c=K.appendQueryString(n.tokenEndpoint,s),[2,this.executePostToTokenEndpoint(c,r,a,i)]}})})},e.prototype.createTokenQueryParameters=function(t){var n=new Ot;return t.tokenQueryParameters&&n.addExtraQueryParameters(t.tokenQueryParameters),n.createQueryString()},e.prototype.createTokenRequestBody=function(t){return z(this,void 0,void 0,function(){var n,r,s,a,i,c;return D(this,function(l){switch(l.label){case 0:return n=new Ot,n.addClientId(this.config.authOptions.clientId),n.addScopes(t.scopes),n.addGrantType(Uo.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),r=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(r),n.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,n.addClientAssertion(s.assertion),n.addClientAssertionType(s.assertionType)),t.authenticationScheme!==ee.POP?[3,2]:(a=new Vo(this.cryptoUtils),[4,a.generateCnf(t)]);case 1:return i=l.sent(),n.addPopToken(i),[3,3];case 2:if(t.authenticationScheme===ee.SSH)if(t.sshJwk)n.addSshJwk(t.sshJwk);else throw Y.createMissingSshJwkError();l.label=3;case 3:if((!x.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case be.HOME_ACCOUNT_ID:try{c=zt(t.ccsCredential.credential),n.addCcsOid(c)}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case be.UPN:n.addCcsUpn(t.ccsCredential.credential);break}return[2,n.createQueryString()]}})})},e}(qo);var qs=function(o){le(e,o);function e(t){return o.call(this,t)||this}return e.prototype.acquireToken=function(t){return z(this,void 0,void 0,function(){var n,r;return D(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,s.sent()];case 2:if(n=s.sent(),n instanceof C&&n.errorCode===S.tokenRefreshRequired.code)return r=new An(this.config),[2,r.acquireTokenByRefreshToken(t)];throw n;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var n,r,s,a;return z(this,void 0,void 0,function(){var i,c;return D(this,function(l){switch(l.label){case 0:if(!t)throw Y.createEmptyTokenRequestError();if(t.forceRefresh)throw(n=this.serverTelemetryManager)===null||n===void 0||n.setCacheOutcome(_t.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),C.createRefreshRequiredError();if(!t.account)throw C.createNoAccountInSilentRequestError();if(i=t.authority||this.authority.getPreferredCache(),c=this.cacheManager.readCacheRecord(t.account,this.config.authOptions.clientId,t,i),c.accessToken){if(Se.wasClockTurnedBack(c.accessToken.cachedAt)||Se.isTokenExpired(c.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(s=this.serverTelemetryManager)===null||s===void 0||s.setCacheOutcome(_t.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),C.createRefreshRequiredError();if(c.accessToken.refreshOn&&Se.isTokenExpired(c.accessToken.refreshOn,0))throw(a=this.serverTelemetryManager)===null||a===void 0||a.setCacheOutcome(_t.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),C.createRefreshRequiredError()}else throw(r=this.serverTelemetryManager)===null||r===void 0||r.setCacheOutcome(_t.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),C.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(c,t)];case 1:return[2,l.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,n){return z(this,void 0,void 0,function(){var r;return D(this,function(s){switch(s.label){case 0:return t.idToken&&(r=new ye(t.idToken.secret,this.config.cryptoInterface)),[4,uo.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,n,r)];case 1:return[2,s.sent()]}})})},e}(qo);function Wl(o){return o.hasOwnProperty("authorization_endpoint")&&o.hasOwnProperty("token_endpoint")&&o.hasOwnProperty("issuer")}var Ht;(function(o){o.AAD="AAD",o.OIDC="OIDC"})(Ht||(Ht={}));var Ko=function(){function o(){this.expiresAt=Se.nowSeconds()+co.REFRESH_TIME_SECONDS}return o.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},o.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},o.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},o.prototype.resetExpiresAt=function(){this.expiresAt=Se.nowSeconds()+co.REFRESH_TIME_SECONDS},o.prototype.isExpired=function(){return this.expiresAt<=Se.nowSeconds()},o.isAuthorityMetadataEntity=function(e,t){return t?e.indexOf(co.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"):!1},o}();function Yl(o){return o.hasOwnProperty("tenant_discovery_endpoint")&&o.hasOwnProperty("metadata")}var jl=function(){function o(e){this.networkInterface=e}return o.prototype.detectRegion=function(e,t,n){return z(this,void 0,void 0,function(){var r,s,a,i,c;return D(this,function(l){switch(l.label){case 0:if(r=e,r)return[3,8];s=o.IMDS_OPTIONS,n&&(s.proxyUrl=n),l.label=1;case 1:return l.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(_.IMDS_VERSION,s)];case 2:return a=l.sent(),a.status===io.httpSuccess&&(r=a.body,t.region_source=ht.IMDS),a.status!==io.httpBadRequest?[3,5]:[4,this.getCurrentVersion(s)];case 3:return i=l.sent(),i?[4,this.getRegionFromIMDS(i,s)]:(t.region_source=ht.FAILED_AUTO_DETECTION,[2,null]);case 4:c=l.sent(),c.status===io.httpSuccess&&(r=c.body,t.region_source=ht.IMDS),l.label=5;case 5:return[3,7];case 6:return l.sent(),t.region_source=ht.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=ht.ENVIRONMENT_VARIABLE,l.label=9;case 9:return r||(t.region_source=ht.FAILED_AUTO_DETECTION),[2,r||null]}})})},o.prototype.getRegionFromIMDS=function(e,t){return z(this,void 0,void 0,function(){return D(this,function(n){return[2,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,_.IMDS_TIMEOUT)]})})},o.prototype.getCurrentVersion=function(e){return z(this,void 0,void 0,function(){var t;return D(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?format=json",e)];case 1:return t=n.sent(),t.status===io.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return n.sent(),[2,null];case 3:return[2]}})})},o.IMDS_OPTIONS={headers:{Metadata:"true"}},o}();var qt=function(){function o(e,t,n,r,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscovery=new jl(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=s||_.EMPTY_STRING}return Object.defineProperty(o.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===_.ADFS?ot.Adfs:ot.Default},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new K(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}else throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}else throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}else throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw C.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}else throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}else throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),o.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},o.prototype.replacePath=function(e){var t=e,n=new K(this.metadata.canonical_authority),r=n.getUrlComponents().PathSegments,s=this.canonicalAuthorityUrlComponents.PathSegments;return s.forEach(function(a,i){var c=r[i];a!==c&&(t=t.replace("/"+c+"/","/"+a+"/"))}),t},Object.defineProperty(o.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ot.Adfs||this.protocolMode===Ht.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),o.prototype.discoveryComplete=function(){return!!this.metadata},o.prototype.resolveEndpointsAsync=function(){return z(this,void 0,void 0,function(){var e,t,n,r;return D(this,function(s){switch(s.label){case 0:return e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort),e||(e=new Ko,e.updateCanonicalAuthority(this.canonicalAuthority)),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=s.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return n=s.sent(),t!==et.CACHE&&n!==et.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e,[2]}})})},o.prototype.updateEndpointMetadata=function(e){var t;return z(this,void 0,void 0,function(){var n,r,s;return D(this,function(a){switch(a.label){case 0:return n=this.getEndpointMetadataFromConfig(),n?(e.updateEndpointMetadata(n,!1),[2,et.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,et.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return n=a.sent(),n?!((t=this.authorityOptions.azureRegionConfiguration)===null||t===void 0)&&t.azureRegion?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)]:[3,3]:[3,4];case 2:r=a.sent(),s=this.authorityOptions.azureRegionConfiguration.azureRegion===_.AZURE_REGION_AUTO_DISCOVER_FLAG?r:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===_.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=r?Lt.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Lt.AUTO_DETECTION_REQUESTED_FAILED:r?this.regionDiscoveryMetadata.region_outcome=this.authorityOptions.azureRegionConfiguration.azureRegion===r?Lt.CONFIGURED_MATCHES_DETECTED:Lt.CONFIGURED_NOT_DETECTED:this.regionDiscoveryMetadata.region_outcome=Lt.CONFIGURED_NO_AUTO_DETECTION,s&&(this.regionDiscoveryMetadata.region_used=s,n=o.replaceWithRegionalInformation(n,s)),a.label=3;case 3:return e.updateEndpointMetadata(n,!0),[2,et.NETWORK];case 4:throw C.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},o.prototype.isAuthoritySameType=function(e){var t=new K(e.canonical_authority),n=t.getUrlComponents().PathSegments;return n.length===this.canonicalAuthorityUrlComponents.PathSegments.length},o.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Y.createInvalidAuthorityMetadataError()}return null},o.prototype.getEndpointMetadataFromNetwork=function(){return z(this,void 0,void 0,function(){var e,t;return D(this,function(n){switch(n.label){case 0:e={},this.proxyUrl&&(e.proxyUrl=this.proxyUrl),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:return t=n.sent(),[2,Wl(t.body)?t.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}})})},o.prototype.updateCloudDiscoveryMetadata=function(e){return z(this,void 0,void 0,function(){var t;return D(this,function(n){switch(n.label){case 0:return t=this.getCloudDiscoveryMetadataFromConfig(),t?(e.updateCloudDiscoveryMetadata(t,!1),[2,et.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,et.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=n.sent(),t)return e.updateCloudDiscoveryMetadata(t,!0),[2,et.NETWORK];throw Y.createUntrustedAuthorityError()}})})},o.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=o.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(t)return t}catch{throw Y.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?o.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},o.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return z(this,void 0,void 0,function(){var e,t,n,r,s;return D(this,function(a){switch(a.label){case 0:e=""+_.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",t={},this.proxyUrl&&(t.proxyUrl=this.proxyUrl),n=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(e,t)];case 2:return r=a.sent(),s=Yl(r.body)?r.body.metadata:[],s.length===0?[2,null]:(n=o.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4]);case 3:return a.sent(),[2,null];case 4:return n||(n=o.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,n]}})})},o.prototype.isInKnownAuthorities=function(){var e=this,t=this.authorityOptions.knownAuthorities.filter(function(n){return K.getDomainFromUrl(n).toLowerCase()===e.hostnameAndPort});return t.length>0},o.generateAuthority=function(e,t){var n;if(t&&t.azureCloudInstance!==dt.None){var r=t.tenant?t.tenant:_.DEFAULT_COMMON_TENANT;n=t.azureCloudInstance+"/"+r+"/"}return n||e},o.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},o.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.aliases.indexOf(t)>-1)return r}return null},o.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw C.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},o.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},o.isPublicCloudAuthority=function(e){return _.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},o.buildRegionalAuthorityString=function(e,t,n){var r=new K(e);r.validateAsUri();var s=r.getUrlComponents(),a=t+"."+s.HostNameAndPort;this.isPublicCloudAuthority(s.HostNameAndPort)&&(a=t+"."+_.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var i=K.constructAuthorityUriFromObject(me(me({},r.getUrlComponents()),{HostNameAndPort:a})).urlString;return n?i+"?"+n:i},o.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=o.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=o.buildRegionalAuthorityString(e.token_endpoint,t,"allowestsrnonmsi=true"),e.end_session_endpoint&&(e.end_session_endpoint=o.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},o}();var In=function(){function o(){}return o.createDiscoveredInstance=function(e,t,n,r,s){return z(this,void 0,void 0,function(){var a,i;return D(this,function(c){switch(c.label){case 0:a=o.createInstance(e,t,n,r,s),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,a.resolveEndpointsAsync()];case 2:return c.sent(),[2,a];case 3:throw i=c.sent(),C.createEndpointDiscoveryIncompleteError(i);case 4:return[2]}})})},o.createInstance=function(e,t,n,r,s){if(x.isEmpty(e))throw Y.createUrlEmptyError();return new qt(e,t,n,r,s)},o}();var po=function(){function o(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return o.isServerTelemetryEntity=function(e,t){var n=e.indexOf(_e.CACHE_KEY)===0,r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r},o}();var _r=function(){function o(){}return o.isThrottlingEntity=function(e,t){var n=!1;e&&(n=e.indexOf(Mt.THROTTLING_PREFIX)===0);var r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r},o}();var Bs={sendGetRequestAsync:function(){var o="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(L.createUnexpectedError(o))},sendPostRequestAsync:function(){var o="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(L.createUnexpectedError(o))}};var $s=function(){function o(e,t){this.cacheOutcome=_t.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||_.EMPTY_STRING,this.wrapperVer=e.wrapperVer||_.EMPTY_STRING,this.telemetryCacheKey=_e.CACHE_KEY+he.CACHE_KEY_SEPARATOR+e.clientId}return o.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+_e.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(_e.VALUE_SEPARATOR),n=this.getRegionDiscoveryFields(),r=[e,n].join(_e.VALUE_SEPARATOR);return[_e.SCHEMA_VERSION,r,t].join(_e.CATEGORY_SEPARATOR)},o.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=o.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(_e.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(_e.VALUE_SEPARATOR),s=e.errors.length,a=t<s?_e.OVERFLOW_TRUE:_e.OVERFLOW_FALSE,i=[s,a].join(_e.VALUE_SEPARATOR);return[_e.SCHEMA_VERSION,e.cacheHits,n,r,i].join(_e.CATEGORY_SEPARATOR)},o.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=_e.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),x.isEmpty(e.subError)?x.isEmpty(e.errorCode)?!!e&&e.toString()?t.errors.push(e.toString()):t.errors.push(_e.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},o.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},o.prototype.getLastRequests=function(){var e=new po,t=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return t||e},o.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=o.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new po;r.failedRequests=e.failedRequests.slice(t*2),r.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},o.maxErrorsToSend=function(e){var t,n=0,r=0,s=e.errors.length;for(t=0;t<s;t++){var a=e.failedRequests[2*t]||_.EMPTY_STRING,i=e.failedRequests[2*t+1]||_.EMPTY_STRING,c=e.errors[t]||_.EMPTY_STRING;if(r+=a.toString().length+i.toString().length+c.length+3,r<_e.MAX_LAST_HEADER_BYTES)n+=1;else break}return n},o.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||""),e.push(this.regionSource||""),e.push(this.regionOutcome||""),e.join(",")},o.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},o.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},o}();var ve={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",POLL_INTERVAL_MS:50,MSAL_SKU:"msal.js.browser"},xe;(function(o){o.LocalStorage="localStorage",o.SessionStorage="sessionStorage",o.MemoryStorage="memoryStorage"})(xe||(xe={}));var Ve;(function(o){o.GET="GET",o.POST="POST"})(Ve||(Ve={}));var X;(function(o){o.AUTHORITY="authority",o.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",o.SESSION_STATE="session.state",o.REQUEST_STATE="request.state",o.NONCE_IDTOKEN="nonce.id_token",o.ORIGIN_URI="request.origin",o.RENEW_STATUS="token.renew.status",o.URL_HASH="urlHash",o.REQUEST_PARAMS="request.params",o.SCOPES="scopes",o.INTERACTION_STATUS_KEY="interaction.status",o.CCS_CREDENTIAL="ccs.credential",o.CORRELATION_ID="request.correlationId"})(X||(X={}));var mo;(function(o){o.WRAPPER_SKU="wrapper.sku",o.WRAPPER_VER="wrapper.version"})(mo||(mo={}));var pe;(function(o){o[o.acquireTokenRedirect=861]="acquireTokenRedirect",o[o.acquireTokenPopup=862]="acquireTokenPopup",o[o.ssoSilent=863]="ssoSilent",o[o.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",o[o.handleRedirectPromise=865]="handleRedirectPromise",o[o.acquireTokenByCode=866]="acquireTokenByCode",o[o.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",o[o.logout=961]="logout",o[o.logoutPopup=962]="logoutPopup"})(pe||(pe={}));var R;(function(o){o.Redirect="redirect",o.Popup="popup",o.Silent="silent",o.None="none"})(R||(R={}));var Ql;(function(o){o.Startup="startup",o.Login="login",o.Logout="logout",o.AcquireToken="acquireToken",o.SsoSilent="ssoSilent",o.HandleRedirect="handleRedirect",o.None="none"})(Ql||(Ql={}));var Vs={scopes:xt},go="jwk",Jl;(function(o){o.React="@azure/msal-react",o.Angular="@azure/msal-angular"})(Jl||(Jl={}));var xr="msal.db",Xl=1,Zl=xr+".keys";var Te=function(){function o(){}return o.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},o}();var eu=function(){function o(e){this.cryptoObj=e}return o.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Te.decimalToHex(e[0])+Te.decimalToHex(e[1])+Te.decimalToHex(e[2])+Te.decimalToHex(e[3])+"-"+Te.decimalToHex(e[4])+Te.decimalToHex(e[5])+"-"+Te.decimalToHex(e[6])+Te.decimalToHex(e[7])+"-"+Te.decimalToHex(e[8])+Te.decimalToHex(e[9])+"-"+Te.decimalToHex(e[10])+Te.decimalToHex(e[11])+Te.decimalToHex(e[12])+Te.decimalToHex(e[13])+Te.decimalToHex(e[14])+Te.decimalToHex(e[15])}catch{for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",r=0,s="",a=0;a<36;a++)t[a]!=="-"&&t[a]!=="4"&&(r=Math.random()*16|0),t[a]==="x"?s+=n[r]:t[a]==="y"?(r&=3,r|=8,s+=n[r]):s+=t[a];return s}},o.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)},o}();var pt=function(){function o(){}return o.stringToUtf8Arr=function(e){for(var t,n=0,r=e.length,s=0;s<r;s++)t=e.charCodeAt(s),n+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var a=new Uint8Array(n),i=0,c=0;i<n;c++)t=e.charCodeAt(c),t<128?a[i++]=t:t<2048?(a[i++]=192+(t>>>6),a[i++]=128+(t&63)):t<65536?(a[i++]=224+(t>>>12),a[i++]=128+(t>>>6&63),a[i++]=128+(t&63)):t<2097152?(a[i++]=240+(t>>>18),a[i++]=128+(t>>>12&63),a[i++]=128+(t>>>6&63),a[i++]=128+(t&63)):t<67108864?(a[i++]=248+(t>>>24),a[i++]=128+(t>>>18&63),a[i++]=128+(t>>>12&63),a[i++]=128+(t>>>6&63),a[i++]=128+(t&63)):(a[i++]=252+(t>>>30),a[i++]=128+(t>>>24&63),a[i++]=128+(t>>>18&63),a[i++]=128+(t>>>12&63),a[i++]=128+(t>>>6&63),a[i++]=128+(t&63));return a},o.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t},o.utf8ArrToString=function(e){for(var t="",n=void 0,r=e.length,s=0;s<r;s++)n=e[s],t+=String.fromCharCode(n>251&&n<254&&s+5<r?(n-252)*1073741824+(e[++s]-128<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:n>247&&n<252&&s+4<r?(n-248<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:n>239&&n<248&&s+3<r?(n-240<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:n>223&&n<240&&s+2<r?(n-224<<12)+(e[++s]-128<<6)+e[++s]-128:n>191&&n<224&&s+1<r?(n-192<<6)+e[++s]-128:n);return t},o}();var br=function(){function o(){}return o.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},o.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},o.prototype.encode=function(e){var t=pt.stringToUtf8Arr(e);return this.base64EncArr(t)},o.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,n="",r=void 0,s=e.length,a=0,i=0;i<s;i++)r=i%3,a|=e[i]<<(16>>>r&24),(r===2||e.length-i===1)&&(n+=String.fromCharCode(this.uint6ToB64(a>>>18&63),this.uint6ToB64(a>>>12&63),this.uint6ToB64(a>>>6&63),this.uint6ToB64(a&63)),a=0);return t===0?n:n.substring(0,n.length-t)+(t===1?"=":"==")},o.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65},o}();var tu=function(){function o(){}return o.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var n=this.base64DecToArr(t);return pt.utf8ArrToString(n)},o.prototype.base64DecToArr=function(e,t){for(var n=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,s=t?Math.ceil((r*3+1>>>2)/t)*t:r*3+1>>>2,a=new Uint8Array(s),i=void 0,c=void 0,l=0,d=0,u=0;u<r;u++)if(c=u&3,l|=this.b64ToUint6(n.charCodeAt(u))<<18-6*c,c===3||r-u===1){for(i=0;i<3&&d<s;i++,d++)a[d]=l>>>(16>>>i&24)&255;l=0}return a},o.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:e===43?62:e===47?63:0},o}();var A={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."}},T=function(o){oe(e,o);function e(t,n){var r=o.call(this,t,n)||this;return Object.setPrototypeOf(r,e.prototype),r.name="BrowserAuthError",r}return e.createPkceNotGeneratedError=function(t){return new e(A.pkceNotGenerated.code,A.pkceNotGenerated.desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(A.cryptoDoesNotExist.code,A.cryptoDoesNotExist.desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(A.httpMethodNotImplementedError.code,A.httpMethodNotImplementedError.desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(A.emptyNavigateUriError.code,A.emptyNavigateUriError.desc)},e.createEmptyHashError=function(t){return new e(A.hashEmptyError.code,A.hashEmptyError.desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(A.hashDoesNotContainStateError.code,A.hashDoesNotContainStateError.desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(A.hashDoesNotContainKnownPropertiesError.code,A.hashDoesNotContainKnownPropertiesError.desc)},e.createUnableToParseStateError=function(){return new e(A.unableToParseStateError.code,A.unableToParseStateError.desc)},e.createStateInteractionTypeMismatchError=function(){return new e(A.stateInteractionTypeMismatchError.code,A.stateInteractionTypeMismatchError.desc)},e.createInteractionInProgressError=function(){return new e(A.interactionInProgress.code,A.interactionInProgress.desc)},e.createPopupWindowError=function(t){var n=A.popupWindowError.desc;return n=x.isEmpty(t)?n:n+" Details: "+t,new e(A.popupWindowError.code,n)},e.createEmptyWindowCreatedError=function(){return new e(A.emptyWindowError.code,A.emptyWindowError.desc)},e.createUserCancelledError=function(){return new e(A.userCancelledError.code,A.userCancelledError.desc)},e.createMonitorPopupTimeoutError=function(){return new e(A.monitorPopupTimeoutError.code,A.monitorPopupTimeoutError.desc)},e.createMonitorIframeTimeoutError=function(){return new e(A.monitorIframeTimeoutError.code,A.monitorIframeTimeoutError.desc)},e.createRedirectInIframeError=function(t){return new e(A.redirectInIframeError.code,A.redirectInIframeError.desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(A.blockTokenRequestsInHiddenIframeError.code,A.blockTokenRequestsInHiddenIframeError.desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(A.blockAcquireTokenInPopupsError.code,A.blockAcquireTokenInPopupsError.desc)},e.createIframeClosedPrematurelyError=function(){return new e(A.iframeClosedPrematurelyError.code,A.iframeClosedPrematurelyError.desc)},e.createSilentLogoutUnsupportedError=function(){return new e(A.silentLogoutUnsupportedError.code,A.silentLogoutUnsupportedError.desc)},e.createNoAccountError=function(){return new e(A.noAccountError.code,A.noAccountError.desc)},e.createSilentPromptValueError=function(t){return new e(A.silentPromptValueError.code,A.silentPromptValueError.desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(A.unableToParseTokenRequestCacheError.code,A.unableToParseTokenRequestCacheError.desc)},e.createNoTokenRequestCacheError=function(){return new e(A.noTokenRequestCacheError.code,A.noTokenRequestCacheError.desc)},e.createAuthRequestNotSetError=function(){return new e(A.authRequestNotSet.code,A.authRequestNotSet.desc)},e.createNoCachedAuthorityError=function(){return new e(A.noCachedAuthorityError.code,A.noCachedAuthorityError.desc)},e.createInvalidCacheTypeError=function(){return new e(A.invalidCacheType.code,""+A.invalidCacheType.desc)},e.createNonBrowserEnvironmentError=function(){return new e(A.notInBrowserEnvironment.code,A.notInBrowserEnvironment.desc)},e.createDatabaseNotOpenError=function(){return new e(A.databaseNotOpen.code,A.databaseNotOpen.desc)},e.createNoNetworkConnectivityError=function(){return new e(A.noNetworkConnectivity.code,A.noNetworkConnectivity.desc)},e.createPostRequestFailedError=function(t,n){return new e(A.postRequestFailed.code,A.postRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+n.split("?")[0])},e.createGetRequestFailedError=function(t,n){return new e(A.getRequestFailed.code,A.getRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+n.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(A.failedToParseNetworkResponse.code,A.failedToParseNetworkResponse.desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(A.unableToLoadTokenError.code,A.unableToLoadTokenError.desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(A.signingKeyNotFoundInStorage.code,A.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(A.authCodeRequired.code,A.authCodeRequired.desc)},e.createDatabaseUnavailableError=function(){return new e(A.databaseUnavailable.code,A.databaseUnavailable.desc)},e}(L);var Gg=32,ou=function(){function o(e){this.base64Encode=new br,this.cryptoObj=e}return o.prototype.generateCodes=function(){return b(this,void 0,void 0,function(){var e,t;return v(this,function(n){switch(n.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=n.sent(),[2,{verifier:e,challenge:t}]}})})},o.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(Gg);this.cryptoObj.getRandomValues(e);var t=this.base64Encode.urlEncodeArr(e);return t}catch(n){throw T.createPkceNotGeneratedError(n)}},o.prototype.generateCodeChallengeFromVerifier=function(e){return b(this,void 0,void 0,function(){var t,n;return v(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw n=r.sent(),T.createPkceNotGeneratedError(n);case 3:return[2]}})})},o}();var Kg="RSASSA-PKCS1-v1_5",Gs="SHA-256",Wg=2048,Yg=new Uint8Array([1,0,1]),vr=function(){function o(e){if(this.logger=e,!this.hasCryptoAPI())throw T.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:Kg,hash:Gs,modulusLength:Wg,publicExponent:Yg}}return o.prototype.sha256Digest=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){return t=pt.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(Gs,t):this.getSubtleCryptoDigest(Gs,t)]})})},o.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw T.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},o.prototype.generateKeyPair=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]})})},o.prototype.exportJwk=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(go,e)]})})},o.prototype.importJwk=function(e,t,n){return b(this,void 0,void 0,function(){var r,s;return v(this,function(a){return r=o.getJwkString(e),s=pt.stringToArrayBuffer(r),[2,this.hasIECrypto()?this.msCryptoImportKey(s,t,n):window.crypto.subtle.importKey(go,e,this._keygenAlgorithmOptions,t,n)]})})},o.prototype.sign=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]})})},o.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},o.prototype.hasIECrypto=function(){return"msCrypto"in window},o.prototype.hasBrowserCrypto=function(){return"crypto"in window},o.prototype.getSubtleCryptoDigest=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,window.crypto.subtle.digest(e,t)]})})},o.prototype.getMSCryptoDigest=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,new Promise(function(r,s){var a=window.msCrypto.subtle.digest(e,t.buffer);a.addEventListener("complete",function(i){r(i.target.result)}),a.addEventListener("error",function(i){s(i)})})]})})},o.prototype.msCryptoGenerateKey=function(e,t){return b(this,void 0,void 0,function(){var n=this;return v(this,function(r){return[2,new Promise(function(s,a){var i=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(c){s(c.target.result)}),i.addEventListener("error",function(c){a(c)})})]})})},o.prototype.msCryptoExportJwk=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){return[2,new Promise(function(n,r){var s=window.msCrypto.subtle.exportKey(go,e);s.addEventListener("complete",function(a){var i=a.target.result,c=pt.utf8ArrToString(new Uint8Array(i)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{n(JSON.parse(c))}catch(l){r(l)}}),s.addEventListener("error",function(a){r(a)})})]})})},o.prototype.msCryptoImportKey=function(e,t,n){return b(this,void 0,void 0,function(){var r=this;return v(this,function(s){return[2,new Promise(function(a,i){var c=window.msCrypto.subtle.importKey(go,e,r._keygenAlgorithmOptions,t,n);c.addEventListener("complete",function(l){a(l.target.result)}),c.addEventListener("error",function(l){i(l)})})]})})},o.prototype.msCryptoSign=function(e,t){return b(this,void 0,void 0,function(){var n=this;return v(this,function(r){return[2,new Promise(function(s,a){var i=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(c){s(c.target.result)}),i.addEventListener("error",function(c){a(c)})})]})})},o.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},o}();var nu=function(){function o(){this.dbName=xr,this.version=Xl,this.tableName=Zl,this.dbOpen=!1}return o.prototype.open=function(){return b(this,void 0,void 0,function(){var e=this;return v(this,function(t){return[2,new Promise(function(n,r){var s=window.indexedDB.open(e.dbName,e.version);s.addEventListener("upgradeneeded",function(a){var i=a;i.target.result.createObjectStore(e.tableName)}),s.addEventListener("success",function(a){var i=a;e.db=i.target.result,e.dbOpen=!0,n()}),s.addEventListener("error",function(){return r(T.createDatabaseUnavailableError())})})]})})},o.prototype.validateDbIsOpen=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},o.prototype.getItem=function(e){return b(this,void 0,void 0,function(){var t=this;return v(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,s){if(!t.db)return s(T.createDatabaseNotOpenError());var a=t.db.transaction([t.tableName],"readonly"),i=a.objectStore(t.tableName),c=i.get(e);c.addEventListener("success",function(l){var d=l;r(d.target.result)}),c.addEventListener("error",function(l){return s(l)})})]}})})},o.prototype.setItem=function(e,t){return b(this,void 0,void 0,function(){var n=this;return v(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(s,a){if(!n.db)return a(T.createDatabaseNotOpenError());var i=n.db.transaction([n.tableName],"readwrite"),c=i.objectStore(n.tableName),l=c.put(t,e);l.addEventListener("success",function(){return s()}),l.addEventListener("error",function(d){return a(d)})})]}})})},o.prototype.removeItem=function(e){return b(this,void 0,void 0,function(){var t=this;return v(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,s){if(!t.db)return s(T.createDatabaseNotOpenError());var a=t.db.transaction([t.tableName],"readwrite"),i=a.objectStore(t.tableName),c=i.delete(e);c.addEventListener("success",function(){return r()}),c.addEventListener("error",function(l){return s(l)})})]}})})},o.prototype.getKeys=function(){return b(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(n,r){if(!e.db)return r(T.createDatabaseNotOpenError());var s=e.db.transaction([e.tableName],"readonly"),a=s.objectStore(e.tableName),i=a.getAllKeys();i.addEventListener("success",function(c){var l=c;n(l.target.result)}),i.addEventListener("error",function(c){return r(c)})})]}})})},o.prototype.containsKey=function(e){return b(this,void 0,void 0,function(){var t=this;return v(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,s){if(!t.db)return s(T.createDatabaseNotOpenError());var a=t.db.transaction([t.tableName],"readonly"),i=a.objectStore(t.tableName),c=i.count(e);c.addEventListener("success",function(l){var d=l;r(d.target.result===1)}),c.addEventListener("error",function(l){return s(l)})})]}})})},o.prototype.deleteDatabase=function(){return b(this,void 0,void 0,function(){return v(this,function(e){return[2,new Promise(function(t,n){var r=window.indexedDB.deleteDatabase(xr);r.addEventListener("success",function(){return t(!0)}),r.addEventListener("error",function(){return n(!1)})})]})})},o}();var Rn=function(){function o(){this.cache=new Map}return o.prototype.getItem=function(e){return this.cache.get(e)||null},o.prototype.setItem=function(e,t){this.cache.set(e,t)},o.prototype.removeItem=function(e){this.cache.delete(e)},o.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,n){e.push(n)}),e},o.prototype.containsKey=function(e){return this.cache.has(e)},o.prototype.clear=function(){this.cache.clear()},o}();var Ks=function(){function o(e){this.inMemoryCache=new Rn,this.indexedDBCache=new nu,this.logger=e}return o.prototype.handleDatabaseAccessError=function(e){e instanceof T&&e.errorCode===A.databaseUnavailable.code&&this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},o.prototype.getItem=function(e){return b(this,void 0,void 0,function(){var t,n;return v(this,function(r){switch(r.label){case 0:if(t=this.inMemoryCache.getItem(e),t)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}})})},o.prototype.setItem=function(e,t){return b(this,void 0,void 0,function(){var n;return v(this,function(r){switch(r.label){case 0:this.inMemoryCache.setItem(e,t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2]}})})},o.prototype.removeItem=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){switch(n.label){case 0:this.inMemoryCache.removeItem(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},o.prototype.getKeys=function(){return b(this,void 0,void 0,function(){var e,t;return v(this,function(n){switch(n.label){case 0:if(e=this.inMemoryCache.getKeys(),e.length!==0)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},o.prototype.containsKey=function(e){return b(this,void 0,void 0,function(){var t,n;return v(this,function(r){switch(r.label){case 0:if(t=this.inMemoryCache.containsKey(e),t)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}})})},o.prototype.clear=function(){return b(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.inMemoryCache.clear(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.handleDatabaseAccessError(e),[3,4];case 4:return[2]}})})},o}();var ru=function(){function o(e){this.logger=e,this.browserCrypto=new vr(this.logger),this.b64Encode=new br,this.b64Decode=new tu,this.guidGenerator=new eu(this.browserCrypto),this.pkceGenerator=new ou(this.browserCrypto),this.cache={asymmetricKeys:new Ks(this.logger),symmetricKeys:new Ks(this.logger)}}return o.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},o.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},o.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},o.prototype.generatePkceCodes=function(){return b(this,void 0,void 0,function(){return v(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},o.prototype.getPublicKeyThumbprint=function(e){return b(this,void 0,void 0,function(){var t,n,r,s,a,i,c;return v(this,function(l){switch(l.label){case 0:return[4,this.browserCrypto.generateKeyPair(o.EXTRACTABLE,o.POP_KEY_USAGES)];case 1:return t=l.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return n=l.sent(),r={e:n.e,kty:n.kty,n:n.n},s=vr.getJwkString(r),[4,this.hashString(s)];case 3:return a=l.sent(),[4,this.browserCrypto.exportJwk(t.privateKey)];case 4:return i=l.sent(),[4,this.browserCrypto.importJwk(i,!1,["sign"])];case 5:return c=l.sent(),[4,this.cache.asymmetricKeys.setItem(a,{privateKey:c,publicKey:t.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return l.sent(),[2,a]}})})},o.prototype.removeTokenBindingKey=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){switch(n.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return n.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return t=n.sent(),[2,!t]}})})},o.prototype.clearKeystore=function(){return b(this,void 0,void 0,function(){var e,t,n;return v(this,function(r){switch(r.label){case 0:return e=Object.keys(this.cache),t=this.cache[e[0]],t?[4,t.deleteDatabase()]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=!1,r.label=3;case 3:return[2,n]}})})},o.prototype.signJwt=function(e,t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c,l,d,u,p;return v(this,function(m){switch(m.label){case 0:return[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(n=m.sent(),!n)throw T.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return r=m.sent(),s=vr.getJwkString(r),a={alg:r.alg,type:go},i=this.b64Encode.urlEncode(JSON.stringify(a)),e.cnf={jwk:JSON.parse(s)},c=this.b64Encode.urlEncode(JSON.stringify(e)),l=i+"."+c,d=pt.stringToArrayBuffer(l),[4,this.browserCrypto.sign(n.privateKey,d)];case 3:return u=m.sent(),p=this.b64Encode.urlEncodeArr(new Uint8Array(u)),[2,l+"."+p]}})})},o.prototype.hashString=function(e){return b(this,void 0,void 0,function(){var t,n;return v(this,function(r){switch(r.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=r.sent(),n=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(n)]}})})},o.POP_KEY_USAGES=["sign","verify"],o.EXTRACTABLE=!0,o}();var Ge={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},Pn=function(o){oe(e,o);function e(t,n){var r=o.call(this,t,n)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,e.prototype),r}return e.createRedirectUriEmptyError=function(){return new e(Ge.redirectUriNotSet.code,Ge.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Ge.postLogoutUriNotSet.code,Ge.postLogoutUriNotSet.desc)},e.createStorageNotSupportedError=function(t){return new e(Ge.storageNotSupportedError.code,Ge.storageNotSupportedError.desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(Ge.noRedirectCallbacksSet.code,Ge.noRedirectCallbacksSet.desc)},e.createStubPcaInstanceCalledError=function(){return new e(Ge.stubPcaInstanceCalled.code,Ge.stubPcaInstanceCalled.desc)},e.createInMemoryRedirectUnavailableError=function(){return new e(Ge.inMemRedirectUnavailable.code,Ge.inMemRedirectUnavailable.desc)},e}(L);var Ws=function(){function o(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return o.prototype.validateWindowStorage=function(e){if(e!==xe.LocalStorage&&e!==xe.SessionStorage)throw Pn.createStorageNotSupportedError(e);var t=!!window[e];if(!t)throw Pn.createStorageNotSupportedError(e)},o.prototype.getItem=function(e){return this.windowStorage.getItem(e)},o.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},o.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},o.prototype.getKeys=function(){return Object.keys(this.windowStorage)},o.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},o}();var yr=function(){function o(){}return o.extractBrowserRequestState=function(e,t){if(x.isEmpty(t))return null;try{var n=rt.parseRequestState(e,t);return n.libraryState.meta}catch(r){throw C.createInvalidStateError(t,r)}},o.parseServerResponseFromHash=function(e){if(!e)return{};var t=new K(e);return K.getDeserializedHash(t.getHash())},o}();var Ys=function(o){oe(e,o);function e(t,n,r,s){var a=o.call(this,t,r)||this;return a.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,a.cacheConfig=n,a.logger=s,a.internalStorage=new Rn,a.browserStorage=a.setupBrowserStorage(a.cacheConfig.cacheLocation),a.temporaryCacheStorage=a.setupTemporaryCacheStorage(a.cacheConfig.cacheLocation),a.migrateCacheEntries(),a}return e.prototype.setupBrowserStorage=function(t){switch(t){case xe.LocalStorage:case xe.SessionStorage:try{return new Ws(t)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=xe.MemoryStorage,new Rn},e.prototype.setupTemporaryCacheStorage=function(t){switch(t){case xe.LocalStorage:case xe.SessionStorage:try{return new Ws(xe.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}case xe.MemoryStorage:default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,n=_.CACHE_PREFIX+"."+fe.ID_TOKEN,r=_.CACHE_PREFIX+"."+fe.CLIENT_INFO,s=_.CACHE_PREFIX+"."+fe.ERROR,a=_.CACHE_PREFIX+"."+fe.ERROR_DESC,i=this.browserStorage.getItem(n),c=this.browserStorage.getItem(r),l=this.browserStorage.getItem(s),d=this.browserStorage.getItem(a),u=[i,c,l,d],p=[fe.ID_TOKEN,fe.CLIENT_INFO,fe.ERROR,fe.ERROR_DESC];p.forEach(function(m,g){return t.migrateCacheEntry(m,u[g])})},e.prototype.migrateCacheEntry=function(t,n){n&&this.setTemporaryCache(t,n,!0)},e.prototype.validateAndParseJson=function(t){try{var n=JSON.parse(t);return n&&typeof n=="object"?n:null}catch{return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,n){this.browserStorage.setItem(t,n)},e.prototype.getAccount=function(t){var n=this.getItem(t);if(!n)return null;var r=this.validateAndParseJson(n);return!r||!de.isAccountEntity(r)?null:Ie.toObject(new de,r)},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var n=t.generateAccountKey();this.setItem(n,JSON.stringify(t))},e.prototype.getIdTokenCredential=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!Ut.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ie.toObject(new Ut,r))},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var n=t.generateCredentialKey();this.setItem(n,JSON.stringify(t))},e.prototype.getAccessTokenCredential=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!Ft.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ie.toObject(new Ft,r))},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var n=t.generateCredentialKey();this.setItem(n,JSON.stringify(t))},e.prototype.getRefreshTokenCredential=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!Bo.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ie.toObject(new Bo,r))},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var n=t.generateCredentialKey();this.setItem(n,JSON.stringify(t))},e.prototype.getAppMetadata=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!Go.isAppMetadataEntity(t,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ie.toObject(new Go,r))},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var n=t.generateAppMetadataKey();this.setItem(n,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!po.isServerTelemetryEntity(t,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ie.toObject(new po,r))},e.prototype.setServerTelemetry=function(t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(n))},e.prototype.getAuthorityMetadata=function(t){var n=this.internalStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(n);return r&&Ko.isAuthorityMetadataEntity(t,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ie.toObject(new Ko,r)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this,n=this.internalStorage.getKeys();return n.filter(function(r){return t.isAuthorityMetadata(r)})},e.prototype.setWrapperMetadata=function(t,n){this.internalStorage.setItem(mo.WRAPPER_SKU,t),this.internalStorage.setItem(mo.WRAPPER_VER,n)},e.prototype.getWrapperMetadata=function(){var t=this.internalStorage.getItem(mo.WRAPPER_SKU)||"",n=this.internalStorage.getItem(mo.WRAPPER_VER)||"";return[t,n]},e.prototype.setAuthorityMetadata=function(t,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(n))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(fe.ACTIVE_ACCOUNT),n=this.browserStorage.getItem(t);return n&&this.getAccountInfoByFilter({localAccountId:n})[0]||null},e.prototype.setActiveAccount=function(t){var n=this.generateCacheKey(fe.ACTIVE_ACCOUNT);t?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(n,t.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n))},e.prototype.getAccountInfoByFilter=function(t){var n=this.getAllAccounts();return n.filter(function(r){return!(t.username&&t.username.toLowerCase()!==r.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==r.homeAccountId||t.localAccountId&&t.localAccountId!==r.localAccountId||t.tenantId&&t.tenantId!==r.tenantId||t.environment&&t.environment!==r.environment)})},e.prototype.getThrottlingCache=function(t){var n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!_r.isThrottlingEntity(t,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ie.toObject(new _r,r))},e.prototype.setThrottlingCache=function(t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(n))},e.prototype.getTemporaryCache=function(t,n){var r=n?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var s=this.getItemCookie(r);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),s}var a=this.temporaryCacheStorage.getItem(r);if(!a){if(this.cacheConfig.cacheLocation===xe.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),a},e.prototype.setTemporaryCache=function(t,n,r){var s=r?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(s,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(s,n))},e.prototype.removeItem=function(t){return this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t)),!0},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return mr(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return b(this,void 0,void 0,function(){var t=this;return v(this,function(n){switch(n.label){case 0:return[4,this.removeAllAccounts()];case 1:return n.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(r){(t.browserStorage.containsKey(r)||t.temporaryCacheStorage.containsKey(r))&&(r.indexOf(_.CACHE_PREFIX)!==-1||r.indexOf(t.clientId)!==-1)&&t.removeItem(r)}),this.internalStorage.clear(),[2]}})})},e.prototype.setItemCookie=function(t,n,r){var s=encodeURIComponent(t)+"="+encodeURIComponent(n)+";path=/;";if(r){var a=this.getCookieExpirationTime(r);s+="expires="+a+";"}this.cacheConfig.secureCookies&&(s+="Secure;"),document.cookie=s},e.prototype.getItemCookie=function(t){for(var n=encodeURIComponent(t)+"=",r=document.cookie.split(";"),s=0;s<r.length;s++){for(var a=r[s];a.charAt(0)===" ";)a=a.substring(1);if(a.indexOf(n)===0)return decodeURIComponent(a.substring(n.length,a.length))}return""},e.prototype.clearMsalCookies=function(){var t=this,n=_.CACHE_PREFIX+"."+this.clientId,r=document.cookie.split(";");r.forEach(function(s){for(;s.charAt(0)===" ";)s=s.substring(1);if(s.indexOf(n)===0){var a=s.split("=")[0];t.clearItemCookie(a)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,"",-1)},e.prototype.getCookieExpirationTime=function(t){var n=new Date,r=new Date(n.getTime()+t*this.COOKIE_LIFE_MULTIPLIER);return r.toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){var n=this.validateAndParseJson(t);return n?JSON.stringify(t):x.startsWith(t,_.CACHE_PREFIX)||x.startsWith(t,fe.ADAL_ID_TOKEN)?t:_.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var n=rt.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(X.AUTHORITY+"."+n)},e.prototype.generateNonceKey=function(t){var n=rt.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(X.NONCE_IDTOKEN+"."+n)},e.prototype.generateStateKey=function(t){var n=rt.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(X.REQUEST_STATE+"."+n)},e.prototype.getCachedAuthority=function(t){var n=this.generateStateKey(t),r=this.getTemporaryCache(n);if(!r)return null;var s=this.generateAuthorityKey(r);return this.getTemporaryCache(s)},e.prototype.updateCacheEntries=function(t,n,r,s,a){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(t);this.setTemporaryCache(i,t,!1);var c=this.generateNonceKey(t);this.setTemporaryCache(c,n,!1);var l=this.generateAuthorityKey(t);if(this.setTemporaryCache(l,r,!1),a){var d={credential:a.homeAccountId,type:be.HOME_ACCOUNT_ID};this.setTemporaryCache(X.CCS_CREDENTIAL,JSON.stringify(d),!0)}else if(!x.isEmpty(s)){var d={credential:s,type:be.UPN};this.setTemporaryCache(X.CCS_CREDENTIAL,JSON.stringify(d),!0)}},e.prototype.resetRequestCache=function(t){var n=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),x.isEmpty(t)||this.getKeys().forEach(function(r){r.indexOf(t)!==-1&&n.removeItem(r)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(X.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(X.ORIGIN_URI)),this.removeItem(this.generateCacheKey(X.URL_HASH)),this.removeItem(this.generateCacheKey(X.CORRELATION_ID)),this.removeItem(this.generateCacheKey(X.CCS_CREDENTIAL)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var n=this.generateStateKey(t),r=this.temporaryCacheStorage.getItem(n);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var n=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(r){if(r.indexOf(X.REQUEST_STATE)!==-1){var s=n.temporaryCacheStorage.getItem(r);if(!!s){var a=yr.extractBrowserRequestState(n.cryptoImpl,s);a&&a.interactionType===t&&(n.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+s),n.resetRequestCache(s))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,n){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=n.base64Encode(JSON.stringify(t));this.setTemporaryCache(X.REQUEST_PARAMS,r,!0)},e.prototype.getCachedRequest=function(t,n){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(X.REQUEST_PARAMS,!0);if(!r)throw T.createNoTokenRequestCacheError();var s=this.validateAndParseJson(n.base64Decode(r));if(!s)throw T.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(X.REQUEST_PARAMS)),x.isEmpty(s.authority)){var a=this.generateAuthorityKey(t),i=this.getTemporaryCache(a);if(!i)throw T.createNoCachedAuthorityError();s.authority=i}return s},e.prototype.isInteractionInProgress=function(t){var n=this.getInteractionInProgress();return t?n===this.clientId:!!n},e.prototype.getInteractionInProgress=function(){var t=_.CACHE_PREFIX+"."+X.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},e.prototype.setInteractionInProgress=function(t){var n=_.CACHE_PREFIX+"."+X.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw T.createInteractionInProgressError();this.setTemporaryCache(n,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(n)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(fe.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(fe.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var n=this.getTemporaryCache(fe.ID_TOKEN,!0);n&&(this.removeItem(this.generateCacheKey(fe.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=n||t;if(r){var s=new ye(r,this.cryptoImpl);if(s.claims&&s.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),s.claims.preferred_username;if(s.claims&&s.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),s.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,n){var r=n.generateCredentialKey();if(t!==r){var s=this.getItem(t);if(s)return this.removeItem(t),this.setItem(r,s),this.logger.verbose("Updated an outdated "+n.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+n.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e}(Ie),su=function(o,e){var t={cacheLocation:xe.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new Ys(o,t,Nt,e)};var au=function(){function o(){}return o.prototype.sendGetRequestAsync=function(e,t){return b(this,void 0,void 0,function(){var n,r,s;return v(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,fetch(e,{method:Ve.GET,headers:this.getFetchHeaders(t)})];case 1:return n=a.sent(),[3,3];case 2:throw r=a.sent(),window.navigator.onLine?T.createGetRequestFailedError(r,e):T.createNoNetworkConnectivityError();case 3:return a.trys.push([3,5,,6]),s={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 4:return[2,(s.body=a.sent(),s.status=n.status,s)];case 5:throw a.sent(),T.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},o.prototype.sendPostRequestAsync=function(e,t){return b(this,void 0,void 0,function(){var n,r,s,a;return v(this,function(i){switch(i.label){case 0:n=t&&t.body||"",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e,{method:Ve.POST,headers:this.getFetchHeaders(t),body:n})];case 2:return r=i.sent(),[3,4];case 3:throw s=i.sent(),window.navigator.onLine?T.createPostRequestFailedError(s,e):T.createNoNetworkConnectivityError();case 4:return i.trys.push([4,6,,7]),a={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 5:return[2,(a.body=i.sent(),a.status=r.status,a)];case 6:throw i.sent(),T.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},o.prototype.getFetchHeaders=function(e){var t=new Headers;if(!(e&&e.headers))return t;var n=e.headers;return Object.keys(n).forEach(function(r){t.append(r,n[r])}),t},o.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(n,r){t[r]=n}),t},o}();var iu=function(){function o(){}return o.prototype.sendGetRequestAsync=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,this.sendRequestAsync(e,Ve.GET,t)]})})},o.prototype.sendPostRequestAsync=function(e,t){return b(this,void 0,void 0,function(){return v(this,function(n){return[2,this.sendRequestAsync(e,Ve.POST,t)]})})},o.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(s,a){var i=new XMLHttpRequest;if(i.open(t,e,!0),r.setXhrHeaders(i,n),i.onload=function(){(i.status<200||i.status>=300)&&(t===Ve.POST?a(T.createPostRequestFailedError("Failed with status "+i.status,e)):a(T.createGetRequestFailedError("Failed with status "+i.status,e)));try{var c=JSON.parse(i.responseText),l={headers:r.getHeaderDict(i),body:c,status:i.status};s(l)}catch{a(T.createFailedToParseNetworkResponseError(e))}},i.onerror=function(){window.navigator.onLine?t===Ve.POST?a(T.createPostRequestFailedError("Failed with status "+i.status,e)):a(T.createGetRequestFailedError("Failed with status "+i.status,e)):a(T.createNoNetworkConnectivityError())},t===Ve.POST&&n&&n.body)i.send(n.body);else if(t===Ve.GET)i.send();else throw T.createHttpMethodNotImplementedError(t)})},o.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var n=t.headers;Object.keys(n).forEach(function(r){e.setRequestHeader(r,n[r])})}},o.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders(),n=t.trim().split(/[\r\n]+/),r={};return n.forEach(function(s){var a=s.split(": "),i=a.shift(),c=a.join(": ");i&&c&&(r[i]=c)}),r},o}();var ne=function(){function o(){}return o.clearHash=function(e){e.location.hash=_.EMPTY_STRING,typeof e.history.replaceState=="function"&&e.history.replaceState(null,_.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},o.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},o.isInIframe=function(){return window.parent!==window},o.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(ve.POPUP_NAME_PREFIX+".")===0},o.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},o.getHomepage=function(){var e=new K(window.location.href),t=e.getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},o.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new au:new iu},o.blockReloadInHiddenIframes=function(){var e=K.hashContainsKnownProperties(window.location.hash);if(e&&o.isInIframe())throw T.createBlockReloadInHiddenIframeError()},o.blockRedirectInIframe=function(e,t){var n=o.isInIframe();if(e===R.Redirect&&n&&!t)throw T.createRedirectInIframeError(n)},o.blockAcquireTokenInPopups=function(){if(o.isInPopup())throw T.createBlockAcquireTokenInPopupsError()},o.blockNonBrowserEnvironment=function(e){if(!e)throw T.createNonBrowserEnvironmentError()},o.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),r=e.indexOf("Edge/"),s=t>0||n>0,a=r>0;return s||a},o}();var cu=function(){function o(){}return o.prototype.navigateInternal=function(e,t){return o.defaultNavigateWindow(e,t)},o.prototype.navigateExternal=function(e,t){return o.defaultNavigateWindow(e,t)},o.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(n){setTimeout(function(){n(!0)},t.timeout)})},o}();var jg=6e4,Tr=6e3,Qg=3e4;function lu(o,e){var t=o.auth,n=o.cache,r=o.system,s={clientId:"",authority:""+_.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Ht.AAD,azureCloudOptions:{azureCloudInstance:dt.None,tenant:""}},a={cacheLocation:xe.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},i={loggerCallback:function(){},logLevel:se.Info,piiLoggingEnabled:!1},c=Q(Q({},hr),{loggerOptions:i,networkClient:e?ne.getBrowserNetworkClient():Bs,navigationClient:new cu,loadFrameTimeout:0,windowHashTimeout:r&&r.loadFrameTimeout||jg,iframeHashTimeout:r&&r.loadFrameTimeout||Tr,navigateFrameWait:e&&ne.detectIEOrEdge()?500:0,redirectNavigationTimeout:Qg,asyncPopups:!1,allowRedirectInIframe:!1}),l={auth:Q(Q({},s),t),cache:Q(Q({},a),n),system:Q(Q({},c),r)};return l}var uu="@azure/msal-browser",Wo="2.22.1";var F;(function(o){o.ACCOUNT_ADDED="msal:accountAdded",o.ACCOUNT_REMOVED="msal:accountRemoved",o.LOGIN_START="msal:loginStart",o.LOGIN_SUCCESS="msal:loginSuccess",o.LOGIN_FAILURE="msal:loginFailure",o.ACQUIRE_TOKEN_START="msal:acquireTokenStart",o.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",o.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",o.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",o.SSO_SILENT_START="msal:ssoSilentStart",o.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",o.SSO_SILENT_FAILURE="msal:ssoSilentFailure",o.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",o.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",o.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",o.HANDLE_REDIRECT_START="msal:handleRedirectStart",o.HANDLE_REDIRECT_END="msal:handleRedirectEnd",o.POPUP_OPENED="msal:popupOpened",o.LOGOUT_START="msal:logoutStart",o.LOGOUT_SUCCESS="msal:logoutSuccess",o.LOGOUT_FAILURE="msal:logoutFailure",o.LOGOUT_END="msal:logoutEnd"})(F||(F={}));var du=function(){function o(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return o.prototype.addEventCallback=function(e){if(typeof window<"u"){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},o.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},o.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},o.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},o.prototype.emitEvent=function(e,t,n,r){var s=this;if(typeof window<"u"){var a={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(i,c){s.logger.verbose("Emitting event to callback "+c+": "+e),i.apply(null,[a])})}},o.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var n=JSON.parse(t);if(typeof n!="object"||!de.isAccountEntity(n))return;var r=Ie.toObject(new de,n),s=r.getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(F.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(F.ACCOUNT_REMOVED,void 0,s))}catch{return}},o}();var pu=function(){function o(e,t,n,r,s,a){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=s,this.correlationId=a||this.browserCrypto.createNewGuid(),this.logger=r.clone(ve.MSAL_SKU,Wo,this.correlationId)}return o.prototype.clearCacheOnLogout=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:if(!e)return[3,5];de.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(de.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),this.logger.verbose("No account provided in logout request, clearing all cache items."),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},o.prototype.initializeBaseRequest=function(e){return b(this,void 0,void 0,function(){var t,n,r,s;return v(this,function(a){switch(a.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,n=mr(e&&e.scopes||[]),r=Q(Q({},e),{correlationId:this.correlationId,authority:t,scopes:n}),!r.authenticationScheme)r.authenticationScheme=ee.BEARER,this.logger.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(r.authenticationScheme===ee.SSH){if(!e.sshJwk)throw Y.createMissingSshJwkError();if(!e.sshKid)throw Y.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+r.authenticationScheme+'" as configured in Auth request')}return e.claims&&!x.isEmpty(e.claims)?(s=r,[4,this.browserCrypto.hashString(e.claims)]):[3,2];case 1:s.requestedClaimsHash=a.sent(),a.label=2;case 2:return[2,r]}})})},o.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||ne.getCurrentUri();return K.getAbsoluteUrl(t,ne.getCurrentUri())},o.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new $s(n,this.browserStorage)},o}();var Ke=function(o){oe(e,o);function e(t,n,r,s,a,i,c){var l=o.call(this,t,n,r,s,a,c)||this;return l.navigationClient=i,l}return e.prototype.initializeAuthorizationCodeRequest=function(t){return b(this,void 0,void 0,function(){var n,r;return v(this,function(s){switch(s.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return n=s.sent(),r=Q(Q({},t),{redirectUri:t.redirectUri,code:"",codeVerifier:n.verifier}),t.codeChallenge=n.challenge,t.codeChallengeMethod=_.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);var n=Q({correlationId:this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var r=this.getLogoutHintFromIdTokenClaims(t.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!t||t.postLogoutRedirectUri!==null?t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=K.getAbsoluteUrl(t.postLogoutRedirectUri,ne.getCurrentUri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=K.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ne.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=K.getAbsoluteUrl(ne.getCurrentUri(),ne.getCurrentUri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var n=t.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,n,r){return b(this,void 0,void 0,function(){var s;return v(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(t,n,r)];case 1:return s=a.sent(),[2,new kn(s)]}})})},e.prototype.getClientConfiguration=function(t,n,r){return b(this,void 0,void 0,function(){var s;return v(this,function(a){switch(a.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(n,r)];case 1:return s=a.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:ve.MSAL_SKU,version:Wo,cpu:"",os:""}}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,n,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var s=K.getDeserializedHash(t);if(!s.state)throw T.createHashDoesNotContainStateError();var a=yr.extractBrowserRequestState(this.browserCrypto,s.state);if(!a)throw T.createUnableToParseStateError();if(a.interactionType!==n)throw T.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),s.state},e.prototype.getDiscoveredAuthority=function(t,n){return b(this,void 0,void 0,function(){var r,s,a;return v(this,function(i){switch(i.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},s=t||this.config.auth.authority,a=qt.generateAuthority(s,n||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority"),[4,In.createDiscoveredInstance(a,this.config.system.networkClient,this.browserStorage,r)];case 1:return[2,i.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,n){return b(this,void 0,void 0,function(){var r,s,a,i,c,l,d;return v(this,function(u){switch(u.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called"),r=this.getRedirectUri(t.redirectUri),s={interactionType:n},a=rt.setRequestState(this.browserCrypto,t&&t.state||_.EMPTY_STRING,s),c=[{}],[4,this.initializeBaseRequest(t)];case 1:return i=Q.apply(void 0,[Q.apply(void 0,c.concat([u.sent()])),{redirectUri:r,state:a,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:ao.FRAGMENT}]),l=t.account||this.browserStorage.getActiveAccount(),l&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+l),i.account=l),x.isEmpty(i.loginHint)&&!l&&(d=this.browserStorage.getLegacyLoginHint(),d&&(i.loginHint=d)),[2,i]}})})},e}(pu);var Bt=function(){function o(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return o.prototype.openPopup=function(e,t){try{var n=void 0;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+e),n=o.openSizedPopup(e,t.popupName,t.popupWindowAttributes,this.logger)),!n)throw T.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),T.createPopupWindowError(r.toString())}},o.openSizedPopup=function(e,t,n,r){var s,a,i,c,l=window.screenLeft?window.screenLeft:window.screenX,d=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,m=(s=n.popupSize)===null||s===void 0?void 0:s.width,g=(a=n.popupSize)===null||a===void 0?void 0:a.height,y=(i=n.popupPosition)===null||i===void 0?void 0:i.top,E=(c=n.popupPosition)===null||c===void 0?void 0:c.left;return(!m||m<0||m>u)&&(r.verbose("Default popup window width used. Window width not configured or invalid."),m=ve.POPUP_WIDTH),(!g||g<0||g>p)&&(r.verbose("Default popup window height used. Window height not configured or invalid."),g=ve.POPUP_HEIGHT),(!y||y<0||y>p)&&(r.verbose("Default popup window top position used. Window top not configured or invalid."),y=Math.max(0,p/2-ve.POPUP_HEIGHT/2+d)),(!E||E<0||E>u)&&(r.verbose("Default popup window left position used. Window left not configured or invalid."),E=Math.max(0,u/2-ve.POPUP_WIDTH/2+l)),window.open(e,t,"width="+m+", height="+g+", top="+y+", left="+E+", scrollbars=yes")},o.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(R.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},o.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},o.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise(function(n,r){var s=setInterval(function(){if(e.closed){t.cleanPopup(),clearInterval(s),r(T.createUserCancelledError());return}var a=_.EMPTY_STRING;try{a=e.location.href}catch{}x.isEmpty(a)||a==="about:blank"||(clearInterval(s),n())},ve.POLL_INTERVAL_MS)})},o.generatePopupName=function(e,t,n,r){return ve.POPUP_NAME_PREFIX+"."+e+"."+t.join("-")+"."+n+"."+r},o.generateLogoutPopupName=function(e,t){var n=t.account&&t.account.homeAccountId;return ve.POPUP_NAME_PREFIX+"."+e+"."+n+"."+t.correlationId},o}();var Yo=function(){function o(e,t,n,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.browserRequestLogger=r}return o.prototype.handleCodeResponseFromHash=function(e,t,n,r){return b(this,void 0,void 0,function(){var s,a,i;return v(this,function(c){if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),x.isEmpty(e))throw T.createEmptyHashError(e);if(s=this.browserStorage.generateStateKey(t),a=this.browserStorage.getTemporaryCache(s),!a)throw C.createStateNotFoundError("Cached State");return i=this.authModule.handleFragmentResponse(e,a),[2,this.handleCodeResponseFromServer(i,t,n,r)]})})},o.prototype.handleCodeResponseFromServer=function(e,t,n,r,s){return s===void 0&&(s=!0),b(this,void 0,void 0,function(){var a,i,c,l,d,u;return v(this,function(p){switch(p.label){case 0:if(this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called"),a=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(a),!i)throw C.createStateNotFoundError("Cached State");return c=this.browserStorage.generateNonceKey(i),l=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,n,r)]:[3,2];case 1:p.sent(),p.label=2;case 2:return s&&(e.nonce=l||void 0),e.state=i,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(d=this.checkCcsCredentials(),d&&(this.authCodeRequest.ccsCredential=d)),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return u=p.sent(),this.browserStorage.cleanRequestByState(t),[2,u]}})})},o.prototype.updateTokenEndpointAuthority=function(e,t,n){return b(this,void 0,void 0,function(){var r,s;return v(this,function(a){switch(a.label){case 0:return r="https://"+e+"/"+t.tenant+"/",[4,In.createDiscoveredInstance(r,n,this.browserStorage,t.options)];case 1:return s=a.sent(),this.authModule.updateAuthority(s),[2]}})})},o.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(X.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},o}();var mu=function(o){oe(e,o);function e(t,n,r,s){var a=o.call(this,t,n,r,s)||this;return a.popupUtils=new Bt(n,s),a}return e.prototype.initiateAuthRequest=function(t,n){if(x.isEmpty(t))throw this.browserRequestLogger.error("Navigate url is empty"),T.createEmptyNavigationUriError();return this.browserRequestLogger.infoPii("Navigate to: "+t),this.popupUtils.openPopup(t,n)},e.prototype.monitorPopupForHash=function(t){var n=this;return this.popupUtils.monitorPopupForSameOrigin(t).then(function(){var r=t.location.hash;if(ne.clearHash(t),n.popupUtils.cleanPopup(t),!r)throw T.createEmptyHashError(t.location.href);if(K.hashContainsKnownProperties(r))return r;throw T.createHashDoesNotContainKnownPropertiesError()})},e}(Yo);var js=function(o){oe(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){try{var n=Bt.generatePopupName(this.config.auth.clientId,t.scopes||xt,t.authority||this.config.auth.authority,this.correlationId),r=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,n,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var s=Bt.openSizedPopup("about:blank",n,r,this.logger);return this.acquireTokenPopupAsync(t,n,r,s)}catch(a){return Promise.reject(a)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var n=this.initializeLogoutRequest(t),r=Bt.generateLogoutPopupName(this.config.auth.clientId,n),s=t&&t.authority,a=t&&t.mainWindowRedirectUri,i=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,i,s,void 0,a);this.logger.verbose("asyncPopup set to false, opening popup");var c=Bt.openSizedPopup("about:blank",r,i,this.logger);return this.logoutPopupAsync(n,r,i,s,c,a)}catch(l){return Promise.reject(l)}},e.prototype.acquireTokenPopupAsync=function(t,n,r,s){return b(this,void 0,void 0,function(){var a,i,c,l,d,u,p,m,g,y,E,I;return v(this,function(N){switch(N.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),a=this.initializeServerTelemetryManager(pe.acquireTokenPopup),[4,this.initializeAuthorizationRequest(t,R.Popup)];case 1:i=N.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||"",i.account||null),N.label=2;case 2:return N.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return c=N.sent(),[4,this.createAuthCodeClient(a,i.authority,i.azureCloudOptions)];case 4:return l=N.sent(),this.logger.verbose("Auth code client created"),[4,l.getAuthCodeUrl(i)];case 5:return d=N.sent(),u=new mu(l,this.browserStorage,c,this.logger),p={popup:s,popupName:n,popupWindowAttributes:r},m=u.initiateAuthRequest(d,p),this.eventHandler.emitEvent(F.POPUP_OPENED,R.Popup,{popupWindow:m},null),[4,u.monitorPopupForHash(m)];case 6:return g=N.sent(),y=this.validateAndExtractStateFromHash(g,R.Popup,i.correlationId),Dt.removeThrottle(this.browserStorage,this.config.auth.clientId,c),[4,u.handleCodeResponseFromHash(g,y,l.authority,this.networkClient)];case 7:return E=N.sent(),[2,E];case 8:throw I=N.sent(),s&&s.close(),I instanceof L&&I.setCorrelationId(this.correlationId),a.cacheFailedRequest(I),this.browserStorage.cleanRequestByState(i.state),I;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,n,r,s,a,i){return b(this,void 0,void 0,function(){var c,l,d,u,p,m,g,y,E;return v(this,function(I){switch(I.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(F.LOGOUT_START,R.Popup,t),c=this.initializeServerTelemetryManager(pe.logoutPopup),I.label=1;case 1:return I.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(t.account)];case 2:return I.sent(),[4,this.createAuthCodeClient(c,s)];case 3:l=I.sent(),this.logger.verbose("Auth code client created"),d=l.getLogoutUri(t),this.eventHandler.emitEvent(F.LOGOUT_SUCCESS,R.Popup,t),u=new Bt(this.browserStorage,this.logger),p=u.openPopup(d,{popupName:n,popupWindowAttributes:r,popup:a}),this.eventHandler.emitEvent(F.POPUP_OPENED,R.Popup,{popupWindow:p},null),I.label=4;case 4:return I.trys.push([4,6,,7]),[4,u.monitorPopupForSameOrigin(p)];case 5:return I.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return m=I.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+m),[3,7];case 7:return u.cleanPopup(p),i?(g={apiId:pe.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},y=K.getAbsoluteUrl(i,ne.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+y),this.navigationClient.navigateInternal(y,g)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw E=I.sent(),a&&a.close(),E instanceof L&&E.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(F.LOGOUT_FAILURE,R.Popup,null,E),this.eventHandler.emitEvent(F.LOGOUT_END,R.Popup),c.cacheFailedRequest(E),E;case 9:return this.eventHandler.emitEvent(F.LOGOUT_END,R.Popup),[2]}})})},e}(Ke);var Qs=function(o){oe(e,o);function e(t,n,r,s,a){var i=o.call(this,t,n,r,s)||this;return i.browserCrypto=a,i}return e.prototype.initiateAuthRequest=function(t,n){return b(this,void 0,void 0,function(){var r,s;return v(this,function(a){switch(a.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),x.isEmpty(t)?[3,7]:(n.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(X.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(X.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),r={apiId:pe.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1},typeof n.onRedirectNavigate!="function"?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),s=n.onRedirectNavigate(t),s===!1?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,n.navigationClient.navigateExternal(t,r)])));case 1:return a.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,n.navigationClient.navigateExternal(t,r)];case 5:return a.sent(),[2];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),T.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,n,r,s,a){return b(this,void 0,void 0,function(){var i,c,l,d,u,p,m;return v(this,function(g){switch(g.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),x.isEmpty(t))throw T.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(n),c=this.browserStorage.getTemporaryCache(i),!c)throw C.createStateNotFoundError("Cached State");return l=this.authModule.handleFragmentResponse(t,c),d=this.browserStorage.generateNonceKey(c),u=this.browserStorage.getTemporaryCache(d),this.authCodeRequest.code=l.code,l.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(l.cloud_instance_host_name,r,s)]:[3,2];case 1:g.sent(),g.label=2;case 2:return l.nonce=u||void 0,l.state=c,l.client_info?this.authCodeRequest.clientInfo=l.client_info:(p=this.checkCcsCredentials(),p&&(this.authCodeRequest.ccsCredential=p)),a&&Dt.removeThrottle(this.browserStorage,a,this.authCodeRequest),[4,this.authModule.acquireToken(this.authCodeRequest,l)];case 3:return m=g.sent(),this.browserStorage.cleanRequestByState(n),[2,m]}})})},e}(Yo);var Sr=function(o){oe(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c,l,d,u,p=this;return v(this,function(m){switch(m.label){case 0:return[4,this.initializeAuthorizationRequest(t,R.Redirect)];case 1:n=m.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null),r=this.initializeServerTelemetryManager(pe.acquireTokenRedirect),s=function(g){g.persisted&&(p.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),p.browserStorage.cleanRequestByState(n.state))},m.label=2;case 2:return m.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(n)];case 3:return a=m.sent(),[4,this.createAuthCodeClient(r,n.authority,n.azureCloudOptions)];case 4:return i=m.sent(),this.logger.verbose("Auth code client created"),c=new Qs(i,this.browserStorage,a,this.logger,this.browserCrypto),[4,i.getAuthCodeUrl(n)];case 5:return l=m.sent(),d=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+d),window.addEventListener("pageshow",s),[4,c.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:d,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,m.sent()];case 7:throw u=m.sent(),u instanceof L&&u.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",s),r.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(n.state),u;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c,l,d,u,p,m;return v(this,function(g){switch(g.label){case 0:n=this.initializeServerTelemetryManager(pe.handleRedirectPromise),g.label=1;case 1:if(g.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(r=this.getRedirectResponseHash(t||window.location.hash),!r)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(R.Redirect),[2,null];s=void 0;try{s=this.validateAndExtractStateFromHash(r,R.Redirect),this.logger.verbose("State extracted from hash")}catch(y){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+y),this.browserStorage.cleanRequestByInteractionType(R.Redirect),[2,null]}return a=this.browserStorage.getTemporaryCache(X.ORIGIN_URI,!0)||"",i=K.removeHashFromUrl(a),c=K.removeHashFromUrl(window.location.href),i===c&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,s,n)]):[3,3];case 2:return l=g.sent(),a.indexOf("#")>-1&&ne.replaceHash(a),[2,l];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,s,n)]);case 4:return!ne.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(X.URL_HASH,r,!0),d={apiId:pe.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0,!a||a==="null"?(p=ne.getHomepage(),this.browserStorage.setTemporaryCache(X.ORIGIN_URI,p,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(p,d)]):[3,6]):[3,9];case 5:return u=g.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+a),[4,this.navigationClient.navigateInternal(a,d)];case 7:u=g.sent(),g.label=8;case 8:if(!u)return[2,this.handleHash(r,s,n)];g.label=9;case 9:return[2,null];case 10:throw m=g.sent(),m instanceof L&&m.setCorrelationId(this.correlationId),n.cacheFailedRequest(m),this.browserStorage.cleanRequestByInteractionType(R.Redirect),m;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){this.logger.verbose("getRedirectResponseHash called");var n=K.hashContainsKnownProperties(t);if(n)return ne.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var r=this.browserStorage.getTemporaryCache(X.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(X.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),r},e.prototype.handleHash=function(t,n,r){return b(this,void 0,void 0,function(){var s,a,i,c;return v(this,function(l){switch(l.label){case 0:if(s=this.browserStorage.getCachedRequest(n,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),a=this.browserStorage.getCachedAuthority(n),!a)throw T.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,a)];case 1:return i=l.sent(),this.logger.verbose("Auth code client created"),c=new Qs(i,this.browserStorage,s,this.logger,this.browserCrypto),[4,c.handleCodeResponseFromHash(t,n,i.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,l.sent()]}})})},e.prototype.logout=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c,l;return v(this,function(d){switch(d.label){case 0:this.logger.verbose("logoutRedirect called"),n=this.initializeLogoutRequest(t),r=this.initializeServerTelemetryManager(pe.logout),d.label=1;case 1:return d.trys.push([1,10,,11]),this.eventHandler.emitEvent(F.LOGOUT_START,R.Redirect,t),[4,this.clearCacheOnLogout(n.account)];case 2:return d.sent(),s={apiId:pe.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,t&&t.authority)];case 3:return a=d.sent(),this.logger.verbose("Auth code client created"),i=a.getLogoutUri(n),this.eventHandler.emitEvent(F.LOGOUT_SUCCESS,R.Redirect,n),t&&typeof t.onRedirectNavigate=="function"?(c=t.onRedirectNavigate(i),c===!1?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,s)])):[3,7];case 4:return d.sent(),[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),d.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(i,s)];case 8:return d.sent(),[2];case 9:return[3,11];case 10:throw l=d.sent(),l instanceof L&&l.setCorrelationId(this.correlationId),r.cacheFailedRequest(l),this.eventHandler.emitEvent(F.LOGOUT_FAILURE,R.Redirect,null,l),this.eventHandler.emitEvent(F.LOGOUT_END,R.Redirect),l;case 11:return this.eventHandler.emitEvent(F.LOGOUT_END,R.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var n=t||window.location.href;return K.getAbsoluteUrl(n,ne.getCurrentUri())},e}(Ke);var wr=function(o){oe(e,o);function e(t,n,r,s,a){var i=o.call(this,t,n,r,s)||this;return i.navigateFrameWait=a,i}return e.prototype.initiateAuthRequest=function(t){return b(this,void 0,void 0,function(){var n;return v(this,function(r){switch(r.label){case 0:if(x.isEmpty(t))throw this.browserRequestLogger.info("Navigate url is empty"),T.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=this.loadFrameSync(t),r.label=3;case 3:return[2,n]}})})},e.prototype.monitorIframeForHash=function(t,n){var r=this;return new Promise(function(s,a){n<Tr&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+n+"ms) than the default ("+Tr+"ms). This may result in timeouts.");var i=window.performance.now(),c=i+n,l=setInterval(function(){if(window.performance.now()>c){r.removeHiddenIframe(t),clearInterval(l),a(T.createMonitorIframeTimeoutError());return}var d=_.EMPTY_STRING,u=t.contentWindow;try{d=u?u.location.href:_.EMPTY_STRING}catch{}if(!x.isEmpty(d)){var p=u?u.location.hash:_.EMPTY_STRING;if(K.hashContainsKnownProperties(p)){r.removeHiddenIframe(t),clearInterval(l),s(p);return}}},ve.POLL_INTERVAL_MS)})},e.prototype.loadFrame=function(t){var n=this;return new Promise(function(r,s){var a=n.createHiddenIframe();setTimeout(function(){if(!a){s("Unable to load iframe");return}a.src=t,r(a)},n.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var n=this.createHiddenIframe();return n.src=t,n},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(Yo);var Js=function(o){oe(e,o);function e(t,n,r,s,a,i,c,l){var d=o.call(this,t,n,r,s,a,i,l)||this;return d.apiId=c,d}return e.prototype.acquireToken=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c;return v(this,function(l){switch(l.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),x.isEmpty(t.loginHint)&&x.isEmpty(t.sid)&&(!t.account||x.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==tt.NONE)throw T.createSilentPromptValueError(t.prompt);return[4,this.initializeAuthorizationRequest(Q(Q({},t),{prompt:tt.NONE}),R.Silent)];case 1:n=l.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null),r=this.initializeServerTelemetryManager(this.apiId),l.label=2;case 2:return l.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(n)];case 3:return s=l.sent(),[4,this.createAuthCodeClient(r,n.authority,n.azureCloudOptions)];case 4:return a=l.sent(),this.logger.verbose("Auth code client created"),[4,a.getAuthCodeUrl(n)];case 5:return i=l.sent(),[4,this.silentTokenHelper(i,s,a,this.logger)];case 6:return[2,l.sent()];case 7:throw c=l.sent(),c instanceof L&&c.setCorrelationId(this.correlationId),r.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(n.state),c;case 8:return[2]}})})},e.prototype.logout=function(){return Promise.reject(T.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,n,r,s){return b(this,void 0,void 0,function(){var a,i,c,l;return v(this,function(d){switch(d.label){case 0:return a=new wr(r,this.browserStorage,n,s,this.config.system.navigateFrameWait),[4,a.initiateAuthRequest(t)];case 1:return i=d.sent(),[4,a.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return c=d.sent(),l=this.validateAndExtractStateFromHash(c,R.Silent,n.correlationId),[2,a.handleCodeResponseFromHash(c,l,r.authority,this.networkClient)]}})})},e}(Ke);var gu=function(o){oe(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i=this;return v(this,function(c){switch(c.label){case 0:return r=[Q({},t)],[4,this.initializeBaseRequest(t)];case 1:return n=Q.apply(void 0,r.concat([c.sent()])),s=this.initializeServerTelemetryManager(pe.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,n.authority,n.azureCloudOptions)];case 2:return a=c.sent(),this.logger.verbose("Refresh token client created"),[2,a.acquireTokenByRefreshToken(n).catch(function(l){throw l instanceof L&&l.setCorrelationId(i.correlationId),s.cacheFailedRequest(l),l})]}})})},e.prototype.logout=function(){return Promise.reject(T.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,n,r){return b(this,void 0,void 0,function(){var s;return v(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(t,n,r)];case 1:return s=a.sent(),[2,new An(s)]}})})},e}(Ke);var fu=function(){function o(e,t,n,r){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}return o.prototype.loadExternalTokens=function(e,t,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw T.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,n),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,n);else if(e.authority){var r=qt.generateAuthority(e.authority,e.azureCloudOptions),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},a=new qt(r,this.config.system.networkClient,this.storage,s);if(n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,n.clientInfo,a.hostnameAndPort,a.tenant,n),this.loadAccessToken(e,t,n.clientInfo,a.hostnameAndPort,a.tenant,n);else if(t.client_info)this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,a.hostnameAndPort,a.tenant,n),this.loadAccessToken(e,t,t.client_info,a.hostnameAndPort,a.tenant,n);else throw T.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}else throw T.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.")},o.prototype.loadIdToken=function(e,t,n,r,s){var a=Ut.createIdTokenEntity(t,n,e,this.config.auth.clientId,r),i=new ye(e,this.cryptoObj),c=s.clientInfo?de.createAccount(s.clientInfo,t,i,void 0,void 0,void 0,void 0,n):de.createGenericAccount(t,i,void 0,void 0,void 0,void 0,n);if(this.isBrowserEnvironment)this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(c),this.storage.setIdTokenCredential(a);else throw T.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},o.prototype.loadAccessToken=function(e,t,n,r,s,a){if(!t.access_token){this.logger.verbose("TokenCache - No access token provided for caching");return}if(!t.expires_in)throw T.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!a.extendedExpiresOn)throw T.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var i=new Ce(e.scopes).printScopes(),c=t.expires_in,l=a.extendedExpiresOn,d=Ft.createAccessTokenEntity(n,r,t.access_token,this.config.auth.clientId,s,i,c,l,this.cryptoObj);if(this.isBrowserEnvironment)this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(d);else throw T.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},o}();var hu=function(o){oe(e,o);function e(t){var n=o.call(this,t)||this;return n.includeRedirectUri=!1,n}return e}(kn);var _u=function(o){oe(e,o);function e(t,n,r,s,a,i,c,l){var d=o.call(this,t,n,r,s,a,i,l)||this;return d.apiId=c,d}return e.prototype.acquireToken=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c,l;return v(this,function(d){switch(d.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw T.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(t,R.Silent)];case 1:n=d.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null),r=this.initializeServerTelemetryManager(this.apiId),d.label=2;case 2:return d.trys.push([2,4,,5]),s=Q(Q({},n),{code:t.code}),[4,this.getClientConfiguration(r,n.authority)];case 3:return a=d.sent(),i=new hu(a),this.logger.verbose("Auth code client created"),c=new wr(i,this.browserStorage,s,this.logger,this.config.system.navigateFrameWait),[2,c.handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},n.state,i.authority,this.networkClient,!1)];case 4:throw l=d.sent(),l instanceof L&&l.setCorrelationId(this.correlationId),r.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(n.state),l;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(T.createSilentLogoutUnsupportedError())},e}(Ke);var xu=function(){function o(e){this.isBrowserEnvironment=typeof window<"u",this.config=lu(e,this.isBrowserEnvironment),this.logger=new Ho(this.config.system.loggerOptions,uu,Wo),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.browserCrypto=this.isBrowserEnvironment?new ru(this.logger):Nt,this.eventHandler=new du(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Ys(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):su(this.config.auth.clientId,this.logger),this.tokenCache=new fu(this.config,this.browserStorage,this.logger,this.browserCrypto)}return o.prototype.handleRedirectPromise=function(e){return b(this,void 0,void 0,function(){var t,n,r,s,a,i=this;return v(this,function(c){return this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(n=e||_.EMPTY_STRING,r=this.redirectResponse.get(n),typeof r>"u"?(this.eventHandler.emitEvent(F.HANDLE_REDIRECT_START,R.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),s=this.browserStorage.getTemporaryCache(X.CORRELATION_ID,!0)||"",a=new Sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,s),r=a.handleRedirectPromise(e).then(function(l){if(l){var d=t.length<i.getAllAccounts().length;d?(i.eventHandler.emitEvent(F.LOGIN_SUCCESS,R.Redirect,l),i.logger.verbose("handleRedirectResponse returned result, login success")):(i.eventHandler.emitEvent(F.ACQUIRE_TOKEN_SUCCESS,R.Redirect,l),i.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return i.eventHandler.emitEvent(F.HANDLE_REDIRECT_END,R.Redirect),l}).catch(function(l){throw t.length>0?i.eventHandler.emitEvent(F.ACQUIRE_TOKEN_FAILURE,R.Redirect,null,l):i.eventHandler.emitEvent(F.LOGIN_FAILURE,R.Redirect,null,l),i.eventHandler.emitEvent(F.HANDLE_REDIRECT_END,R.Redirect),l}),this.redirectResponse.set(n,r)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,r]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},o.prototype.acquireTokenRedirect=function(e){return b(this,void 0,void 0,function(){var t,n,r=this;return v(this,function(s){return this.logger.verbose("acquireTokenRedirect called"),this.preflightBrowserEnvironmentCheck(R.Redirect),t=this.getAllAccounts().length>0,t?this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_START,R.Redirect,e):this.eventHandler.emitEvent(F.LOGIN_START,R.Redirect,e),n=new Sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId),[2,n.acquireToken(e).catch(function(a){throw t?r.eventHandler.emitEvent(F.ACQUIRE_TOKEN_FAILURE,R.Redirect,null,a):r.eventHandler.emitEvent(F.LOGIN_FAILURE,R.Redirect,null,a),a})]})})},o.prototype.acquireTokenPopup=function(e){var t=this;try{this.logger.verbose("acquireTokenPopup called",e.correlationId),this.preflightBrowserEnvironmentCheck(R.Popup)}catch(s){return Promise.reject(s)}var n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_START,R.Popup,e):this.eventHandler.emitEvent(F.LOGIN_START,R.Popup,e);var r=new js(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId);return r.acquireToken(e).then(function(s){var a=n.length<t.getAllAccounts().length;return a?t.eventHandler.emitEvent(F.LOGIN_SUCCESS,R.Popup,s):t.eventHandler.emitEvent(F.ACQUIRE_TOKEN_SUCCESS,R.Popup,s),s}).catch(function(s){return n.length>0?t.eventHandler.emitEvent(F.ACQUIRE_TOKEN_FAILURE,R.Popup,null,s):t.eventHandler.emitEvent(F.LOGIN_FAILURE,R.Popup,null,s),Promise.reject(s)})},o.prototype.ssoSilent=function(e){return b(this,void 0,void 0,function(){var t,n,r;return v(this,function(s){switch(s.label){case 0:this.preflightBrowserEnvironmentCheck(R.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(F.SSO_SILENT_START,R.Silent,e),s.label=1;case 1:return s.trys.push([1,3,,4]),t=new Js(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pe.ssoSilent,e.correlationId),[4,t.acquireToken(e)];case 2:return n=s.sent(),this.eventHandler.emitEvent(F.SSO_SILENT_SUCCESS,R.Silent,n),[2,n];case 3:throw r=s.sent(),this.eventHandler.emitEvent(F.SSO_SILENT_FAILURE,R.Silent,null,r),r;case 4:return[2]}})})},o.prototype.acquireTokenByCode=function(e){return b(this,void 0,void 0,function(){var t,n=this;return v(this,function(r){this.preflightBrowserEnvironmentCheck(R.Silent),this.logger.trace("acquireTokenByCode called",e.correlationId),this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_BY_CODE_START,R.Silent,e);try{if(!e.code)throw T.createAuthCodeRequiredError();return t=this.hybridAuthCodeResponses.get(e.code),t?this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId):(this.logger.verbose("Initiating new acquireTokenByCode request",e.correlationId),t=this.acquireTokenByCodeAsync(e).then(function(s){return n.eventHandler.emitEvent(F.ACQUIRE_TOKEN_BY_CODE_SUCCESS,R.Silent,s),n.hybridAuthCodeResponses.delete(e.code),s}).catch(function(s){throw n.hybridAuthCodeResponses.delete(e.code),s}),this.hybridAuthCodeResponses.set(e.code,t)),[2,t]}catch(s){throw this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_BY_CODE_FAILURE,R.Silent,null,s),s}return[2]})})},o.prototype.acquireTokenByCodeAsync=function(e){return b(this,void 0,void 0,function(){var t,n;return v(this,function(r){switch(r.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),t=new _u(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pe.acquireTokenByCode,e.correlationId),[4,t.acquireToken(e)];case 1:return n=r.sent(),[2,n]}})})},o.prototype.acquireTokenByRefreshToken=function(e){return b(this,void 0,void 0,function(){var t,n=this;return v(this,function(r){return this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_NETWORK_START,R.Silent,e),ne.blockReloadInHiddenIframes(),t=new gu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId),[2,t.acquireToken(e).catch(function(s){var a=s instanceof nt,i=s instanceof $e,c=s.errorCode===ve.INVALID_GRANT_ERROR;if(a&&c&&!i){n.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId);var l=new Js(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,pe.acquireTokenSilent_authCode,e.correlationId);return l.acquireToken(e)}throw s})]})})},o.prototype.logout=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]})})},o.prototype.logoutRedirect=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){return this.preflightBrowserEnvironmentCheck(R.Redirect),t=new Sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e?.correlationId),[2,t.logout(e)]})})},o.prototype.logoutPopup=function(e){try{this.preflightBrowserEnvironmentCheck(R.Popup);var t=new js(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e?.correlationId);return t.logout(e)}catch(n){return Promise.reject(n)}},o.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},o.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter(function(n){return n.username.toLowerCase()===e.toLowerCase()})[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},o.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter(function(n){return n.homeAccountId===e})[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},o.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter(function(n){return n.localAccountId===e})[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},o.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},o.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},o.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),ne.blockNonBrowserEnvironment(this.isBrowserEnvironment),ne.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),ne.blockReloadInHiddenIframes(),ne.blockAcquireTokenInPopups(),e===R.Redirect&&this.config.cache.cacheLocation===xe.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Pn.createInMemoryRedirectUnavailableError();(e===R.Redirect||e===R.Popup)&&this.preflightInteractiveRequest()},o.prototype.preflightInteractiveRequest=function(){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ne.blockReloadInHiddenIframes(),this.browserStorage.setInteractionInProgress(!0)},o.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},o.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},o.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},o.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},o.prototype.getTokenCache=function(){return this.tokenCache},o.prototype.getLogger=function(){return this.logger},o.prototype.setLogger=function(e){this.logger=e},o.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},o.prototype.setNavigationClient=function(e){this.navigationClient=e},o.prototype.getConfiguration=function(){return this.config},o}();var bu=function(o){oe(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return b(this,void 0,void 0,function(){var n,r,s,a;return v(this,function(i){switch(i.label){case 0:return n=this.initializeServerTelemetryManager(pe.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(n,t.authority,t.azureCloudOptions)];case 1:r=i.sent(),this.logger.verbose("Silent auth client created"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,r.acquireCachedToken(t)];case 3:return s=i.sent(),this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_SUCCESS,R.Silent,s),[2,s];case 4:throw a=i.sent(),a instanceof T&&a.errorCode===A.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),a;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(T.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,n,r){return b(this,void 0,void 0,function(){var s;return v(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(t,n,r)];case 1:return s=a.sent(),[2,new qs(s)]}})})},e.prototype.initializeSilentRequest=function(t,n){return b(this,void 0,void 0,function(){var r;return v(this,function(s){switch(s.label){case 0:return r=[Q({},t)],[4,this.initializeBaseRequest(t)];case 1:return[2,Q.apply(void 0,[Q.apply(void 0,r.concat([s.sent()])),{account:n,forceRefresh:t.forceRefresh||!1}])]}})})},e}(Ke);var Xs=function(o){oe(e,o);function e(t){var n=o.call(this,t)||this;return n.activeSilentTokenRequests=new Map,n}return e.prototype.loginRedirect=function(t){return b(this,void 0,void 0,function(){return v(this,function(n){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(t||Vs)]})})},e.prototype.loginPopup=function(t){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(t||Vs)},e.prototype.acquireTokenSilent=function(t){return b(this,void 0,void 0,function(){var n,r,s,a,i,c=this;return v(this,function(l){if(this.preflightBrowserEnvironmentCheck(R.Silent),this.logger.verbose("acquireTokenSilent called",t.correlationId),n=t.account||this.getActiveAccount(),!n)throw T.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:t.authority||"",scopes:t.scopes,homeAccountIdentifier:n.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},s=JSON.stringify(r),a=this.activeSilentTokenRequests.get(s),typeof a>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t.correlationId),i=this.acquireTokenSilentAsync(t,n).then(function(d){return c.activeSilentTokenRequests.delete(s),d}).catch(function(d){throw c.activeSilentTokenRequests.delete(s),d}),this.activeSilentTokenRequests.set(s,i),[2,i]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t.correlationId),[2,a])})})},e.prototype.acquireTokenSilentAsync=function(t,n){return b(this,void 0,void 0,function(){var r,s,a=this;return v(this,function(i){switch(i.label){case 0:return r=new bu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t.correlationId),[4,r.initializeSilentRequest(t,n)];case 1:return s=i.sent(),this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_START,R.Silent,t),[2,r.acquireToken(s).catch(function(){return b(a,void 0,void 0,function(){var c,l;return v(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.acquireTokenByRefreshToken(s)];case 1:return c=d.sent(),this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_SUCCESS,R.Silent,c),[2,c];case 2:throw l=d.sent(),this.eventHandler.emitEvent(F.ACQUIRE_TOKEN_FAILURE,R.Silent,null,l),l;case 3:return[2]}})})})]}})})},e}(xu);var vu=new WeakMap,We=o=>(...e)=>{let t=o(...e);return vu.set(t,!0),t},fo=o=>typeof o=="function"&&vu.has(o);var Zs=typeof window<"u"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,Cr=(o,e,t=null,n=null)=>{for(;e!==t;){let r=e.nextSibling;o.insertBefore(e,n),e=r}},ho=(o,e,t=null)=>{for(;e!==t;){let n=e.nextSibling;o.removeChild(e),e=n}};var ze={},Er={};var mt=`{{lit-${String(Math.random()).slice(2)}}}`,ea=`<!--${mt}-->`,yu=new RegExp(`${mt}|${ea}`),jo="$lit$",Ar=class{constructor(e,t){this.parts=[],this.element=t;let n=[],r=[],s=document.createTreeWalker(t.content,133,null,!1),a=0,i=-1,c=0,{strings:l,values:{length:d}}=e;for(;c<d;){let u=s.nextNode();if(u===null){s.currentNode=r.pop();continue}if(i++,u.nodeType===1){if(u.hasAttributes()){let p=u.attributes,{length:m}=p,g=0;for(let y=0;y<m;y++)Tu(p[y].name,jo)&&g++;for(;g-- >0;){let y=l[c],E=kr.exec(y)[2],I=E.toLowerCase()+jo,N=u.getAttribute(I);u.removeAttribute(I);let w=N.split(yu);this.parts.push({type:"attribute",index:i,name:E,strings:w}),c+=w.length-1}}u.tagName==="TEMPLATE"&&(r.push(u),s.currentNode=u.content)}else if(u.nodeType===3){let p=u.data;if(p.indexOf(mt)>=0){let m=u.parentNode,g=p.split(yu),y=g.length-1;for(let E=0;E<y;E++){let I,N=g[E];if(N==="")I=De();else{let w=kr.exec(N);w!==null&&Tu(w[2],jo)&&(N=N.slice(0,w.index)+w[1]+w[2].slice(0,-jo.length)+w[3]),I=document.createTextNode(N)}m.insertBefore(I,u),this.parts.push({type:"node",index:++i})}g[y]===""?(m.insertBefore(De(),u),n.push(u)):u.data=g[y],c+=y}}else if(u.nodeType===8)if(u.data===mt){let p=u.parentNode;(u.previousSibling===null||i===a)&&(i++,p.insertBefore(De(),u)),a=i,this.parts.push({type:"node",index:i}),u.nextSibling===null?u.data="":(n.push(u),i--),c++}else{let p=-1;for(;(p=u.data.indexOf(mt,p+1))!==-1;)this.parts.push({type:"node",index:-1}),c++}}for(let u of n)u.parentNode.removeChild(u)}},Tu=(o,e)=>{let t=o.length-e.length;return t>=0&&o.slice(t)===e},ta=o=>o.index!==-1,De=()=>document.createComment(""),kr=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;var Ln=class{constructor(e,t,n){this.__parts=[],this.template=e,this.processor=t,this.options=n}update(e){let t=0;for(let n of this.__parts)n!==void 0&&n.setValue(e[t]),t++;for(let n of this.__parts)n!==void 0&&n.commit()}_clone(){let e=Zs?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],n=this.template.parts,r=document.createTreeWalker(e,133,null,!1),s=0,a=0,i,c=r.nextNode();for(;s<n.length;){if(i=n[s],!ta(i)){this.__parts.push(void 0),s++;continue}for(;a<i.index;)a++,c.nodeName==="TEMPLATE"&&(t.push(c),r.currentNode=c.content),(c=r.nextNode())===null&&(r.currentNode=t.pop(),c=r.nextNode());if(i.type==="node"){let l=this.processor.handleTextExpression(this.options);l.insertAfterNode(c.previousSibling),this.__parts.push(l)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,i.name,i.strings,this.options));s++}return Zs&&(document.adoptNode(e),customElements.upgrade(e)),e}};var Su=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:o=>o}),Jg=` ${mt} `,yt=class{constructor(e,t,n,r){this.strings=e,this.values=t,this.type=n,this.processor=r}getHTML(){let e=this.strings.length-1,t="",n=!1;for(let r=0;r<e;r++){let s=this.strings[r],a=s.lastIndexOf("<!--");n=(a>-1||n)&&s.indexOf("-->",a+1)===-1;let i=kr.exec(s);i===null?t+=s+(n?Jg:ea):t+=s.substr(0,i.index)+i[1]+i[2]+jo+i[3]+mt}return t+=this.strings[e],t}getTemplateElement(){let e=document.createElement("template"),t=this.getHTML();return Su!==void 0&&(t=Su.createHTML(t)),e.innerHTML=t,e}};var $t=o=>o===null||!(typeof o=="object"||typeof o=="function"),Ir=o=>Array.isArray(o)||!!(o&&o[Symbol.iterator]),Mn=class{constructor(e,t,n){this.dirty=!0,this.element=e,this.name=t,this.strings=n,this.parts=[];for(let r=0;r<n.length-1;r++)this.parts[r]=this._createPart()}_createPart(){return new Vt(this)}_getValue(){let e=this.strings,t=e.length-1,n=this.parts;if(t===1&&e[0]===""&&e[1]===""){let s=n[0].value;if(typeof s=="symbol")return String(s);if(typeof s=="string"||!Ir(s))return s}let r="";for(let s=0;s<t;s++){r+=e[s];let a=n[s];if(a!==void 0){let i=a.value;if($t(i)||!Ir(i))r+=typeof i=="string"?i:String(i);else for(let c of i)r+=typeof c=="string"?c:String(c)}}return r+=e[t],r}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}},Vt=class{constructor(e){this.value=void 0,this.committer=e}setValue(e){e!==ze&&(!$t(e)||e!==this.value)&&(this.value=e,fo(e)||(this.committer.dirty=!0))}commit(){for(;fo(this.value);){let e=this.value;this.value=ze,e(this)}this.value!==ze&&this.committer.commit()}},Oe=class{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(De()),this.endNode=e.appendChild(De())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=De()),e.__insert(this.endNode=De())}insertAfterPart(e){e.__insert(this.startNode=De()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(this.startNode.parentNode===null)return;for(;fo(this.__pendingValue);){let t=this.__pendingValue;this.__pendingValue=ze,t(this)}let e=this.__pendingValue;e!==ze&&($t(e)?e!==this.value&&this.__commitText(e):e instanceof yt?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):Ir(e)?this.__commitIterable(e):e===Er?(this.value=Er,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){let t=this.startNode.nextSibling;e=e??"";let n=typeof e=="string"?e:String(e);t===this.endNode.previousSibling&&t.nodeType===3?t.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}__commitTemplateResult(e){let t=this.options.templateFactory(e);if(this.value instanceof Ln&&this.value.template===t)this.value.update(e.values);else{let n=new Ln(t,e.processor,this.options),r=n._clone();n.update(e.values),this.__commitNode(r),this.value=n}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());let t=this.value,n=0,r;for(let s of e)r=t[n],r===void 0&&(r=new Oe(this.options),t.push(r),n===0?r.appendIntoPart(this):r.insertAfterPart(t[n-1])),r.setValue(s),r.commit(),n++;n<t.length&&(t.length=n,this.clear(r&&r.endNode))}clear(e=this.startNode){ho(this.startNode.parentNode,e.nextSibling,this.endNode)}},Rr=class{constructor(e,t,n){if(this.value=void 0,this.__pendingValue=void 0,n.length!==2||n[0]!==""||n[1]!=="")throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=n}setValue(e){this.__pendingValue=e}commit(){for(;fo(this.__pendingValue);){let t=this.__pendingValue;this.__pendingValue=ze,t(this)}if(this.__pendingValue===ze)return;let e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=ze}},Pr=class extends Mn{constructor(e,t,n){super(e,t,n);this.single=n.length===2&&n[0]===""&&n[1]===""}_createPart(){return new Nn(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}},Nn=class extends Vt{},wu=!1;(()=>{try{let o={get capture(){return wu=!0,!1}};window.addEventListener("test",o,o),window.removeEventListener("test",o,o)}catch{}})();var Lr=class{constructor(e,t,n){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=n,this.__boundHandleEvent=r=>this.handleEvent(r)}setValue(e){this.__pendingValue=e}commit(){for(;fo(this.__pendingValue);){let s=this.__pendingValue;this.__pendingValue=ze,s(this)}if(this.__pendingValue===ze)return;let e=this.__pendingValue,t=this.value,n=e==null||t!=null&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),r=e!=null&&(t==null||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=Xg(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=ze}handleEvent(e){typeof this.value=="function"?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}},Xg=o=>o&&(wu?{capture:o.capture,passive:o.passive,once:o.once}:o.capture);var oa=class{handleAttributeExpressions(e,t,n,r){let s=t[0];return s==="."?new Pr(e,t.slice(1),n).parts:s==="@"?[new Lr(e,t.slice(1),r.eventContext)]:s==="?"?[new Rr(e,t.slice(1),n)]:new Mn(e,t,n).parts}handleTextExpression(e){return new Oe(e)}},Mr=new oa;function ra(o){let e=na.get(o.type);e===void 0&&(e={stringsArray:new WeakMap,keyString:new Map},na.set(o.type,e));let t=e.stringsArray.get(o.strings);if(t!==void 0)return t;let n=o.strings.join(mt);return t=e.keyString.get(n),t===void 0&&(t=new Ar(o,o.getTemplateElement()),e.keyString.set(n,t)),e.stringsArray.set(o.strings,t),t}var na=new Map;var sa=new WeakMap,U=(o,e,t)=>{let n=sa.get(e);n===void 0&&(ho(e,e.firstChild),sa.set(e,n=new Oe(Object.assign({templateFactory:ra},t))),n.appendInto(e)),n.setValue(o),n.commit()};typeof window<"u"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");var h=(o,...e)=>new yt(o,e,"html",Mr);var ef=0;function st(){return`ax-${ef++}`}function zn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("").map(o=>{if(o==="-"||o==="4")return o;let e=Math.random()*16|0;return(o==="x"?e:e&3|8).toString(16)}).join("")}var NI=`
	<div id="spinner" class="c-progress f-indeterminate-local f-progress-large" role="progressbar" tabindex="0" aria-valuetext="${_s}" aria-label="${_s}">
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
	</div>`;function Cu(){return h` <div
		class="nav-bar-logo"
		role="presentation"
		aria-hidden="true"
		itemprop="logo"
		itemscope="itemscope"
	>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="108"
			height="23"
			viewBox="72 72 337 74"
			preserveAspectRatio="xMidYMin slice"
		>
			<g data-name="MS-symbol">
				<clipPath>
					<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z" />
				</clipPath>
				<g clip-path="url(#a)">
					<path
						class="fill-current-color color-text-subtle"
						d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z"
					/>
					<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022" />
					<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00" />
					<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef" />
					<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900" />
				</g>
			</g>
		</svg>
	</div>`}var Nr=class{constructor(e){this.url=Do(e),this.source=this.url.searchParams.get("source"),this.source||(this.source=O("page_type")==="learn"||O("page_kind")==="learn"?"learn":"docs",O("uhfHeaderId")!=="answers"&&this.url.searchParams.set("source",this.source))}static getProfileContext(e){try{let t=e||location.href,n=new Nr(t),r=Do(t);return r.searchParams.delete("source"),{redirectUrl:r.href,source:n.source,microsoftUser:void 0}}catch{return{redirectUrl:void 0,source:void 0,microsoftUser:void 0}}}toString(){return this.url.href}};function Eu(o){let e=null;try{e=new Nr(o).toString()}catch{e=location.href}return e}var tf="18fbca16-2224-45f6-85b0-f7bf2b39b3f3",YI=new URL("./register",zo()).toString(),ku=location.hostname==="localhost"?"https://localhost:3000/dev/global/identity-redirect.html":`${location.origin}/_themes/docs.theme/master/en-us/_themes/global/identity-redirect.html`,of=location.hostname==="localhost"?"https://localhost:3000/dev/global/identity-profile.html":`${location.origin}/_themes/docs.theme/${sf()}/en-us/_themes/global/identity-profile.html`;var nf="https://login.microsoftonline.com",rf="common",Qo,Au=()=>{let o={auth:{clientId:tf,authority:`${nf}/${rf}`,redirectUri:ku},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,t,n)=>{if(!(Ue||n))switch(e){case se.Error:console.error(t);return;case se.Info:console.info(t);return;case se.Verbose:console.debug(t);return;case se.Warning:console.warn(t);return}}}}};Qo=new Xs(o)},Iu={scopes:["openid","profile","email"],prompt:"login"};function Ru(o){let e=Eu(o),t=of,n=encodeURIComponent(e),r=zn();return Qo.loginRedirect(Object.assign({},Iu,{redirectStartPage:t,nonce:r,redirectUri:ku,state:n}))}function Pu(){try{let o=Xt(),t=rl(o).preferred_username,n=Qo.getAccountByUsername(t);return t?Qo.acquireTokenSilent(Object.assign({},Iu,{prompt:"none",account:n})).then(r=>(ol(r.idToken),!0)).catch(()=>(or(),!1)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}function sf(){return un?(Jt(["themebranch","branch"],"master")||"master").replace(/^main$/,"master"):(Jt(["themebranch"],"master")||"master").replace(/^main$/,"master")}var aa=class{},ia=class{constructor(e,t,n=new wt){this.stack=e,this.final=t,this.bus=n}async run(){let e=0,t=!0,n=this.final,r=[],s=this.bus.subscribe(aa,()=>t=!1),a=i=>(this.bus.publish(new aa),n=i||n,!1);try{for(;t&&this.stack[e];){let i=await this.stack[e](a);if(i||r[e]!==!1){r[e]=i,e+=i?-1:1;continue}t=!1}e>=0&&n(),s()}catch(i){throw s(),this.final(),i}}};var Lu=te.profile.me,af=`${Lu}?isCPMCalled=true`;var cf=new URL("./register",zo()).toString(),lf="https://docs.microsoft.com";async function Mu(){let e=location.pathname.split("/").indexOf("edit")!==-1?af:Lu;try{let n=await fetch(Z(e,{credentials:"include"}));if(n.ok&&n.status!==204){let r=await n.json();M.readUserProfile(r)}else M.setAnonymous()}catch{M.setAnonymous()}}async function Nu(o=()=>{M.setAnonymous()}){if(!ce.userServices)return M.setAnonymous(),Promise.resolve();await new ia([uf,df,Pu],o).run()}async function uf(o=()=>!1){try{let e=Zt();if(e){let t=eo(e);return M.readUserFromToken(t),!0}return!1}catch(e){return e instanceof kt?!1:o()}}async function df(o=()=>!1){try{let e=Xt();if(e){eo(e);let t=await Tl(e);return nr(t),!0}return!1}catch(e){return e instanceof kt?!1:e instanceof ir?o(pf):o()}}function pf(){if(O("page_kind")!=="register"){M.setAnonymous();let t=Me({redirectUrl:location.href});location.href=`${cf}?${t}`;return}let o=Xt(),e=eo(o);M.mapIdTokenToProfile(e)}async function Gt(o=location.href,e=!1){e&&await B(te.auth.signOut),Ol(),nl(),or(),location.href=Do(o,lf).href}function zr(o=location.href){Ru(o)}function ue(o){return o.status===401&&M.setAnonymous(),o}var mf=[{title:"Microsoft Azure AI Fundamentals: Get started with artificial intelligence",description:null,durationInMinutes:59,completedOn:"2021-11-19T21:51:44.8120764+00:00"},{title:"Secure access to your applications by using Azure identity services",description:"Learn how Azure Active Directory helps you manage and secure identities. Also see how single sign-on, multifactor authentication, and Conditional Access enable your users to securely access resources and applications from your intranet and from public networks.",durationInMinutes:-1,completedOn:"2021-12-13T21:51:44.8120764+00:00"},{title:"Describe identity concepts",description:"Learn about the basic identity concepts, including identity as a security perimeter, authentication, authorization, the role of active directory and the concept of federated services.",durationInMinutes:100,completedOn:null},{title:"Configure network security groups",description:"You will learn how to implement network security groups and ensure network security group rules are correctly applied.",durationInMinutes:234,completedOn:"2021-12-03T21:51:44.8120764+00:00"},{title:"Plan and manage organizational settings with Exchange Online",description:"Plan and manage organizational settings such as global address lists, offline address books, address policies, organizational sharing, and add-ins in Exchange Online.",durationInMinutes:33,completedOn:"2021-12-04T21:51:44.8120764+00:00"},{title:"Manage devices by using Microsoft Intune",description:"This module will introduce you to the modern device management options for Windows 10 from Microsoft 365, including co-management and Microsoft Intune.",durationInMinutes:44,completedOn:"2021-12-05T21:51:44.8120764+00:00"},{title:"Work with web services in Dynamics 365 Business Central",description:"Do you want to use web services in Business Central? This module will explain the terminology and differences between SOAP and OData. Additionally, the module will describe how to configure these services in Business Central.",durationInMinutes:23,completedOn:"2021-10-02T21:51:44.8120764+00:00"},{title:"Write management scripts for Azure Cosmos DB SQL API",description:"Learn how to manage Azure Cosmos DB SQL API accounts, databases, and containers using the Azure CLI.",durationInMinutes:65,completedOn:"2021-10-05T21:51:44.8120764+00:00"},{title:"Create resource template for Azure Cosmos DB SQL API",description:"Learn about automated Azure Cosmos DB SQL API resource deployments using the Azure Resource Manager with JSON and Bicep templates.",durationInMinutes:76,completedOn:"2021-11-15T21:51:44.8120764+00:00"},{title:"Examine data visualizations with Power BI",description:"This module introduces you to the capabilities of Microsoft Power BI, how Power BI can be connected to your IoT solution, and how Power BI can be used to develop and share insights.",durationInMinutes:54,completedOn:"2021-12-16T21:51:44.8120764+00:00"},{title:"Java on Azure",description:"Start here and learn how you can build, migrate and scale Java applications on Azure using Azure services. Use tools and frameworks that you know and love \u2013 Spring, Tomcat, WildFly, JBoss, WebLogic, WebSphere, Maven, Gradle, IntelliJ, Eclipse, Jenkins, Terraform and more.",durationInMinutes:75,completedOn:"2021-12-17T21:51:44.8120764+00:00"},{title:"C# testing in Visual Studio",description:"Start testing your C# apps by using the testing tools in Visual Studio.",durationInMinutes:43,completedOn:"2021-12-18T21:51:44.8120764+00:00"},{title:"Create web apps and services with ASP.NET Core, minimal API, and .NET 6",description:".NET is a free, cross-platform, open-source developer platform for building many different types of applications. With minimal API, you can create an API in just four lines of code, while using the latest features of .NET 6.",durationInMinutes:54,completedOn:"2021-12-19T21:51:44.8120764+00:00"},{title:"Introduction to software testing concepts",description:"Describe the common best practices, theory, and patterns of writing tests. Characterize the types of problems that testing can solve for your repository.",durationInMinutes:76,completedOn:"2021-12-20T21:51:44.8120764+00:00"},{title:"Monitor app performance",description:"Learn how to use the tools offered in Application Insights to enhance the performance and stability of your applications.",durationInMinutes:45,completedOn:"2021-28-21T21:51:44.8120764+00:00"}],zu=[{certificationTitle:"Mock active certification 1",certificationNumber:"13579",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 2",certificationNumber:"24680",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 3",certificationNumber:"12345",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 1",certificationNumber:"13579",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 2",certificationNumber:"24680",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 3",certificationNumber:"12345",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 1",certificationNumber:"13579",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 2",certificationNumber:"24680",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock active certification 3",certificationNumber:"12345",earnedOnDate:"2021-12-20T21:51:44.8120764+00:00",expiryDate:"2022-12-20T21:51:44.8120764+00:00"}],Du=[{certificationTitle:"Mock historical certification 1",certificationNumber:"25367",certificationState:"expired",earnedOnDate:"2020-12-20T21:51:44.8120764+00:00",expiryDate:"2021-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 2",certificationNumber:"38645",certificationState:"retired",earnedOnDate:"2020-12-20T21:51:44.8120764+00:00",expiryDate:null},{certificationTitle:"Mock historical certification 3",certificationNumber:"76645",certificationState:"expired",earnedOnDate:null,expiryDate:"2020-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 1",certificationNumber:"25367",certificationState:"expired",earnedOnDate:null,expiryDate:null},{certificationTitle:"Mock historical certification 2",certificationNumber:"38645",certificationState:"retired",earnedOnDate:"2020-12-20T21:51:44.8120764+00:00",expiryDate:"2021-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 3",certificationNumber:"76645",certificationState:"expired",earnedOnDate:"2019-12-20T21:51:44.8120764+00:00",expiryDate:"2020-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 1",certificationNumber:"25367",certificationState:"expired",earnedOnDate:"2020-12-20T21:51:44.8120764+00:00",expiryDate:"2021-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 2",certificationNumber:"38645",certificationState:"retired",earnedOnDate:"2020-12-20T21:51:44.8120764+00:00",expiryDate:"2021-12-20T21:51:44.8120764+00:00"},{certificationTitle:"Mock historical certification 3",certificationNumber:"76645",certificationState:"expired",earnedOnDate:"2019-12-20T21:51:44.8120764+00:00",expiryDate:"2020-12-20T21:51:44.8120764+00:00"}],Ou=[{examTitle:"Mock passed exam 1",examNumber:"25367",passedDate:"2020-12-15T21:51:44.8120764+00:00"},{examTitle:"Mock passed exam 2",examNumber:"25367",passedDate:"2020-12-16T21:51:44.8120764+00:00"},{examTitle:"Mock passed exam 3",examNumber:"25367",passedDate:"2020-12-18T21:51:44.8120764+00:00"},{examTitle:"Mock passed exam 4",examNumber:"25367",passedDate:"2020-12-20T21:51:44.8120764+00:00"}],Uu=[{qualificationTitle:"Mock qualification 1",achievedOnDate:"2020-12-20T21:51:44.8120764+00:00"},{qualificationTitle:"Mock qualification 2",achievedOnDate:"2020-12-31T21:51:44.8120764+00:00"},{qualificationTitle:"Mock qualification 3",achievedOnDate:"2020-12-31T21:51:44.8120764+00:00"}],gf=[{mctTitle:"MCT History 1",activeFromDate:"2020-12-20T21:51:44.8120764+00:00",activeToDate:"2022-12-20T21:51:44.8120764+00:00"},{mctTitle:"MCT History 2",activeFromDate:null,activeToDate:"2022-12-20T21:51:44.8120764+00:00"}],fR={totalModulesCompleted:15,totalTrainingMinutes:750,docsId:"426f7f56-495d-9f81-9961-3620f5121ec2",modulesCompleted:mf,userName:"Surabhi-999",contactEmail:"surabhi.venkata.lakshmi.narasimha.sai.krishna.abhimithra.karthikeya.sharma@mock.com",certificationData:{legalName:"Surabhi Venkata Lakshmi Narasimha Sai Krishna Abhimithra Karthikeya Sharma",mcid:"16253",totalActiveCertifications:zu.length,totalHistoricalCertifications:Du.length,totalExamsPassed:Ou.length,totalQualificationsEarned:Uu.length,mctStatus:"placeholder mct status",activeCertifications:zu,passedExams:Ou,qualifications:Uu,certifiedTrainerHistory:gf,historicalCertifications:Du}};async function Fu(){let o=te.privacy.delete,t=await B(Dr(o,{credentials:"include",method:"POST"}));return ue(t),t.ok}async function Hu(){let o=te.profile.acknowledgePrivacyNotice,t=await B(Dr(o,{method:"POST"}));if(ue(t),cr(t,!1),!t.ok)throw new Error(`Unexpected response status ${t.status} for ${o}`)}async function ca(){let o=te.profile.merge,t=await B(Dr(o,{method:"GET"}));if(ue(t),t.ok){let{status:n}=await t.json();return n}return null}async function qu(){let o=te.profile.acknowledgeMergeStatus,t=await B(Dr(o,{method:"POST"}));if(ue(t),cr(t,!1),!t.ok)throw new Error(`Unexpected response status ${t.status} for ${o}`)}function Dr(o,e,t=!0,n="application/json",r=""){e=e||{},e.mode="cors";let s=new Request(o,e);return t&&s.headers.set("Authorization",`Bearer ${r||Zt()}`),(s.method==="PUT"||s.method==="POST")&&n!=="multipart/form-data"&&s.headers.set("Content-Type",n),s}var $u=class{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;let t=(e.getAttribute("class")||"").split(/\s+/);for(let n of t)this.classes.add(n)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach(t=>e+=t+" "),this.element.setAttribute("class",e)}}},Bu=new WeakMap,la=We(o=>e=>{if(!(e instanceof Vt)||e instanceof Nn||e.committer.name!=="class"||e.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");let{committer:t}=e,{element:n}=t,r=Bu.get(e);r===void 0&&(n.setAttribute("class",t.strings.join(" ")),Bu.set(e,r=new Set));let s=n.classList||new $u(n);r.forEach(a=>{a in o||(s.remove(a),r.delete(a))});for(let a in o){let i=o[a];i!=r.has(a)&&(i?(s.add(a),r.add(a)):(s.remove(a),r.delete(a)))}typeof s.commit=="function"&&s.commit()});var ua=new WeakMap,Jo=We(o=>e=>{let t=ua.get(e);if(o===void 0&&e instanceof Vt){if(t!==void 0||!ua.has(e)){let n=e.committer.name;e.committer.element.removeAttribute(n)}}else o!==t&&e.setValue(o);ua.set(e,o)});var Vu=(o,e)=>{let t=o.startNode.parentNode,n=e===void 0?o.endNode:e.startNode,r=t.insertBefore(De(),n);t.insertBefore(De(),n);let s=new Oe(o.options);return s.insertAfterNode(r),s},_o=(o,e)=>(o.setValue(e),o.commit(),o),da=(o,e,t)=>{let n=o.startNode.parentNode,r=t?t.startNode:o.endNode,s=e.endNode.nextSibling;s!==r&&Cr(n,e.startNode,s,r)},pa=o=>{ho(o.startNode.parentNode,o.startNode,o.endNode.nextSibling)},Gu=(o,e,t)=>{let n=new Map;for(let r=e;r<=t;r++)n.set(o[r],r);return n},Ku=new WeakMap,Wu=new WeakMap,ff=We((o,e,t)=>{let n;return t===void 0?t=e:e!==void 0&&(n=e),r=>{if(!(r instanceof Oe))throw new Error("repeat can only be used in text bindings");let s=Ku.get(r)||[],a=Wu.get(r)||[],i=[],c=[],l=[],d=0;for(let I of o)l[d]=n?n(I,d):d,c[d]=t(I,d),d++;let u,p,m=0,g=s.length-1,y=0,E=c.length-1;for(;m<=g&&y<=E;)if(s[m]===null)m++;else if(s[g]===null)g--;else if(a[m]===l[y])i[y]=_o(s[m],c[y]),m++,y++;else if(a[g]===l[E])i[E]=_o(s[g],c[E]),g--,E--;else if(a[m]===l[E])i[E]=_o(s[m],c[E]),da(r,s[m],i[E+1]),m++,E--;else if(a[g]===l[y])i[y]=_o(s[g],c[y]),da(r,s[g],s[m]),g--,y++;else if(u===void 0&&(u=Gu(l,y,E),p=Gu(a,m,g)),!u.has(a[m]))pa(s[m]),m++;else if(!u.has(a[g]))pa(s[g]),g--;else{let I=p.get(l[y]),N=I!==void 0?s[I]:null;if(N===null){let w=Vu(r,s[m]);_o(w,c[y]),i[y]=w}else i[y]=_o(N,c[y]),da(r,N,s[m]),s[I]=null;y++}for(;y<=E;){let I=Vu(r,i[E+1]);_o(I,c[y]),i[y++]=I}for(;m<=g;){let I=s[m++];I!==null&&pa(I)}Ku.set(r,i),Wu.set(r,l)}});var Yu=new WeakMap,Re=We(o=>e=>{if(!(e instanceof Oe))throw new Error("unsafeHTML can only be used in text bindings");let t=Yu.get(e);if(t!==void 0&&$t(o)&&o===t.value&&e.value===t.fragment)return;let n=document.createElement("template");n.innerHTML=o;let r=document.importNode(n.content,!0);e.setValue(r),Yu.set(e,{value:o,fragment:r})});var ju=new WeakMap,Qu=2147483647,hf=We((...o)=>e=>{let t=ju.get(e);t===void 0&&(t={lastRenderedIndex:Qu,values:[]},ju.set(e,t));let n=t.values,r=n.length;t.values=o;for(let s=0;s<o.length&&!(s>t.lastRenderedIndex);s++){let a=o[s];if($t(a)||typeof a.then!="function"){e.setValue(a),t.lastRenderedIndex=s;break}s<r&&a===n[s]||(t.lastRenderedIndex=Qu,r=0,Promise.resolve(a).then(i=>{let c=t.values.indexOf(a);c>-1&&c<t.lastRenderedIndex&&(t.lastRenderedIndex=c,e.setValue(i),e.commit())}))}});var _f=[];function xf(o){_f.push(o)}function Ju(o,e,t,n){o.addEventListener(e,t,n);let r=()=>o.removeEventListener(e,t,n);return xf(r),r}function Xu(o=document.documentElement,e=document.documentElement||document.body,t=(document.documentElement||document.body).scrollTop){return e.style.left="0",e.style.right="0",e.style.top=`-${t}px`,e.style.position="fixed",(n=!0)=>{e.style.left="",e.style.right="",e.style.top="",e.style.position="",n&&(o.scrollTop=t)}}var Or=["a","area","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'];function Ur(o){return o.matches(Or.join(","))}function Zu(o,e=!0){return t=>{if(t.target instanceof Element&&!o.contains(t.target)){t.preventDefault();let n,r=Array.from(o.querySelectorAll(Or.join(",")));t.target.compareDocumentPosition(o)&(e?Node.DOCUMENT_POSITION_PRECEDING:Node.DOCUMENT_POSITION_FOLLOWING)&&r.reverse();let s=r.length;for(;s--;){let a=r[s],i=getComputedStyle(a);if(!a.hidden&&i.display!=="none"&&i.visibility!=="hidden"&&(a.offsetWidth>0||a.offsetHeight>0)){n=a;break}}n=n||o,n.focus()}}}function ma(o){let e=o.createElement("span");return e.setAttribute("tabindex","0"),e.classList.add("modal-tab-sentinel"),e}var Fr=o=>{let e=o.querySelector("[autofocus]");if(e&&Ur(e)){e.focus();return}o.focus()},Ee=class{constructor(e){this.restoreScrollbar=()=>{};this.clickHandler=e=>{let t=e.target,n=t.closest(".modal-pop-content"),r=t.closest(".modal-close");r?(e.preventDefault(),this.hide(r.getAttribute("data-modal-result"))):n&&(e.preventDefault(),this.popContent())};this.escHandler=e=>{e.keyCode===27&&(e.preventDefault(),this.hide())};this.setAriaLabelledBy=e=>{let t=e.querySelector("h1")||e.querySelector("h2")||e.querySelector("h3")||e.querySelector("h4")||e.querySelector("p")||e.querySelector("figcaption");t&&(t.id||(t.id="modal-heading"),e.setAttribute("aria-labelledby",t.id))};this.container=k.createElement("div"),this.container.setAttribute("tabindex","-1"),this.container.setAttribute("role","dialog"),this.container.setAttribute("aria-modal","true"),this.container.classList.add("modal","has-default-focus"),U(h`<div class="modal-background modal-close"></div>
				${e} `,this.container),this.wrapper=k.createElement("div"),this.wrapper.setAttribute("data-bi-name","modal"),this.wrapper.insertAdjacentElement("afterbegin",this.container),this.contentStack=[e]}static get openCount(){return window.openModalCount||0}static set openCount(e){window.openModalCount=e}show(){return this.container.classList.contains("is-active")?this.openPromise:(Ee.openCount++,k.body.insertAdjacentElement("afterbegin",ma(k)),k.body.insertAdjacentElement("afterbegin",this.wrapper),this.wrapper.addEventListener("click",this.clickHandler),this.wrapper.addEventListener("keydown",this.escHandler),this.restoreScrollbar=Xu(k.documentElement,k.scrollingElement||k.documentElement,(k.scrollingElement||k.documentElement||k.body).scrollTop),this.container.classList.add("is-active"),k.body.insertAdjacentElement("afterbegin",ma(k)),this.setAriaLabelledBy(this.container),window.dispatchEvent(new CustomEvent("modal-show",{detail:{container:this.container}})),this.lastFocus=k.activeElement,this.focusHandler=Zu(this.wrapper),Ju(window,"focus",this.focusHandler,!0),Fr(this.container),this.openPromise=new Promise(e=>this.resolveOpen=e),this.openPromise)}hide(e=null){!this.container.classList.contains("is-active")||(Ee.openCount--,this.restoreScrollbar(),this.container.classList.remove("is-active"),this.wrapper.parentElement.removeChild(this.wrapper),Array.from(k.body.querySelectorAll(".modal-tab-sentinel")).forEach(t=>{k.body.removeChild(t)}),window.removeEventListener("focus",this.focusHandler),this.wrapper.removeEventListener("click",this.clickHandler),this.wrapper.removeEventListener("keydown",this.escHandler),this.lastFocus&&this.lastFocus instanceof HTMLElement&&this.lastFocus.focus(),this.resolveOpen(e),this.resolveOpen=void 0,this.openPromise=void 0)}updateContent(e,t=!0,n=!1){let r=this.container.querySelector(".modal-slide-container"),s=r.querySelector(".modal-slide:first-of-type");if(r===null||s===null)throw new Error(`The ${r===null?"modal-slide-container":"modal-slide"} class is missing!`);r.appendChild(e);let a={forward:Ct.userDir==="ltr"?"slide-right":"slide-left",backward:Ct.userDir==="ltr"?"slide-left":"slide-right"},i=n?a.forward:a.backward;t?(setTimeout(()=>{s.classList.add(i),e.classList.add(i)},50),setTimeout(()=>{e.classList.remove(i),c(this)},250)):c(this);function c(l){r.removeChild(s),Fr(l.container),l.setAriaLabelledBy(l.container)}}pushContent(e){this.contentStack.push(e),U(h`<div class="modal-background modal-close"></div>
				${this.contentElement} `,this.container),this.setAriaLabelledBy(this.container),Fr(this.contentElement)}popContent(){if(this.contentStack&&this.contentStack.length<=1)throw new Error("Error getting modal content");this.contentStack.pop(),U(h`<div class="modal-background modal-close"></div>
				${this.contentElement} `,this.container),Fr(this.contentElement)}get contentElement(){return this.contentStack[this.contentStack.length-1]}};var ga={setItem(o,e,t){try{let n=t.getTime();if(Date.now()>=n)return;let r={value:e,expiry:n};re.setItem(o,JSON.stringify(r))}catch{}},getItem(o){try{let e=re.getItem(o);if(!e)return null;let t=JSON.parse(e);return typeof t.expiry!="number"||isNaN(t.expiry)||Date.now()>=t.expiry?(re.removeItem(o),null):t.value}catch{return null}},removeItem(o){re.removeItem(o)},clear(){re.clear()}};var bf={Complete:{color:"success",icon:"docon-status-success-outline",text:Hc},Failed:{color:"danger",icon:"docon-status-failure-outline",text:qc},Running:{color:"warning",icon:"docon-status-info-outline",text:Bc}};function vf(){return ga.getItem("check-merge-status")!==null}function yf(){ga.removeItem("check-merge-status")}async function td(o=!1){if(!(!o&&!vf()))try{let e=await ca();if(e===null||(ed(e),e!=="Running"))return;let t=setInterval(async()=>{e=await ca(),ed(e),e!=="Running"&&(clearInterval(t),yf())},3e4)}catch{}}async function Tf(){try{await qu()}catch{}let o=document.getElementById("merge-status-alert");if(o===null)return;o.classList.add("disappearing"),document.getElementById("add-account").classList.add("is-sliding-up"),U(h``,o.parentElement)}async function ed(o){if(o==="Acknowledged")return;if(o==="Locked"){Sf();return}o==="Complete"&&gn.type==="profile"&&await Mu();let e=bf[o];if(!e)return;let t=document.querySelector("#add-account");if(!t)return;o==="Running"?(t.disabled=!0,t.classList.add("is-disabled")):(t.disabled=!1,t.classList.remove("is-disabled"));let n=document.querySelector(".accounts"),r=n.querySelector(".merging-status");n!==null&&(r===null&&(r=document.createElement("div"),r.classList.add("merging-status"),n.appendChild(r)),U(h`
			<div
				id="merge-status-alert"
				class="alert is-inline-alert is-radiusless is-${e.color}"
			>
				<span class="icon has-text-${e.color}" aria-hidden="true">
					<span class="docon ${e.icon}"></span>
				</span>
				<p class="display-inline">${Re(e.text)}</p>
				${o!=="Running"?h`<button
							class="delete position-absolute right-0 margin-xxs"
							data-dismiss=""
							type="button"
							@click=${()=>Tf()}
					  ></button>`:null}
			</div>
		`,r))}function Sf(){let o=document.createElement("div"),e=new Ee(o);U(h` <div class="modal-card">
			<section class="modal-card-body">
				<button
					data-dismiss
					type="button"
					class="dismiss delete modal-close position-absolute delete-lg margin-top-xs margin-right-xs top-0 right-0"
					@click="${()=>Gt(`https://docs.microsoft.com/${f.data.userLocale}`,!0)}"
					aria-label="${Qe}"
				>
					<span class="docon docon-navigate-close" aria-hidden="true"></span>
				</button>
				<h2 class="title margin-top-xxs">${Uc}</h2>
				<p>${Fc}</p>
				<div
					class="display-flex font-size-sm justify-content-flex-end margin-top-sm margin-bottom-xxs"
				>
					<button
						type="button"
						class="button modal-close align-self-center hmargin-right-xxs font-size-sm button-primary button-filled"
						@click="${()=>Gt(`https://docs.microsoft.com/${f.data.userLocale}`,!0)}"
						data-bi-name="merging-block-notice-signin"
					>
						${$c}
					</button>
				</div>
			</section>
		</div>`,o),e.show(),document.querySelector(".modal").addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),Gt(`https://docs.microsoft.com/${f.data.userLocale}`,!0)})}var Hr,qr;async function od(o){wf(o)&&await Cf()}function wf(o){let e=O("page_type")==="profile";if(!o.isAuthenticated||e)return!1;let t=!1;return typeof o.acceptedPrivacyNotice=="boolean"?t=o.acceptedPrivacyNotice:t=new Date(o.acceptedPrivacyNotice)>=Is,!t}async function Cf(){if(!Hr){let o=k.createElement("div");o.classList.add("modal-content"),U(h` <div
				id="consentModal"
				class="modal-card is-shadowless-mobile fill-mobile padding-xs padding-sm-tablet"
			></div>`,o),Hr=new Ee(o),qr=o.querySelector("#consentModal"),nd()}await ie,Hr.show()}function nd(){let o=M.userType==="microsoft"?ji:Ji,e=()=>Hu(),t=h`
		<section class="modal-card-body">
			<h2 class="title is-text-centered">${o}</h2>
			<p>${Re(Af())}</p>
			<button
				id="consent"
				@click="${e}"
				class="modal-close button button-primary button-filled display-block margin-inline-auto margin-top-sm"
				autofocus
			>
				${pc}
			</button>
			<button
				id="noThanks"
				@click="${Ef}"
				class="link-button margin-inline-auto margin-top-xs"
			>
				${tc}
			</button>
		</section>
	`;U(t,qr)}function Ef(){let o=h` <section class="modal-card-body padding-bottom-none">
		<h2>${pi}</h2>
		<p>${Xi}</p>
		<p class="margin-top-sm">${mi}</p>
		<div class="display-flex justify-content-flex-end margin-top-lg">
			<button
				id="consent-close"
				class="button border-none padding-inline-sm margin-right-xxs has-text-primary"
				@click="${nd}"
				autofocus
			>
				${Qe}
			</button>
			<button id="consent-delete-acct" class="button button-danger button-filled padding-inline-sm">
				${zi}
			</button>
		</div>
		<p
			hidden
			id="error-message"
			class="has-text-danger display-flex justify-content-flex-end margin-bottom-sm"
			aria-live="assertive"
			aria-relevant="text"
		>
			${Rc}
		</p>
	</section>`;U(o,qr),kf(qr)}async function kf(o){let e=o.querySelector("#error-message"),t=o.querySelector("#consent-delete-acct");e.setAttribute("hidden","hidden"),t.onclick=async()=>{t.classList.add("is-loading");try{await Fu()?(Hr.hide(),await Gt(`https://docs.microsoft.com/${f.data.userLocale}/`,!0)):e.removeAttribute("hidden")}catch(n){throw e.removeAttribute("hidden"),new Error(`error: ${n.message}`)}finally{t.classList.remove("is-loading")}}}function Af(o){return o&&o.length!==0||M.userType==="microsoft"?Qi.replace("{email}",o||M.upn):M.authenticationMode==="AAD"||M.userType==="aad"?li.replace("{email}",M.upn):Mi}async function rd(o,e,t){let n=()=>t.setAttribute("data-authenticated",o.isAuthenticated.toString());n(),o.subscribe(Fe,n),await e,t.setAttribute("data-auth-status-determined","true")}var at={left:37,up:38,right:39,down:40,home:36,end:35,escape:27,enter:13,space:32,eight:56,numPadAsterisk:106,a:65,b:90};var Dn="docs-sign-in",fa="docs-sign-out";function sd(o){Rf(o),o.addEventListener("click",If)}function If(o){if(!(o.target instanceof Element))return;let e=o.target.closest(`.${Dn}, .${fa}`);if(!e)return;let t=e.classList.contains(Dn);o.preventDefault();let n='a[href]:not([href=""]):not([href="#"])',r=e instanceof HTMLAnchorElement&&e.matches(n)?e.href:location.href;t?zr(r):Gt(r,!0)}function Rf(o){let e=t=>{if(!(t.target instanceof Element))return;let n=t.target.closest(`.${Dn}, .${fa}`);if(!n)return;let r=n.classList.contains(Dn);t.target.setAttribute("data-m",JSON.stringify({cN:r?Dn:fa,bhvr:r?100:101}))};o.addEventListener("touchstart",e,!0),o.addEventListener("pointerdown",e,!0),o.addEventListener("keyup",t=>{t.which===at.enter&&e(t)},!0)}var ha,ad=new Promise(o=>ha=o);function id(){if(!ce.userServices){ha(),ie.then(()=>{let o=k.getElementById("docs-sign-in-container-item");o&&(o.hidden=!0)});return}Au(),Qo.handleRedirectPromise(),rd(M,ad,k.documentElement),sd(k.documentElement),M.subscribe(Fe,async()=>{await Promise.all([ar,ie]),yl(k.body,M)}),Nu().then(ha),ad.then(async()=>{M.userType!=="standard"&&od(M),M.isAuthenticated&&(await ie,td())})}var _a={"ar-sa":"\u0627\u0644\u0639\u0631\u0628\u064A\u0629","eu-es":"Euskara","bs-latn-ba":"Bosanski","bg-bg":"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438","ca-es":"Catal\xE0","zh-cn":"\u4E2D\u6587 (\u7B80\u4F53)","zh-hk":"\u4E2D\u6587 (\u7E41\u9AD4 \u9999\u6E2F\u7279\u5225\u884C\u653F\u5340)","zh-tw":"\u4E2D\u6587 (\u7E41\u9AD4)","hr-hr":"Hrvatski","cs-cz":"\u010Ce\u0161tina","da-dk":"Dansk","nl-be":"Nederlands (Belgi\xEB)","nl-nl":"Nederlands","en-au":"English (Australia)","en-ca":"English (Canada)","en-in":"English (India)","en-ie":"English (Ireland)","en-my":"English (Malaysia)","en-nz":"English (New Zealand)","en-sg":"English (Singapore)","en-za":"English (South Africa)","en-gb":"English (United Kingdom)","en-us":"English (United States)","et-ee":"Eesti","fil-ph":"Filipino","fi-fi":"Suomi","fr-be":"Fran\xE7ais (Belgique)","fr-ca":"Fran\xE7ais (Canada)","fr-fr":"Fran\xE7ais","fr-ch":"Fran\xE7ais (Suisse)","gl-es":"Galego","ka-ge":"Georgian","de-at":"Deutsch (\xD6sterreich)","de-de":"Deutsch","de-ch":"Deutsch (Schweiz)","el-gr":"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC","he-il":"\u05E2\u05D1\u05E8\u05D9\u05EA\u200F","hi-in":"\u0939\u093F\u0902\u0926\u0940","hu-hu":"Magyar","is-is":"\xCDslenska","id-id":"Bahasa Indonesia","ga-ie":"Irish (Ireland)","it-it":"Italiano","it-ch":"Italiano (Svizzera)","ja-jp":"\u65E5\u672C\u8A9E","kk-kz":"\u049A\u0430\u0437\u0430\u049B","ko-kr":"\uD55C\uAD6D\uC5B4","lv-lv":"Latvie\u0161u","lt-lt":"Lietuvi\u0173","lb-lu":"Luxembourgish (Luxembourg)","ms-my":"Bahasa Malaysia","mt-mt":"Maltese (Malta)","nb-no":"Norsk","pl-pl":"Polski","pt-br":"Portugu\xEAs (Brasil)","pt-pt":"Portugu\xEAs (Portugal)","ro-ro":"Rom\xE2n\u0103","ru-ru":"\u0420\u0443\u0441\u0441\u043A\u0438\u0439","sr-cyrl-rs":"\u0421\u0440\u043F\u0441\u043A\u0438 (\u0421\u0440\u0431\u0438\u0458\u0430 \u0438 \u0426\u0440\u043D\u0430 \u0413\u043E\u0440\u0430)","sr-latn-rs":"Srbija - Srpski","sk-sk":"Sloven\u010Dina","sl-si":"Slovenski","es-mx":"Espa\xF1ol (M\xE9xico)","es-es":"Espa\xF1ol (Espa\xF1a)","sv-se":"Svenska","th-th":"\u0E44\u0E17\u0E22","tr-tr":"T\xFCrk\xE7e","uk-ua":"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430","vi-vn":"Ti\xEA\u0301ng Vi\xEA\u0323t"};var Xo=/^\/([a-z]{2,3}-(?:[a-z]{4}-)?[a-z]{2})(\/|$)/i;function cd(o){return!!_a[o]}function Br(o,e,t=!0){return!o||!cd(e)||o.indexOf("http://")===0||o.indexOf("https://")===0||o.indexOf("//")===0?o:Xo.test(o)?t?Lf(o,e):o:"/"+e+o}function Kt(o){return o.replace(Xo,"/")}function Lf(o,e){return o.replace(Xo,`/${e}$2`)}var Mf=["ApiBrowserPage","BlogHome","Challenge","Conceptual","ContentBrowserPage","ContentPage","Course","Directory","Home","Hub","HubPage","Landing","LandingPage","LearnHome","LearnTV","LearningPath","Marketing","Reference","Role","Sample","SearchPage","Show","TopicLanding","Welcome"],Nf=["/aspnet/core/blazor/globalization-localization","/dotnet/framework/ui-automation/accessibility-best-practices","/learn/modules/intro-accessibility-disability/","/learn/modules/write-inclusive-windows-apps/","/learn/paths/accessibility-fundamentals/","/microsoft-edge/accessibility/","/microsoft-edge/devtools-guide-chromium/accessibility/reference","/windows/uwp/design/accessibility/basic-accessibility-information","/xamarin/android/app-fundamentals/accessibility","/xamarin/ios/app-fundamentals/accessibility","/xamarin/xamarin-forms/app-fundamentals/accessibility/"];function xa(o=location.pathname,e=gn.template){return o=Kt(o),Nf.includes(o)?!1:Mf.includes(e)||!e&&o.startsWith("/answers/")}function ba(){let o=document.getElementById("cookie-consent-holder");return!o||document.getElementById("banner-holder")?null:(o.insertAdjacentHTML("afterend",'<div id="banner-holder" class="has-default-focus has-overflow-hidden"></div>'),o.nextElementSibling)}var $r=[];function ld(){return!1}var Vr="banner-instructions",zf=1e3*60*60*24;function ud(o=ce.temporaryClientSideEventBanners){if(!!o){try{Of()}catch{re.removeItem(Vr)}Df()}}async function Df(o=B,e=new Date){let t=dd();if(t&&t.date.getTime()+zf>Date.now())return;let n=new URL(`/${f.data.userLocale}/banners/index.json`,location.origin);if(location.hostname!=="docs.microsoft.com"&&location.hostname!=="developer.microsoft.com"){let a=new URLSearchParams(location.search).get("api-branch")??"main";n.searchParams.set("branch",a)}let r=await o(n.href),{banners:s=[]}=r.ok?await r.json():{};re.setItem(Vr,JSON.stringify({date:e,banners:s}))}function Of(){let o=dd();if(!o)return;let e=f.data.userLocale,t=o.banners.filter(n=>n.location==="sectional"&&n.scope.accessLevels.includes("online")&&n.content.link&&(!n.scope.locales||n.scope.locales.includes(e))).map(({uid:n,scope:r,content:s})=>{let[a,i]=s.text.split("|");i||(i=a,a=""),a=a.trim(),i=i.trim();let c=r.paths.map(p=>p.substring(1).replace(/\*/g,"")),l=!r.paths.find(p=>p.endsWith("*")),d=s.link.href.startsWith("/")?`/${e}${Kt(s.link.href)}`:s.link.href;return{id:n,startTime:r.startDate,endTime:r.endDate,paths:c,fullPathMatch:l,eventTitle:a,eventDescription:i,linkHref:d,linkText:s.link.title}});$r.push(...t)}function dd(){let o=re.getItem(Vr);if(!o)return null;try{let e=JSON.parse(o);if(e.date=new Date(e.date),isNaN(e.date.getTime()))return null;for(let t of e.banners)if(t.scope.startDate=new Date(t.scope.startDate),t.scope.endDate=new Date(t.scope.endDate),isNaN(t.scope.startDate.getTime())||isNaN(t.scope.endDate.getTime()))return null;return e}catch{re.removeItem(Vr)}return null}function pd(){if(!xa()||ld())return;ud();let o=ps();for(let e of $r){let{id:t,startTime:n,endTime:r,paths:s,fullPathMatch:a}=e;if(o<n.getTime()||o>=r.getTime()||re.getItem(t)==="hide")continue;let i=J.pathname.split("/").slice(2).join("/").toLowerCase();if(!!!s.find(p=>a?i===p:i.startsWith(p)))continue;let l=ba();if(!l)return;let d=Uf(`${t}-banner`,`${t}-event`,e.eventTitle,e.eventDescription,e.linkHref,e.linkText);U(d,l);let u=l.querySelector("[data-dismiss]");u.onclick=()=>re.setItem(t,"hide")}}function Uf(o,e,t,n,r,s){return h`<section
		id=${o}
		data-bi-name=${e}
		data-dismissable="disappearing"
		class="alert is-banner is-info border-bottom padding-inline-none"
	>
		<div class="uhf-container display-flex align-items-center font-size-sm">
			<span class="flex-grow-1">
				${t?h`<span class="font-weight-semibold">${t}</span>:`:null}
				<span class="margin-right-xs">${n}</span>
				<a
					id="${o}-banner-anchor"
					class="font-weight-semibold"
					data-bi-name="CTA"
					href="${r}"
					><span>${s}</span
					><span class="icon" aria-hidden="true"
						><span class="docon docon-chevron-right-light"></span></span
				></a>
			</span>
			<button
				type="button"
				class="delete delete-lg margin-left-xs"
				data-dismiss
				data-bi-name="close"
			>
				<span class="visually-hidden">${Ao}</span>
			</button>
		</div>
	</section>`}function md(){window.addEventListener("click",({target:o})=>{let e=o instanceof Element&&o.closest("[data-dismiss]");if(!e)return;let t=e.closest("[data-dismissable]");!t||Gr(t)},{passive:!0})}async function Gr(o){o.getAttribute("data-dismissable")==="disappearing"&&(o.classList.add("disappearing"),await new Promise(e=>setTimeout(e,500))),o.classList.remove("disappearing"),o.remove(),no()}function gd(o){o.addEventListener("click",e=>{let t=null;if(t=e.target instanceof Element&&e.target.closest(".dropdown-trigger"),t||(t=e.target instanceof Element&&e.target.shadowRoot&&e.target.shadowRoot.activeElement&&e.target.shadowRoot.activeElement.closest(".dropdown-trigger")),!t)return;e.preventDefault();let n=t.parentElement,r=t.getAttribute("aria-expanded")!=="true",s=Array.from(t.parentElement.querySelectorAll(".dropdown-trigger")).filter(i=>i.parentElement===n);s.forEach(i=>{i.setAttribute("aria-expanded",r.toString())});let a;if(r){n.classList.contains("has-centered-menu")||Ff(n);let i=u=>{u.target instanceof Element&&(!n.contains(u.target)||u.type==="click"&&u.target.closest(".dropdown-menu-close"))&&(a(),u.target.classList.contains("dropdown-menu-close")&&t.focus())},c=u=>{u.keyCode===at.escape&&(a(),t.focus())},l=async()=>{(k.activeElement&&k.activeElement.nodeName||"").toLowerCase()==="iframe"&&a()};a=()=>{o.removeEventListener("focus",i),o.removeEventListener("click",i),o.removeEventListener("touchstart",i),o.removeEventListener("keydown",c),H.removeEventListener("blur",l),s.forEach(u=>{u.setAttribute("aria-expanded","false")})};let d=!0;o.addEventListener("focus",i,d),o.addEventListener("click",i),o.addEventListener("touchstart",i),o.addEventListener("keydown",c),o.addEventListener("collapse-dropdown",u=>{u.stopPropagation(),a()}),H.addEventListener("blur",l)}})}function Ff(o){let e=g=>H.getComputedStyle(g).overflowX,t=o.parentElement;for(;t&&t.nodeName!=="BODY"&&e(t)!=="hidden";)t=t.parentElement;if(t===null)return;let n=o.querySelector(".dropdown-trigger"),r=o.querySelector(".dropdown-menu"),s=o.closest(".dropdown-menu")!==null,a=r.classList.contains("is-vertically-scrollable");r.style.left="",r.style.right="",r.style.maxHeight="";let{left:i,right:c}=t.getBoundingClientRect(),{left:l,right:d,top:u,bottom:p}=n.getBoundingClientRect(),m=r.getBoundingClientRect().width;s?(r.style.top="-1px",f.data.userDir==="ltr"?d+m<=c?(r.style.right="0",r.style.transform="translateX(100%)"):(r.style.left="0",r.style.transform="translateX(-100%)"):d-m>=i?(r.style.left="0",r.style.transform="translateX(-100%)"):(r.style.right="0",r.style.transform="translateX(100%)"),a&&(r.style.maxHeight=`${H.innerHeight-u-8}px`)):(f.data.userDir==="ltr"?l+m<=c?r.style.left="0":r.style.right="0":d-m>=i?r.style.right="0":r.style.left="0",a&&(r.style.maxHeight=`${H.innerHeight-p-8}px`))}function hd(){ie.then(()=>{let o=Array.from(document.querySelectorAll(".post-controls > .accept-answer"));for(let e of o){let t=e.previousSibling;t instanceof Text&&t.remove(),e.classList.add("btn"),e.parentElement.classList.add("hasAcceptAnswer")}})}function _d(){for(let o of Array.from(document.querySelectorAll(".dropdown, .post-tools"))){let e=o.querySelector("button.dropdown-toggle"),t=o.querySelector("ul.dropdown-menu");if(!e||!t)continue;e.setAttribute("aria-haspopup","true"),t.setAttribute("role","menu");let n=Array.from(o.querySelectorAll("ul > li"));n.forEach((r,s)=>{r.setAttribute("role","none");let a=r.firstElementChild;!a||(a.setAttribute("role","menuitem"),a.addEventListener("keydown",i=>Hf(i,s,n)))})}}function Hf(o,e,t){if(!["ArrowDown","ArrowUp"].includes(o.key)||!(o.target instanceof HTMLElement))return;o.stopPropagation(),o.preventDefault();let n=t[0].firstElementChild,r=t[t.length-1].firstElementChild,s=t[e-1]?.firstElementChild,a=t[e+1]?.firstElementChild;o.key==="ArrowUp"&&(s??r).focus(),o.key==="ArrowDown"&&(a??n).focus()}function xd(){ie.then(()=>{let o=Array.from(document.querySelectorAll(".flash-message"));for(let e of o)e.removeAttribute("tabindex")})}function bd(){ie.then(()=>{let o=document.getElementById("moderationTabs");if(o!==null){o.removeAttribute("role");let e=Array.from(o.querySelectorAll("li"));for(let n of e)n.removeAttribute("role");let t=Array.from(o.querySelectorAll("a"));for(let n of t)n.removeAttribute("role"),n.removeAttribute("aria-selected"),n.removeAttribute("aria-label")}})}function vd(){document.querySelectorAll("#deleteAllPostsCommand").forEach((o,e)=>{e>0&&o.removeAttribute("id")})}function yd(){ie.then(()=>{let o=Array.from(document.querySelectorAll('.userlist > .user > [role="list"] > :not([role="listitem"])')),e=Array.from(document.querySelectorAll('.userlist > .user > [role="list"] > .score')),t=Array.from(document.querySelectorAll('.userlist > .user > span > a[rel="user"]')),n=Array.from(document.querySelectorAll('.comment-header > a.comment-user[rel="user"]'));for(let r of o)r.setAttribute("role","listitem");for(let r of e)r.removeAttribute("tabindex");for(let r of t){r.setAttribute("tabindex","0");let s=r.textContent.replace("User is a super user","").replace("\u2666\u2666","super user").trim();r.setAttribute("aria-label",s)}for(let r of n){let s=r.textContent.replace("\u2666\u2666","super user").trim();r.firstElementChild.setAttribute("aria-label",s)}})}function va(o){if(!o)return;let e=new MutationObserver(()=>{let t=Array.from(o.querySelectorAll(".wmd-button-elem"));if(t.length!==0){for(let n of t)n.setAttribute("role","button");e.disconnect()}});e.observe(o,{childList:!0})}function Td(){let o=document.querySelector("#fmask #body-label + .control-group > .controls"),e=document.querySelector("#answer-form .control-group > .controls"),t=Array.from(document.querySelectorAll('form[id^="comment-"][id$="-form"] > .comment-form-widgets-container > .comment-form-textarea-container'));!o&&!e&&!t||(o&&va(o),e&&va(e),t&&t.forEach(n=>{va(n)}))}function Sd(){let o=document.querySelector(".post-tools .dropdown-menu li a[command=viewIdeaStateHistoryCommand]");if(!o)return;let e=h` <button
		class="ajax-command button-to-link"
		data-status="none"
		command="viewIdeaStateHistoryCommand"
		data-process="no"
	>
		View Status History
	</button>`;U(e,o.parentElement),o.remove();let t=document.querySelector(".post-tools .dropdown-menu li button[command=viewIdeaStateHistoryCommand]");t.onclick=()=>{let n=new MutationObserver(()=>{let r=document.querySelector(".modal button");!r||(r.focus(),n.disconnect())});n.observe(document.body,{childList:!0})}}function wd(){document.querySelectorAll("#recent-followers a.user").forEach(e=>{e.remove()})}function Cd(){let o=document.querySelector('button[command="redirectQuestion"]');if(!o)return;let e=new MutationObserver(t=>{for(let n of t)for(let r of Array.from(n.addedNodes)){let s=r;if(s&&s.classList&&s.classList.contains("select2-container")&&s.querySelector('input[role="searchbox"]')){if(!(document.activeElement.querySelector(".select2-selection > #searchQuestion-container")!==null))continue;let i=document.activeElement,c=s.querySelector('input[role="searchbox"]');c?.focus(),i.addEventListener("focus",()=>{c?.focus()})}}});o.onclick=()=>{e.observe(document.body,{childList:!0,subtree:!0})}}function Ed(){Array.from(document.querySelectorAll('button[command="voteInList"]')).forEach(e=>{if(document.querySelector('html[data-authenticated="false"]')){let n=e.nextElementSibling,r=document.createElement("p");r.id=n.id,r.classList.add("votes","muted");let s=n.innerText,a=h`
				<span>${s}</span>
				${s==="1"?"Vote":"Votes"}
			`;U(a,r),n.insertAdjacentElement("afterend",r),n.remove()}e.removeAttribute("aria-atomic"),e.removeAttribute("aria-live")})}function kd(){let o=document.querySelector(".question-filter");if(!o)return;let e=document.createElement("button");e.classList.add("dropdown-toggle","button-to-link","title-drop-link"),e.id="filters-drop",e.setAttribute("data-toggle","dropdown");let t=h`<span class="title-drop"
		><h1 class="h3 d-inline capitalize">All Questions</h1>
		<i class="icon-chevron-down"></i
	></span>`;U(t,e),o.insertAdjacentElement("afterend",e),o.remove()}function Ad(){ie.then(()=>{let o=e=>{let t=e.target instanceof HTMLElement&&(e.target.closest(".preview-tab")||e.target.closest(".source-tab"));if(!t)return;e.stopPropagation();let n=t.closest(".answer-form-widget")||t.closest(".comment-form-container");t.classList.contains("preview-tab")?(n.querySelector(".wmd-panel.wmd-button-bar")?.setAttribute("hidden","true"),n.querySelector("form .hint-label.keyboard-hint")?.setAttribute("hidden","true")):(n.querySelector("form .hint-label.keyboard-hint")?.removeAttribute("hidden"),n.querySelector(".wmd-panel.wmd-button-bar")?.removeAttribute("hidden"))};document.addEventListener("click",o)})}function Id(){ie.then(()=>{setTimeout(()=>{let o=Array.from(document.querySelectorAll(".comment-recipient-container .context-menu-dropdown-comments"));for(let e of o){e.setAttribute("role","menu");let t=Array.from(e.querySelectorAll("li"));for(let n of t){n.setAttribute("role","none");let r=Array.from(e.querySelectorAll('a[href="#"]'));for(let a of r)a.setAttribute("role","menuitem"),a.removeAttribute("aria-describedby");let s=Array.from(e.querySelectorAll("span"));for(let a of s)a.remove()}}},10)})}function Rd(){let o=document.querySelector("#filters-drop");!o||(o.setAttribute("aria-expanded","false"),o.onclick=()=>{let e=o.getAttribute("aria-expanded")==="true";o.setAttribute("aria-expanded",e.toString())})}function Pd(){let o=Array.from(document.querySelectorAll('.user a[href="/answers/users/2/anon-user.html"], a.comment-user[href="/answers/users/2/anon-user.html"], span.parent-author'));o=o.filter(e=>e.tagName==="A"||e.textContent===" $$ANON_USER$$ "),o.forEach(e=>{let t=document.createElement("span");t.style.fontWeight="600",t.innerText="Anonymous",e.insertAdjacentElement("afterend",t),e.remove()})}function Ld(){let o=document.querySelector("ul.nav-pills.sort");if(!!o){o.parentElement.setAttribute("role","navigation"),o.removeAttribute("role");for(let e of Array.from(o.querySelectorAll("li"))){e.removeAttribute("role");let t=e.querySelector("a");t.removeAttribute("role"),t.removeAttribute("aria-selected");let n=t.getAttribute("aria-label");if(!n)return;t.setAttribute("aria-label",n.split("-")[0].replace("not selected","").trim()),e.classList.contains("active")&&t.setAttribute("aria-current","true")}}}function Md(){let o=Array.from(document.querySelectorAll("ul.nav-pills.sort > li"));if(!!o)for(let e of o){let t=e.querySelector("a");t.classList.remove("has-tooltip"),t.querySelector("span.sr-only")&&t.querySelector("span.sr-only").remove(),t.hasAttribute("title")||t.setAttribute("title",t.innerText)}}function Nd(){if(document.documentElement.getAttribute("data-authenticated")==="true")return;let e=document.querySelector(".mainContent .widget .widget-header > div > span");if(e?.textContent!=="All Questions")return;let t=document.createElement("h1");t.textContent=e.textContent,t.classList.add("h3"),e.insertAdjacentElement("afterend",t),e.remove()}function zd(){let o=document.querySelector("div.topic-hit.search-hit > div > img");!o||o.setAttribute("role","presentation")}function Dd(){let o=document.querySelector(".widget-content .revision #rev-header-1 .summary span.h4");if(!o)return;let e=o.innerHTML,t=h`<h2 class="h4">${e}</h2>`,n=Array.from(document.querySelectorAll(".rev-body > h2.h5"));!n||(n.forEach(r=>{let s=r.innerHTML,a=document.createElement("h3");a.classList.add("h5"),a.innerHTML=s,r.replaceWith(a)}),U(t,o.parentElement))}function Od(){let o=document.querySelector("ul.userlist");if(!o)return;o.classList.add("margin-top-xs");let e=document.createElement("span");e.textContent="\u2666\u2666 Indicates a super user",o.insertAdjacentElement("beforebegin",e)}function ya(o){let e=document.querySelector('label[for="selectable-report-reasons"]');!e||(e.textContent=`Please select a reason below to ${o} this thread. You can use the text box to input additional information.`)}function Ud(){let o=document.querySelector(".datetimepicker");!o||o.remove()}function fd(o){return new Date(o).toLocaleDateString("en-CA")}function Fd(){let o=document.getElementById("search-query"),e=document.getElementById("advancedSearch--startDate"),t=document.getElementById("advancedSearch--endDate");if(!o||!e&&!t)return;e.setAttribute("maxlength","10"),t.setAttribute("maxlength","10");let n=o.value.trim();e.onchange=()=>{e.value=fd(e.value),o.value=n.split("date")[0].trim()+' date:"'+e.value+" TO "+t.value+'"'},t.onchange=()=>{t.value=fd(t.value),o.value=n.split("date")[0].trim()+' date:"'+e.value+" TO "+t.value+'"'}}function Hd(){let o=location.pathname.split("/").slice(2).join("/").toLowerCase(),e=document.querySelector(".post-controls");if(!e||!o.startsWith("answers/questions"))return;let t=document.createElement("button");t.classList.add("collection","button-to-link"),t.setAttribute("data-list-type","collection");let n=qf();U(n,t),e.appendChild(t)}function qf(){return h`
		<span class="icon" aria-hidden="true">
			<span class="docon docon-circle-addition"></span>
		</span>
		<span class="add-to-collection-status">${Po}</span>
	`}var wa=4,Bf={idea:"docon-lightbulb-regular",question:"docon-question-circle-solid",topic:"docon-tag-circle-solid",user:"docon-user"},$f={"social.msdn.microsoft.com":{icon:"docon-book-solid",sourceTitle:xc},"github.com":{icon:"docon-brand-github",sourceTitle:Pc},"stackoverflow.com":{icon:"docon-brand-stack-overflow-solid",sourceTitle:Lc}};function qd({type:o,url:e}){let t=e.startsWith("/")&&o!=="kbentry",n=e.startsWith("/")&&o==="kbentry";if(t)return{sourceTitle:"",icon:Bf[o]};if(n)return{sourceTitle:"",icon:"docon-book-solid"};let r=new URL(e).host;return $f[r]}async function Kr(o,e){if(!o||o.length<wa)return Promise.resolve([]);let[t,n]=await Promise.all([Vf(o,e),Gf(o)]);return Kf(t,n)}async function Vf(o,e){let t={externalSearchResults:{count:0,numberOfPages:0,pageNumber:0,pageSize:0,query:"",results:[],resultsCount:0,resultIds:[]},searchResults:{count:0,numberOfPages:0,pageNumber:0,pageSize:0,query:"",results:[],resultsCount:0,resultIds:[]}},n={headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"};o.indexOf("*")===-1&&(o+="*");let r=new URLSearchParams({type:e,compact:"true",q:o}).toString(),s=`${te.forumSearch.forumInternalQuestionSuggestions}?${r}`,a=Z(s,n,!1),i=await B(a);return i.ok?i.json():t}async function Gf(o){let e={Count:0,Matches:[]},n={body:JSON.stringify({SearchText:o,Top:7}),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",redirect:"follow"},r=Z(te.forumSearch.azureKbQuestionSuggestions,n,!1),s=await B(r);return s.ok?s.json():e}function Kf(o,e){let t=o.searchResults.results,n=e.Matches;return t.length>=4?n.length>=3?[...t.slice(0,4).map(Ta),...n.slice(0,3).map(Sa)]:[...t.slice(0,7-n.length).map(Ta),...n.map(Sa)]:[...t.map(Ta),...n.slice(0,7-t.length).map(Sa)]}function Ta(o){let e=qd({type:o.type,url:o.url});return o.username?{icon:"docon-user",title:o.username,type:"user",url:o.url,realname:o.realname}:{answerCount:o.childCount,acceptedAnswer:o.marked,icon:e.icon,title:o.titleUnescaped,type:o.type,upVotesCount:o.score,url:o.url}}function Sa(o){let e=qd({type:"",url:o.SourceUri});return{answerCount:o.AnswerCount,acceptedAnswer:!1,icon:e.icon,title:o.Title,type:"kbentry",upVotesCount:o.UpVotesCount,url:o.SourceUri,sourceTitle:e.sourceTitle}}function Wr(o){return o.map(e=>({title:e.title,type:e.type,url:e.url}))}function Zo({suggestion:o,term:e}){Ne({behavior:we.SEARCHAUTOCOMPLETE,actionType:Ae.OTHER,content:{srchq:e,srchtype:"auto suggest",resultselected:o.title,resulttype:o.type||"",resulturl:o.url||""}})}function en(o){let e=[{srchtype:"auto suggest"}];o.forEach((t,n)=>{e.push({cN:t.title,sN:n,type:t.type||"",url:t.url||""})}),Ne({content:e})}function Bd(o,e,t,n=500){let r=0,s=(...a)=>{e(r),r=o.apply(null,[t.bind(null,...a),n])};return s.cancel=()=>e(r),s}var $d={timeout:Bd.bind(null,setTimeout,clearTimeout),animationFrame:Bd.bind(null,H.requestAnimationFrame,H.cancelAnimationFrame)};function Vd(){let o=document.querySelector("#submit-question");if(!!o)return o.setAttribute("data-bi-name","submit-question")}function Gd(){let o=document.querySelector(".create-post-form-ask form#fmask #title");if(!o)return;let e=document.createElement("div");o.parentElement.insertAdjacentElement("beforebegin",e),Wf(o);let t=Kd(e,o);U(t,e),Zf(o)}function Wf(o){let e=document.querySelector('label[for="title"]');o.hidden=!0,e.hidden=!0;let t=document.querySelector("form#fmask .similar-questions");t.hidden=!0}function Kd(o,e,t){let n=t&&t.length>0,r=Yf(n,t),s=n?h` <ul>
				${t.map(a=>Xf(a))}
		  </ul>`:h``;return h`
		<div class="controls">
			<label for="question-title">
				<i class="fa fas fa-asterisk required-asterisk" aria-hidden="true"></i>
				${Sc}
				<span class="sr-only">${bc}</span>
			</label>

			<input
				type="text"
				id="question-title"
				name="question-title"
				placeholder="${vc}"
				autocomplete="off"
				autocorrect="off"
				spellcheck="false"
				value="${e.value||""}"
				@input=${$d.timeout(a=>Jf(a,o,e))}
				@change=${a=>Qf(a,e)}
			/>
		</div>
		<div
			id="suggestions-container"
			class="box-shadow-light has-max-height-300 is-vertically-scrollable padding-xs padding-bottom-xxs ${n?"":"visually-hidden"}"
		>
			<p class="margin-bottom-xs font-weight-semibold" aria-live="polite" aria-atomic="true">
				${r}
			</p>
			${s}
		</div>
	`}function Yf(o,e){return o?e.length===1?h`<span class="visually-hidden">1</span> ${yc}`:h`<span class="visually-hidden">${e.length}</span>
					${Tc}`:h``}function jf(){let o=document.querySelector("#question-title");return o?o.value:""}function Qf(o,e){let t=o.target;if(!t)return;let{value:n}=t;e.value=n}async function Jf(o,e,t){let r=o.target.value.trim(),s=[];r&&r.length>5&&(s=await Kr(r,"question"),en(Wr(s)));let a=Kd(e,t,s);U(a,e)}function Xf(o){let{title:e,url:t,sourceTitle:n,answerCount:r,upVotesCount:s}=o,a=o.acceptedAnswer?h` <div class="column is-narrow">
				<p class="has-text-success margin-right-xxs padding-xxs">
					<span class="icon is-small" aria-hidden="true">
						<span class="docon docon-status-success-outline"></span>
					</span>
					<br class="is-hidden-mobile" />
					${_c}
				</p>
		  </div>`:h``;return h`
		<li class="padding-block-xxs border-top">
			<div class="columns is-gapless">
				<div class="column">
					<p class="line-clamp-1 margin-right-xxs margin-bottom-xxs margin-top-xxs-tablet">
						<a
							@click=${()=>Zo({suggestion:o,term:jf()})}
							href="${t}"
							class="has-inner-focus  ${n?"has-external-link-indicator":""}"
						>
							${n?`${n}: `:""}${e}
						</a>
					</p>
				</div>
				<div class="column is-narrow">
					<div
						class="columns is-mobile is-gapless has-text-centered font-size-xs has-line-height-reset"
					>
						${a}
						<div class="column is-narrow">
							<p class="has-background-success-light margin-right-xxs padding-xxs">
								<b>${r}</b>
								<br class="is-hidden-mobile" />
								${di}
							</p>
						</div>
						<div class="column is-narrow">
							<p class="has-body-background-medium padding-xxs">
								<b>${s}</b>
								<br class="is-hidden-mobile" />
								${Kc}
							</p>
						</div>
					</div>
				</div>
			</div>
		</li>
	`}function Zf(o){setTimeout(()=>{let e=document.querySelector(".modal-footer > .btn");!e||e.addEventListener("click",t=>{t.preventDefault();let n=document.querySelector("#question-title");n.value=o.value})},200)}function Wd(){k.querySelector("#not-footer").classList.add("has-default-focus")}function Yd(){let o=Array.from(k.querySelectorAll(".wmd-textarea")),e=Array.from(k.querySelectorAll(".commentBox"));o.forEach(t=>t.classList.add("has-inner-focus")),e.forEach(t=>t.classList.add("has-inner-focus"))}function jd(){let o="https://docs.microsoft.com";P.systemContent&&(o="");let e=location.origin,t=ft[1],n=ft[2],r=`${e}/${t}/${n}`,s=document.querySelector("#bottom"),a=P.accessLevel==="isolated"?h`<span class="docons docon-external-link" aria-hidden="true"></span>`:"",i=P.accessLevel==="isolated"?bs+": "+hs:"",c=fc.replace("&amp;",""),l=P.accessLevel==="isolated"?c+": "+hs:"",d=h`
		<section class="has-default-focus is-hidden-interactive border-top margin-none">
			<footer
				id="footer"
				data-bi-name="footer"
				class="footer-layout uhf-container has-padding"
				role="contentinfo"
			>
				<ul class="links" data-bi-name="footerlinks">
					<li class="manage-cookies-holder" hidden></li>
					<li>
						<a data-mscc-ic="false" href="https://aka.ms/msftqafaq" data-bi-name="faq">
							${Ui}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="${r}/content/idea/post.html"
							data-bi-name="feedback"
						>
							${Fi}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="https://aka.ms/msftqacodeconduct"
							data-bi-name="codeofconduct"
						>
							${hi}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="${o}/${f.data.userLocale}/legal/termsofuse"
							data-bi-name="termsofuse"
						>
							${Vc}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="${o}/${f.data.userLocale}/teamblog/"
							data-bi-name="bloglink"
						>
							${jn}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/"
							data-bi-name="trademarks"
							title="${i}"
						>
							${bs} ${a}
						</a>
					</li>
					<li>
						<a
							data-mscc-ic="false"
							href="https://privacy.microsoft.com/en-US/privacystatement"
							data-bi-name="privacyandcookies"
							title="${l}"
						>
							${c} ${a}
						</a>
					</li>
					<li>&copy; Microsoft ${new Date().getFullYear()}</li>
				</ul>
			</footer>
		</section>
	`;U(d,s)}function Qd(){document.documentElement.classList.add("theme-light")}function Jd(){let o=document.querySelector(".header-holder"),e=document.createElement("a");e.classList.add("skip-to-main-link","visually-hidden-until-focused","position-fixed","has-inner-focus","focus-visible","top-0","left-0","right-0","padding-xs","has-text-centered","has-body-background"),e.setAttribute("tabindex","1"),e.href="#middle",e.textContent=Ic,o.appendChild(e),eh()}function eh(){let o=document.querySelector(".skip-navigation");o.parentNode&&o.parentNode.removeChild(o)}function Xd(){let o=document.querySelector(".ui-helper-hidden-accessible");o!==null&&o.removeAttribute("role")}function ep(){if(location.pathname.split("/")[1]==="articles"){let t=k.createElement("style");t.textContent="#navigation-custom-widget { display: none; }",k.head.appendChild(t)}}function tp(){Array.from(k.querySelectorAll(".idea-list-item .counts")).forEach(e=>{e.classList.add("col-sm-4"),e.classList.remove("col-sm-5"),e.classList.remove("col-lg-3")})}function op(){let o=pageContext.currentUser.username,e=k.createElement("style");k.head.appendChild(e),e.textContent=`
		.question-gravatar [href*="/${o}.html"] ~ .vote-widget .vote-up,
		.question-gravatar [href*="/${o}.html"] ~ .vote-widget .vote-down,
		.answer-gravatar [href*="/${o}.html"] ~ .vote-widget .vote-up,
		.answer-gravatar [href*="/${o}.html"] ~ .vote-widget .vote-down {
			display: none !important;
		}
	`}function np(){let o=k.getElementById("middle");Zd(),new MutationObserver(()=>{Zd()}).observe(o,{childList:!0,subtree:!0})}function Zd(){let o=pageContext.currentUser.id;Array.from(k.querySelectorAll(".comment-content")).forEach(t=>{t.parentElement.getAttribute("authorid").toLowerCase()===o&&Array.from(t.querySelectorAll(".comment-info a.make-tooltip")).forEach(s=>{s.classList.add("hidden")})})}function sp(){if(new URLSearchParams(location.search).has("enable-answer-hub-profile"))return;let o=Yr(location.href);if(o){rp(o,!1);return}addEventListener("click",e=>{let t=e.target,n=t.getAttribute("command")==="follow",r=t instanceof Element&&t.closest("a");if(!r||!r.href||n)return;let s=Yr(r.href);!s||(e.preventDefault(),e.stopPropagation(),rp(s,e.ctrlKey))},!0)}function rp(o,e=!1){let{username:t,subpage:n}=o,r;["anon-user","css-eng-api","azure-cxp-api"].indexOf(o.username)!==-1?r="https://aka.ms/msftqalocalaccounts":r=He(t,n==="preferences"?"settings":n),e?window.open(r,"_blank"):location.href=r}function Yr(o){o=o.toLowerCase().replace(/\.html$/i,"");let e=new URL(o),t=Kt(e.pathname).split("/");t=t.slice(2);let[n,r,s,a=null]=t;return n!=="users"||!/^\d+$/.test(r)||!s||s==="index"?null:{qnaId:r,username:s,subpage:a}}var Ca=async o=>{await ar;let e=document.querySelector("#user-menu > ul"),t=document.createElement("li");t.appendChild(o),e.appendChild(t)},ap=()=>{let o=document.querySelector('.dropdown-menu > li > a[href="/answers/articles/create.html"]'),e=document.getElementById("admin-link"),t=document.getElementById("moderation-link");o&&(o.textContent="Create Q&A Article",Ca(o)),e&&(e.textContent="Q&A Admin",Ca(e)),t&&(t.textContent=`Q&A ${t.textContent}`,Ca(t)),document.querySelector(".nav-links").classList.add("hidden")};function ip(){let o=createUserPopOver,e=createTopicPopOver,t=(n,r)=>{try{let s=$(n),a=s.get(0);if(!a)return;let i=a.href;i&&(s.children().first().wrap(function(){return'<a href="'+i+'" style="'+s.attr("style")+'"></a>'}),s.removeAttr("href style").attr("role","none"));let c=s.qtip("api"),l=c.options.events.render;c.set("events.render",async function(d,u){if(typeof l=="function"&&l(d,u),c.tooltip.attr("role","group"),i)if(c.tooltip.removeAttr("aria-describedby aria-live"),!r)c.tooltip.attr("aria-label",i.substring(i.lastIndexOf("/")+1,i.lastIndexOf(".")));else{let p=Yr(i);if(c.tooltip.attr("aria-label",p.username?p.username:p.qnaId),p&&p.username){let m=await B(Z(`${te.profile.profiles}/${p.username}`));if(m.ok){let g=await m.json();g&&g.isMvp?c.get("content.text").find(".stats-wrapper").prepend($("<div>").addClass("ms-affiliation user-isMvp").text(Oc).prepend($("<img>").attr("src","https://docs.microsoft.com/media/profile/mvp-status.svg"))):g&&g.isMicrosoftUser&&c.get("content.text").find(".stats-wrapper").prepend($("<div>").addClass("ms-affiliation user-isMicrosoftUser").text(Yi))}}}})}catch{}};createTopicPopOver=function(n){e(n),t(n,!1)},createUserPopOver=function(n){o(n),t(n,!0)}}function cp(){let o=Array.from(document.querySelectorAll('.post-tools .dropdown-menu button[command="reportPost"]'));if(!o.length)return;let e=new MutationObserver(t=>{for(let n of t)if(n.target instanceof HTMLButtonElement){let r=n.target,s=r.getAttribute("aria-label");s==="Cancel your report"&&(r.removeAttribute("aria-label"),r.innerText="Cancel Report"),s==="Report as offensive (i.e containing spam, advertising, malicious text, etc.)"&&(r.removeAttribute("aria-label"),r.innerText="Report")}});o.forEach(t=>{e.observe(t,{attributes:!0})})}function jr(o){let e=document.querySelector(o);return e?Array.from(e.querySelectorAll(Or.join(","))):""}function lp(){let o=Array.from(document.querySelectorAll('.post-tools > .dropdown-menu > li > button[role="menuitem"], div.post-controls > button.reply-link'));!o||o.forEach(e=>{e.onclick=()=>{let t=new MutationObserver(()=>{if(document.querySelector(".modal-open")){let n=e.getAttribute("command");n==="lockPost"?ya("lock"):n==="reportPost"&&ya("report");let r=jr(".modal-body"),s=jr(".modal-footer"),a=jr(".modal-header"),i=jr(".modal"),c=document.querySelector(".upload-box");r.length?(c&&c.focus(),r[0].focus()):s.length?s[0].focus():a.length?a[0].focus():i.length&&i[0].focus(),document.querySelector(".comment-form-container")||t.disconnect()}});t.observe(document.body,{childList:!0})}})}var th=2539,oh=50033,up=Ue?th:oh,dp="c82e7544-7b47-4a7d-ab78-7172cf408cc5";async function nh(o,e="fiveStar"){e==="binary"?o.rating=(o.rating-1)/4:o.rating/=5}async function pp(o,e="fiveStar"){if(o.rating===null||o.rating===void 0||isNaN(o.rating))throw new Error("No rating was selected by the user");nh(o,e);let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},n=Z(`${te.ocvFeedback}`,t),r=await B(n),s;if(r.ok)return s=await r.json(),s;throw new Error(`ocv api responded with ${r.status} ${r.statusText}`)}var Tt=function(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof self<"u")return self;if(typeof window<"u")return window;try{return new Function("return this")()}catch{return{}}}();Tt.trustedTypes===void 0&&(Tt.trustedTypes={createPolicy:(o,e)=>e});var mp={configurable:!1,enumerable:!1,writable:!1};Tt.FAST===void 0&&Reflect.defineProperty(Tt,"FAST",Object.assign({value:Object.create(null)},mp));var On=Tt.FAST;if(On.getById===void 0){let o=Object.create(null);Reflect.defineProperty(On,"getById",Object.assign({value(e,t){let n=o[e];return n===void 0&&(n=t?o[e]=t():null),n}},mp))}var Qr=Object.freeze([]);var Ea=Tt.FAST.getById(1,()=>{let o=[],e=[];function t(){if(e.length)throw e.shift()}function n(a){try{a.call()}catch(i){e.push(i),setTimeout(t,0)}}function r(){let i=0;for(;i<o.length;)if(n(o[i]),i++,i>1024){for(let c=0,l=o.length-i;c<l;c++)o[c]=o[c+i];o.length-=i,i=0}o.length=0}function s(a){o.length<1&&Tt.requestAnimationFrame(r),o.push(a)}return Object.freeze({enqueue:s,process:r})}),gp=Tt.trustedTypes.createPolicy("fast-html",{createHTML:o=>o}),ka=gp,Un=`fast-${Math.random().toString(36).substring(2,8)}`,Aa=`${Un}{`,Jr=`}${Un}`,ge=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(o){if(ka!==gp)throw new Error("The HTML policy can only be set once.");ka=o},createHTML(o){return ka.createHTML(o)},isMarker(o){return o&&o.nodeType===8&&o.data.startsWith(Un)},extractDirectiveIndexFromMarker(o){return parseInt(o.data.replace(`${Un}:`,""))},createInterpolationPlaceholder(o){return`${Aa}${o}${Jr}`},createCustomAttributePlaceholder(o,e){return`${o}="${this.createInterpolationPlaceholder(e)}"`},createBlockPlaceholder(o){return`<!--${Un}:${o}-->`},queueUpdate:Ea.enqueue,processUpdates:Ea.process,nextUpdate(){return new Promise(Ea.enqueue)},setAttribute(o,e,t){t==null?o.removeAttribute(e):o.setAttribute(e,t)},setBooleanAttribute(o,e,t){t?o.setAttribute(e,""):o.removeAttribute(e)},removeChildNodes(o){for(let e=o.firstChild;e!==null;e=o.firstChild)o.removeChild(e)},createTemplateWalker(o){return document.createTreeWalker(o,133,null,!1)}});function rh(o){let e=this.spillover;e.indexOf(o)===-1&&e.push(o)}function sh(o){let e=this.spillover,t=e.indexOf(o);t!==-1&&e.splice(t,1)}function ah(o){let e=this.spillover,t=this.source;for(let n=0,r=e.length;n<r;++n)e[n].handleChange(t,o)}function ih(o){return this.spillover.indexOf(o)!==-1}var xo=class{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return this.sub1===e||this.sub2===e}subscribe(e){if(!this.has(e)){if(this.sub1===void 0){this.sub1=e;return}if(this.sub2===void 0){this.sub2=e;return}this.spillover=[this.sub1,this.sub2,e],this.subscribe=rh,this.unsubscribe=sh,this.notify=ah,this.has=ih,this.sub1=void 0,this.sub2=void 0}}unsubscribe(e){this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0)}notify(e){let t=this.sub1,n=this.sub2,r=this.source;t!==void 0&&t.handleChange(r,e),n!==void 0&&n.handleChange(r,e)}},Ia=class{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;let n=this.subscribers[e];n!==void 0&&n.notify(e),(t=this.sourceSubscribers)===null||t===void 0||t.notify(e)}subscribe(e,t){var n;if(t){let r=this.subscribers[t];r===void 0&&(this.subscribers[t]=r=new xo(this.source)),r.subscribe(e)}else this.sourceSubscribers=(n=this.sourceSubscribers)!==null&&n!==void 0?n:new xo(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var n;if(t){let r=this.subscribers[t];r!==void 0&&r.unsubscribe(e)}else(n=this.sourceSubscribers)===null||n===void 0||n.unsubscribe(e)}};var Pe=On.getById(2,()=>{let o=/(:|&&|\|\||if)/,e=new WeakMap,t=new WeakMap,n=ge.queueUpdate,r,s=d=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function a(d){let u=d.$fastController||e.get(d);return u===void 0&&(Array.isArray(d)?u=s(d):e.set(d,u=new Ia(d))),u}function i(d){let u=t.get(d);if(u===void 0){let p=Reflect.getPrototypeOf(d);for(;u===void 0&&p!==null;)u=t.get(p),p=Reflect.getPrototypeOf(p);u===void 0?u=[]:u=u.slice(0),t.set(d,u)}return u}class c{constructor(u){this.name=u,this.field=`_${u}`,this.callback=`${u}Changed`}getValue(u){return r!==void 0&&r.watch(u,this.name),u[this.field]}setValue(u,p){let m=this.field,g=u[m];if(g!==p){u[m]=p;let y=u[this.callback];typeof y=="function"&&y.call(u,g,p),a(u).notify(this.name)}}}class l extends xo{constructor(u,p,m=!1){super(u,p);this.binding=u,this.isVolatileBinding=m,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(u,p){this.needsRefresh&&this.last!==null&&this.disconnect();let m=r;r=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;let g=this.binding(u,p);return r=m,g}disconnect(){if(this.last!==null){let u=this.first;for(;u!==void 0;)u.notifier.unsubscribe(this,u.propertyName),u=u.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(u,p){let m=this.last,g=a(u),y=m===null?this.first:{};if(y.propertySource=u,y.propertyName=p,y.notifier=g,g.subscribe(this,p),m!==null){if(!this.needsRefresh){let E;r=void 0,E=m.propertySource[m.propertyName],r=this,u===E&&(this.needsRefresh=!0)}m.next=y}this.last=y}handleChange(){this.needsQueue&&(this.needsQueue=!1,n(this))}call(){this.last!==null&&(this.needsQueue=!0,this.notify(this))}records(){let u=this.first;return{next:()=>{let p=u;return p===void 0?{value:void 0,done:!0}:(u=u.next,{value:p,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(d){s=d},getNotifier:a,track(d,u){r!==void 0&&r.watch(d,u)},trackVolatile(){r!==void 0&&(r.needsRefresh=!0)},notify(d,u){a(d).notify(u)},defineProperty(d,u){typeof u=="string"&&(u=new c(u)),i(d).push(u),Reflect.defineProperty(d,u.name,{enumerable:!0,get:function(){return u.getValue(this)},set:function(p){u.setValue(this,p)}})},getAccessors:i,binding(d,u,p=this.isVolatileBinding(d)){return new l(d,u,p)},isVolatileBinding(d){return o.test(d.toString())}})});function Fn(o,e){Pe.defineProperty(o,e)}var fp=On.getById(3,()=>{let o=null;return{get(){return o},set(e){o=e}}}),bo=class{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return fp.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return this.index===0}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){fp.set(e)}};Pe.defineProperty(bo.prototype,"index");Pe.defineProperty(bo.prototype,"length");var hp=Object.seal(new bo);var tn=class{constructor(){this.targetIndex=0}},Hn=class extends tn{constructor(){super(...arguments);this.createPlaceholder=ge.createInterpolationPlaceholder}};function ch(o,e){this.source=o,this.context=e,this.bindingObserver===null&&(this.bindingObserver=Pe.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(o,e))}function lh(o,e){this.source=o,this.context=e,this.target.addEventListener(this.targetName,this)}function uh(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function dh(){this.bindingObserver.disconnect(),this.source=null,this.context=null;let o=this.target.$fastView;o!==void 0&&o.isComposed&&(o.unbind(),o.needsBindOnly=!0)}function ph(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function mh(o){ge.setAttribute(this.target,this.targetName,o)}function gh(o){ge.setBooleanAttribute(this.target,this.targetName,o)}function fh(o){if(o==null&&(o=""),o.create){this.target.textContent="";let e=this.target.$fastView;e===void 0?e=o.create():this.target.$fastTemplate!==o&&(e.isComposed&&(e.remove(),e.unbind()),e=o.create()),e.isComposed?e.needsBindOnly&&(e.needsBindOnly=!1,e.bind(this.source,this.context)):(e.isComposed=!0,e.bind(this.source,this.context),e.insertBefore(this.target),this.target.$fastView=e,this.target.$fastTemplate=o)}else{let e=this.target.$fastView;e!==void 0&&e.isComposed&&(e.isComposed=!1,e.remove(),e.needsBindOnly?e.needsBindOnly=!1:e.unbind()),this.target.textContent=o}}function hh(o){this.target[this.targetName]=o}function _h(o){let e=this.classVersions||Object.create(null),t=this.target,n=this.version||0;if(o!=null&&o.length){let r=o.split(/\s+/);for(let s=0,a=r.length;s<a;++s){let i=r[s];i!==""&&(e[i]=n,t.classList.add(i))}}if(this.classVersions=e,this.version=n+1,n!==0){n-=1;for(let r in e)e[r]===n&&t.classList.remove(r)}}var on=class extends Hn{constructor(e){super();this.binding=e,this.bind=ch,this.unbind=uh,this.updateTarget=mh,this.isBindingVolatile=Pe.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,e!==void 0)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=hh,this.cleanedTargetName==="innerHTML"){let t=this.binding;this.binding=(n,r)=>ge.createHTML(t(n,r))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=gh;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=lh,this.unbind=ph;break;default:this.cleanedTargetName=e,e==="class"&&(this.updateTarget=_h);break}}targetAtContent(){this.updateTarget=fh,this.unbind=dh}createBehavior(e){return new _p(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}},_p=class{constructor(e,t,n,r,s,a,i){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=n,this.bind=r,this.unbind=s,this.updateTarget=a,this.targetName=i}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){bo.setEvent(e);let t=this.binding(this.source,this.context);bo.setEvent(null),t!==!0&&e.preventDefault()}};var Ra=null,Xr=class{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){Ra=this}static borrow(e){let t=Ra||new Xr;return t.directives=e,t.reset(),Ra=null,t}};function xh(o){if(o.length===1)return o[0];let e,t=o.length,n=o.map(a=>typeof a=="string"?()=>a:(e=a.targetName||e,a.binding)),r=(a,i)=>{let c="";for(let l=0;l<t;++l)c+=n[l](a,i);return c},s=new on(r);return s.targetName=e,s}var bh=Jr.length;function bp(o,e){let t=e.split(Aa);if(t.length===1)return null;let n=[];for(let r=0,s=t.length;r<s;++r){let a=t[r],i=a.indexOf(Jr),c;if(i===-1)c=a;else{let l=parseInt(a.substring(0,i));n.push(o.directives[l]),c=a.substring(i+bh)}c!==""&&n.push(c)}return n}function xp(o,e,t=!1){let n=e.attributes;for(let r=0,s=n.length;r<s;++r){let a=n[r],i=a.value,c=bp(o,i),l=null;c===null?t&&(l=new on(()=>i),l.targetName=a.name):l=xh(c),l!==null&&(e.removeAttributeNode(a),r--,s--,o.addFactory(l))}}function vh(o,e,t){let n=bp(o,e.textContent);if(n!==null){let r=e;for(let s=0,a=n.length;s<a;++s){let i=n[s],c=s===0?e:r.parentNode.insertBefore(document.createTextNode(""),r.nextSibling);typeof i=="string"?c.textContent=i:(c.textContent=" ",o.captureContentBinding(i)),r=c,o.targetIndex++,c!==e&&t.nextNode()}o.targetIndex--}}function vp(o,e){let t=o.content;document.adoptNode(t);let n=Xr.borrow(e);xp(n,o,!0);let r=n.behaviorFactories;n.reset();let s=ge.createTemplateWalker(t),a;for(;a=s.nextNode();)switch(n.targetIndex++,a.nodeType){case 1:xp(n,a);break;case 3:vh(n,a,s);break;case 8:ge.isMarker(a)&&n.addFactory(e[ge.extractDirectiveIndexFromMarker(a)])}let i=0;(ge.isMarker(t.firstChild)||t.childNodes.length===1&&e.length)&&(t.insertBefore(document.createComment(""),t.firstChild),i=-1);let c=n.behaviorFactories;return n.release(),{fragment:t,viewBehaviorFactories:c,hostBehaviorFactories:r,targetOffset:i}}var Pa=document.createRange(),qn=class{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{let t=e.parentNode,n=this.lastChild,r=this.firstChild,s;for(;r!==n;)s=r.nextSibling,t.insertBefore(r,e),r=s;t.insertBefore(n,e)}}remove(){let e=this.fragment,t=this.lastChild,n=this.firstChild,r;for(;n!==t;)r=n.nextSibling,e.appendChild(n),n=r;e.appendChild(t)}dispose(){let e=this.firstChild.parentNode,t=this.lastChild,n=this.firstChild,r;for(;n!==t;)r=n.nextSibling,e.removeChild(n),n=r;e.removeChild(t);let s=this.behaviors,a=this.source;for(let i=0,c=s.length;i<c;++i)s[i].unbind(a)}bind(e,t){let n=this.behaviors;if(this.source!==e)if(this.source!==null){let r=this.source;this.source=e,this.context=t;for(let s=0,a=n.length;s<a;++s){let i=n[s];i.unbind(r),i.bind(e,t)}}else{this.source=e,this.context=t;for(let r=0,s=n.length;r<s;++r)n[r].bind(e,t)}}unbind(){if(this.source===null)return;let e=this.behaviors,t=this.source;for(let n=0,r=e.length;n<r;++n)e[n].unbind(t);this.source=null}static disposeContiguousBatch(e){if(e.length!==0){Pa.setStartBefore(e[0].firstChild),Pa.setEndAfter(e[e.length-1].lastChild),Pa.deleteContents();for(let t=0,n=e.length;t<n;++t){let r=e[t],s=r.behaviors,a=r.source;for(let i=0,c=s.length;i<c;++i)s[i].unbind(a)}}}};var La=class{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(this.fragment===null){let l,d=this.html;if(typeof d=="string"){l=document.createElement("template"),l.innerHTML=ge.createHTML(d);let p=l.content.firstElementChild;p!==null&&p.tagName==="TEMPLATE"&&(l=p)}else l=d;let u=vp(l,this.directives);this.fragment=u.fragment,this.viewBehaviorFactories=u.viewBehaviorFactories,this.hostBehaviorFactories=u.hostBehaviorFactories,this.targetOffset=u.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}let t=this.fragment.cloneNode(!0),n=this.viewBehaviorFactories,r=new Array(this.behaviorCount),s=ge.createTemplateWalker(t),a=0,i=this.targetOffset,c=s.nextNode();for(let l=n.length;a<l;++a){let d=n[a],u=d.targetIndex;for(;c!==null;)if(i===u){r[a]=d.createBehavior(c);break}else c=s.nextNode(),i++}if(this.hasHostBehaviors){let l=this.hostBehaviorFactories;for(let d=0,u=l.length;d<u;++d,++a)r[a]=l[d].createBehavior(e)}return new qn(t,r)}render(e,t,n){typeof t=="string"&&(t=document.getElementById(t)),n===void 0&&(n=t);let r=this.create(n);return r.bind(e,hp),r.appendTo(t),r}},yh=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function vo(o,...e){let t=[],n="";for(let r=0,s=o.length-1;r<s;++r){let a=o[r],i=e[r];if(n+=a,i instanceof La){let c=i;i=()=>c}if(typeof i=="function"&&(i=new on(i)),i instanceof Hn){let c=yh.exec(a);c!==null&&(i.targetName=c[2])}i instanceof tn?(n+=i.createPlaceholder(t.length),t.push(i)):n+=i}return n+=o[o.length-1],new La(n,t)}function Ye(o,e,t){return{index:o,removed:e,addedCount:t}}var Tp=0,Sp=1,Ma=2,Na=3;function Th(o,e,t,n,r,s){let a=s-r+1,i=t-e+1,c=new Array(a),l,d;for(let u=0;u<a;++u)c[u]=new Array(i),c[u][0]=u;for(let u=0;u<i;++u)c[0][u]=u;for(let u=1;u<a;++u)for(let p=1;p<i;++p)o[e+p-1]===n[r+u-1]?c[u][p]=c[u-1][p-1]:(l=c[u-1][p]+1,d=c[u][p-1]+1,c[u][p]=l<d?l:d);return c}function Sh(o){let e=o.length-1,t=o[0].length-1,n=o[e][t],r=[];for(;e>0||t>0;){if(e===0){r.push(Ma),t--;continue}if(t===0){r.push(Na),e--;continue}let s=o[e-1][t-1],a=o[e-1][t],i=o[e][t-1],c;a<i?c=a<s?a:s:c=i<s?i:s,c===s?(s===n?r.push(Tp):(r.push(Sp),n=s),e--,t--):c===a?(r.push(Na),e--,n=a):(r.push(Ma),t--,n=i)}return r.reverse(),r}function wh(o,e,t){for(let n=0;n<t;++n)if(o[n]!==e[n])return n;return t}function Ch(o,e,t){let n=o.length,r=e.length,s=0;for(;s<t&&o[--n]===e[--r];)s++;return s}function Eh(o,e,t,n){return e<t||n<o?-1:e===t||n===o?0:o<t?e<n?e-t:n-t:n<e?n-o:e-o}function za(o,e,t,n,r,s){let a=0,i=0,c=Math.min(t-e,s-r);if(e===0&&r===0&&(a=wh(o,n,c)),t===o.length&&s===n.length&&(i=Ch(o,n,c-a)),e+=a,r+=a,t-=i,s-=i,t-e===0&&s-r===0)return Qr;if(e===t){let g=Ye(e,[],0);for(;r<s;)g.removed.push(n[r++]);return[g]}else if(r===s)return[Ye(e,[],t-e)];let l=Sh(Th(o,e,t,n,r,s)),d=[],u,p=e,m=r;for(let g=0;g<l.length;++g)switch(l[g]){case Tp:u!==void 0&&(d.push(u),u=void 0),p++,m++;break;case Sp:u===void 0&&(u=Ye(p,[],0)),u.addedCount++,p++,u.removed.push(n[m]),m++;break;case Ma:u===void 0&&(u=Ye(p,[],0)),u.addedCount++,p++;break;case Na:u===void 0&&(u=Ye(p,[],0)),u.removed.push(n[m]),m++;break}return u!==void 0&&d.push(u),d}var yp=Array.prototype.push;function kh(o,e,t,n){let r=Ye(e,t,n),s=!1,a=0;for(let i=0;i<o.length;i++){let c=o[i];if(c.index+=a,s)continue;let l=Eh(r.index,r.index+r.removed.length,c.index,c.index+c.addedCount);if(l>=0){o.splice(i,1),i--,a-=c.addedCount-c.removed.length,r.addedCount+=c.addedCount-l;let d=r.removed.length+c.removed.length-l;if(!r.addedCount&&!d)s=!0;else{let u=c.removed;if(r.index<c.index){let p=r.removed.slice(0,c.index-r.index);yp.apply(p,u),u=p}if(r.index+r.removed.length>c.index+c.addedCount){let p=r.removed.slice(c.index+c.addedCount-r.index);yp.apply(u,p)}r.removed=u,c.index<r.index&&(r.index=c.index)}}else if(r.index<c.index){s=!0,o.splice(i,0,r),i++;let d=r.addedCount-r.removed.length;c.index+=d,a+=d}}s||o.push(r)}function Ah(o){let e=[];for(let t=0,n=o.length;t<n;t++){let r=o[t];kh(e,r.index,r.removed,r.addedCount)}return e}function wp(o,e){let t=[],n=Ah(e);for(let r=0,s=n.length;r<s;++r){let a=n[r];if(a.addedCount===1&&a.removed.length===1){a.removed[0]!==o[a.index]&&t.push(a);continue}t=t.concat(za(o,a.index,a.index+a.addedCount,a.removed,0,a.removed.length))}return t}var Cp=!1;function Da(o,e){let t=o.index,n=e.length;return t>n?t=n-o.addedCount:t<0&&(t=n+o.removed.length+t-o.addedCount),t<0&&(t=0),o.index=t,o}var Ep=class extends xo{constructor(e){super(e);this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,ge.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,ge.queueUpdate(this))}flush(){let e=this.splices,t=this.oldCollection;if(e===void 0&&t===void 0)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;let n=t===void 0?wp(this.source,e):za(this.source,0,this.source.length,t,0,t.length);this.notify(n)}};function kp(){if(Cp)return;Cp=!0,Pe.setArrayObserverFactory(c=>new Ep(c));let o=Array.prototype;if(o.$fastPatch)return;Reflect.defineProperty(o,"$fastPatch",{value:1,enumerable:!1});let e=o.pop,t=o.push,n=o.reverse,r=o.shift,s=o.sort,a=o.splice,i=o.unshift;o.pop=function(){let c=this.length>0,l=e.apply(this,arguments),d=this.$fastController;return d!==void 0&&c&&d.addSplice(Ye(this.length,[l],0)),l},o.push=function(){let c=t.apply(this,arguments),l=this.$fastController;return l!==void 0&&l.addSplice(Da(Ye(this.length-arguments.length,[],arguments.length),this)),c},o.reverse=function(){let c,l=this.$fastController;l!==void 0&&(l.flush(),c=this.slice());let d=n.apply(this,arguments);return l!==void 0&&l.reset(c),d},o.shift=function(){let c=this.length>0,l=r.apply(this,arguments),d=this.$fastController;return d!==void 0&&c&&d.addSplice(Ye(0,[l],0)),l},o.sort=function(){let c,l=this.$fastController;l!==void 0&&(l.flush(),c=this.slice());let d=s.apply(this,arguments);return l!==void 0&&l.reset(c),d},o.splice=function(){let c=a.apply(this,arguments),l=this.$fastController;return l!==void 0&&l.addSplice(Da(Ye(+arguments[0],c,arguments.length>2?arguments.length-2:0),this)),c},o.unshift=function(){let c=i.apply(this,arguments),l=this.$fastController;return l!==void 0&&l.addSplice(Da(Ye(0,[],arguments.length),this)),c}}function Oa(o,e){let t=typeof e=="function"?e:()=>e;return(n,r)=>o(n,r)?t(n,r):null}var Ih=Object.freeze({positioning:!1,recycle:!0});function Rh(o,e,t,n){o.bind(e[t],n)}function Ph(o,e,t,n){let r=Object.create(n);r.index=t,r.length=e.length,o.bind(e[t],r)}var Ap=class{constructor(e,t,n,r,s,a){this.location=e,this.itemsBinding=t,this.templateBinding=r,this.options=a,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=Rh,this.itemsBindingObserver=Pe.binding(t,this,n),this.templateBindingObserver=Pe.binding(r,this,s),a.positioning&&(this.bindView=Ph)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=Qr;return}let t=this.itemsObserver,n=this.itemsObserver=Pe.getNotifier(this.items),r=t!==n;r&&t!==null&&t.unsubscribe(this),(r||e)&&n.subscribe(this)}updateViews(e){let t=this.childContext,n=this.views,r=[],s=this.bindView,a=0;for(let l=0,d=e.length;l<d;++l){let u=e[l],p=u.removed;r.push(...n.splice(u.index+a,p.length)),a-=u.addedCount}let i=this.items,c=this.template;for(let l=0,d=e.length;l<d;++l){let u=e[l],p=u.index,m=p+u.addedCount;for(;p<m;++p){let g=n[p],y=g?g.firstChild:this.location,E=this.options.recycle&&r.length>0?r.shift():c.create();n.splice(p,0,E),s(E,i,p,t),E.insertBefore(y)}}for(let l=0,d=r.length;l<d;++l)r[l].dispose();if(this.options.positioning)for(let l=0,d=n.length;l<d;++l){let u=n[l].context;u.length=d,u.index=l}}refreshAllViews(e=!1){let t=this.items,n=this.childContext,r=this.template,s=this.location,a=this.bindView,i=t.length,c=this.views,l=c.length;if((i===0||e)&&(qn.disposeContiguousBatch(c),l=0),l===0){this.views=c=new Array(i);for(let d=0;d<i;++d){let u=r.create();a(u,t,d,n),c[d]=u,u.insertBefore(s)}}else{let d=0;for(;d<i;++d)if(d<l){let p=c[d];a(p,t,d,n)}else{let p=r.create();a(p,t,d,n),c.push(p),p.insertBefore(s)}let u=c.splice(d,l-d);for(d=0,i=u.length;d<i;++d)u[d].dispose()}}unbindAllViews(){let e=this.views;for(let t=0,n=e.length;t<n;++t)e[t].unbind()}},Ip=class extends tn{constructor(e,t,n){super();this.itemsBinding=e,this.templateBinding=t,this.options=n,this.createPlaceholder=ge.createBlockPlaceholder,kp(),this.isItemsBindingVolatile=Pe.isVolatileBinding(e),this.isTemplateBindingVolatile=Pe.isVolatileBinding(t)}createBehavior(e){return new Ap(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}};function Rp(o,e,t=Ih){let n=typeof e=="function"?e:()=>e;return new Ip(o,n,t)}var Lh=(o,e=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/)=>{if(o.match(e))return o;throw new Error("The ids to map have invalid characters. Please confirm the ids conform to permitted Javascript variable name characters")},Mh=(o,e)=>e.reduce((t,n)=>({...t,[n]:o+Lh(n)}),{}),Nh=({starCount:o=5,idsToMap:e=["input","tooltip"],tooltipTexts:t=[ac,ic,cc,lc,uc],componentId:n=st()}={})=>Array.from(Array(o),(r,s)=>({value:s+1,idMap:Mh(`ax-${n+(s+1).toString()}-`,e),tooltipText:t[s]})),zh=(o,e)=>Nh({componentId:o,starCount:e}),Dh=vo`
	<div class="rating-template display-flex flex-wrap-wrap margin-bottom-xs">
		<span class="font-weight-semibold">${rc}</span>
		<fieldset class="star-rating-control">
			<span class="star-layout">
				<span class="font-size-h5 star-collection">
					${Rp(o=>zh(o.componentId,o.starCount),vo` <input
								id="${o=>o.idMap.input}"
								@click=${(o,e)=>e.parent.onRatingChange(e.event)}
								:value="${o=>o.value}"
								type="radio"
								class="visually-hidden ${(o,e)=>e.parent.rating>=o.value?"is-selected":""}"
								?checked="${(o,e)=>e.parent.rating>=o.value}"
								aria-checked="${(o,e)=>e.parent.rating>=o.value}"
							/>
							<label
								for="${o=>o.idMap.input}"
								title="${o=>o.tooltipText}"
								aria-describedby="${o=>o.idMap.tooltip}"
							>
								<span class="visually-hidden" role="tooltip" id="${o=>o.idMap.tooltip}"
									>${o=>o.tooltipText}</span
								>
								<span aria-hidden="true" class="docon rating-star has-text-primary"></span>
							</label>`)}
				</span>
			</span>
		</fieldset>
	</div>
`,Pp=o=>`ax-${o.componentId}-feedback-comment`,Oh=vo`
	${()=>Dh}
	<div class="comment-template" style="display:${o=>o.display};">
		<div class="font-weight-semibold margin-bottom-xs">${oc}</div>
		<div class="display-flex justify-content-space-between flex-wrap-wrap">
			<label for="${o=>Pp(o)}">
				<span class="visually-hidden">${Hi}</span>
			</label>
			<div class="control flex-grow-1 margin-right-xs margin-bottom-xs margin-bottom-xxs-tablet">
				<input
					id="${o=>Pp(o)}"
					class="input is-primary"
					name="comment"
					:value=${o=>o.comment}
					@input=${(o,e)=>o.onCommentInput(e.event)}
				/>
			</div>
			<div class="field is-grouped">
				<button
					class="button button-primary button-filled margin-right-xs margin-right-xxs-tablet"
					type="submit"
				>
					${Zn}
				</button>
				<button class="button" type="reset">${Oi}</button>
			</div>
		</div>
		<div class="font-size-xs has-text-tertiary">${nc}</div>
	</div>
`,Uh=vo`<div class="submitted-template">
	${sc}
</div>`,Lp=vo`
	${Oa(o=>o.state==="not-rated",Oh)}
	${Oa(o=>o.state==="rating-submitted",Uh)}
`,Fh=(o,e=document.createElement("div"))=>{if(o.render({},e),e.querySelector("form")!==null)throw new Error("The template configured is invalid. Please confirm that the template has no form element.");return o},Mp=o=>vo`
	<form @submit=${(e,t)=>e.onFormSubmit(t.event)} @reset=${(e,t)=>e.onFormDismiss(t.event)}>
		${Fh(o)}
	</form>
`;var yo=class{constructor({appId:e,submit:t,componentId:n}){this.rating=0;this.state="not-rated";this.comment="";this.display="none";this.starCount=5;this.appId=e,this.submit=t,this.componentId=n}onRatingChange(e){!e.target||(this.rating=parseInt(e.target.value),this.display="block")}onCommentInput(e){!e.target||(this.comment=e.target.value)}onFormSubmit(e){e.preventDefault(),this.submit&&(this.submit(this),this.comment="",this.state="rating-submitted")}onFormDismiss(e){e.preventDefault(),this.rating=0,this.comment="",this.state="not-rated"}};sn([Fn],yo.prototype,"rating",2),sn([Fn],yo.prototype,"state",2),sn([Fn],yo.prototype,"comment",2),sn([Fn],yo.prototype,"display",2);function Np({appId:o,container:e,template:t,submit:n,componentId:r}){let s=new yo({appId:o,submit:n,componentId:r});Mp(t).render(s,e)}var zp=({appId:o,rating:e,comment:t,componentId:n})=>{pp({manifestType:"Psat",appId:o,submitTime:new Date().toISOString(),source:"Client",type:"Survey",application:{appData:JSON.stringify({answerId:n})},telemetry:{loggableUserId:M.credentialId,tenantId:M.tenantId,featureArea:"Q&A"},clientFeedbackId:zn(),survey:{surveyId:dp},rating:e,comment:t,web:{sourcePageURI:J.origin+J.pathname}})};function Dp(){if(!ce.inlineFeedback||!M||!vl())return;let o=k.querySelector(".question-container .question .user.og-poster-author>a>span");if(!o||o.innerText!==M.userName)return;let e=k.querySelectorAll(".answer-list .answer-container");if(e.length===0)return;let t={appId:up,template:Lp,submit:zp};e.forEach(n=>{let r=n.querySelector(".answer"),s=n.getAttribute("nodeid"),a=k.createElement("div");a.classList.add("margin-top-xxs"),r.appendChild(a),t.container=a,t.componentId=s,Np(t)})}var Ua="autocomplete-change-event",Hh="autocomplete-displayed-event";function Zr(o){o.input.placeholder=o.input.placeholder||"",o.input.type=o.input.type||"text",o.input.required=o.input.required||!1;let{getSuggestions:e,getTitle:t=W=>W.toString(),itemTemplate:n=t,noResultsTemplate:r=null,initialValue:s=null,input:{biName:a}}=o,i=document.createElement("div");i.classList.add("autocomplete"),o.input.isFullWidth&&i.classList.add("display-block"),i.setAttribute("data-bi-name","autocomplete");let c=st(),l=`${c}-listbox`,d=W=>W===-1?"":`${c}-option-${W}`,u=[],p=-1,m=s?t(s):"",g="",y=s,E=0,I=!1,N=!1,w=!1,ke="";o.input.size&&(ke=o.input.size==="small"?"input-sm":"input-lg");let gt=()=>{let W=i.querySelector(`#${l}`),ae=W.children.item(p===-1?0:p);ae?ae.offsetTop+ae.offsetHeight>W.offsetHeight?W.scrollTop=ae.offsetTop-W.offsetHeight+ae.offsetHeight+4:ae.offsetTop<W.scrollTop&&(W.scrollTop=ae.offsetTop):W.scrollTop=0},Co=()=>{U(Fm(),i),i.querySelector("input").value=m||g,gt()},cs=()=>{w=!1,u=[],p=-1,Co()},Kn=(W,ae)=>{let Eo=g;if(y=W,m=W?t(W):"",g=m,cs(),ae){let St=new CustomEvent(Ua,{detail:{suggestion:W,term:Eo},bubbles:!0});i.dispatchEvent(St)}};Object.defineProperty(i,"value",{get(){return y},set(W){Kn(W,!1)}});let Za=async()=>{if(g===""){I=!1,y=null,cs();return}u=await e(g);let W=new CustomEvent(Hh,{detail:u,bubbles:!0});i.dispatchEvent(W),w=!u.length,p=-1,I=!1,Co()},Lm=W=>{let ae=W.url;window.open(ae.href,"_blank")},Mm=W=>{let ae=W.target instanceof Element&&W.target.closest('[role="option"]');if(!ae)return;W.preventDefault();let Eo=ae.parentElement,St=0;for(;St<Eo.childElementCount&&Eo.children.item(St)!==ae;St++);let Wn=u[St];if(W.ctrlKey&&W.target instanceof Element&&W.target.closest("[data-href]")){Lm(Wn);return}Kn(Wn,!0)},Nm=async W=>{clearTimeout(E),E=setTimeout(Za,250);let ae=W.target;g=ae.value,m="",!I&&ae.value!==""&&!N&&(I=!0,Co())},zm=()=>{N=!0},Dm=()=>{N=!1},Om=()=>cs(),Um=({keyCode:W,shiftKey:ae,altKey:Eo,ctrlKey:St})=>{if(!(ae||Eo||St)){if(W===at.down){event.preventDefault(),p<u.length-1?(p++,m=t(u[p])):(p=-1,m=g),Co();return}if(W===at.up){if(event.preventDefault(),!u.length)return;p===-1?(p=u.length-1,m=t(u[p])):p>0?(p--,m=t(u[p])):(p=-1,m=g),Co();return}if(W===at.escape){event.preventDefault(),Kn(y,!1);return}if(W===at.enter){if(p>=0){let Wn=u[p];Kn(Wn,!0)}return}}};function Fm(){return h`
			<div
				class="control ${o.input.docon?`has-icons-${o.input.doconOrientation||"left"}`:""}"
			>
				<input
					id="${o.input.id}"
					class="autocomplete-input input ${ke}
						${o.input.docon?`control has-icons-${o.input.doconOrientation||"left"}`:""}
						${o.input.isFullWidth?"width-full":""}"
					type="${o.input.type}"
					name=${Jo(o.input.name)}
					role="combobox"
					maxlength="100"
					@input=${Nm}
					@blur=${Om}
					@focus=${Za}
					@keydown=${Um}
					aria-autocomplete="list"
					aria-expanded="${u.length?"true":"false"}"
					aria-owns="${l}"
					aria-controls="${l}"
					aria-activedescendant="${d(p)}"
					aria-label="${Jo(o.input.label)}"
					placeholder="${o.input.placeholder}"
					autocapitalize="off"
					autocomplete="off"
					autocorrect="off"
					spellcheck="false"
					data-bi-name="${Jo(a)}"
					?required=${o.input.required}
					pattern=${o.input.required?"(?!^\\s+$)^.*$":".*"}
				/>

				<span
					class="icon is-small is-${o.input.doconOrientation||"left"}"
					?hidden=${!o.input.docon||I&&o.input.doconOrientation==="right"}
					aria-hidden="true"
				>
					<span
						class="${o.input.doconClasses||"has-text-primary"} docon docon-${o.input.docon}"
					></span>
				</span>

				<span
					class="autocomplete-loader loader has-text-primary ${o.input.size==="large"?"is-large":""}"
					?hidden=${!I}
					aria-hidden="true"
				></span>
			</div>

			<ul
				id="${l}"
				class="autocomplete-suggestions is-vertically-scrollable"
				role="listbox"
				aria-label="${o.input.id}-suggestions"
				@mousedown=${W=>W.preventDefault()}
				@click=${Mm}
				?hidden=${!g.length||!w&&!u.length}
			>
				${u.map((W,ae)=>h` <li
						id="${d(ae)}"
						role="option"
						aria-selected=${ae===p}
						class="autocomplete-suggestion ${ae===p?"is-active-descendant":""}"
					>
						${n(W)}
					</li>`)}
				${w&&r?h`<li role="alert">${r}</li>`:""}
			</ul>
		`}return Co(),i.addEventListener("compositionstart",zm),i.addEventListener("compositionend",Dm),i}var es=(()=>{let o;return e=>{if(!e&&o!==void 0)return o;let t=Je().dataSource;return o=O("is_archived")==="true"||f.data.pageTemplate==="SearchPage"&&t==="previousVersions",o}})();var ts="display-block font-size-sm padding-inline-xxs";var Fa=`/${f.data.userLocale}`,os=o=>`${Fa}/answers/search.html?c=&includeChildren=&f=&type=question+OR+idea+OR+kbentry+OR+answer+OR+topic+OR+user&redirect=search%2Fsearch&sort=relevance&q=${encodeURIComponent(o)}`,qh=async o=>{let e={acceptedAnswer:!1,answerCount:0,icon:"",title:o,type:"header",upVotesCount:0,url:os(o)},t={...e,title:Cc,type:"help",url:`${Fa}/answers/search/advanced-search-usage.html`},n=[e,{...e,type:"",title:ec,url:`${Fa}/answers/search`},t];if(o=o.trim(),o.length<wa)return[];let r=await Kr(o,"object");return en(Wr(r)),r.length?[e,...r,t]:n},Op="display-block font-size-sm padding-xxs has-text-color",Bh=o=>{let{title:e,type:t,icon:n,sourceTitle:r}=o,s=r?h`${r}: ${e}
				<span class="icon">
					<span class="docon docon-navigate-external xs-hidden"></span>
				</span> `:`${e}`;switch(t){case"header":return h`
				<span class="${Op} border-bottom"> ${lt}: ${e} </span>
			`;case"help":return h`
				<span class="${Op} border-top">
					<span class="has-text-primary">${e}</span>
				</span>
			`;default:return h`
				<span class="${ts} has-overflow-ellipsis has-text-primary">
					<span class="icon">
						<span class="docon ${n} xs-hidden" aria-hidden="true"></span>
					</span>
					${s}
				</span>
			`}},Up=o=>{let e=Je().q||"",t={acceptedAnswer:!1,answerCount:0,title:e,type:"header",upVotesCount:0,url:os(e)},n=Zr({input:{id:o,name:"q",placeholder:qi,type:"search",docon:"search",isFullWidth:!0,label:lt},getSuggestions:qh,getTitle:r=>r.title,itemTemplate:Bh,initialValue:t});return n.addEventListener(Ua,r=>{let s=r.detail.suggestion,a=r.detail.term;Zo({suggestion:s,term:a}),n.value=null,location.href=s.url}),n};var Fp=o=>{let{f:e="",sort:t,type:n="question OR idea OR kbentry OR answer OR topic OR user"}=Je();return h`
		<form @submit=${s=>{s.preventDefault();let i=s.target.elements.namedItem("search-query");i.value&&(location.href=os(i.value))}} class=${o||""}>
			<input type="hidden" id="search-container" name="c" value="7" />
			<input type="hidden" id="include-space-children" name="includeChildren" value="false" />
			<input type="hidden" id="search-filters" name="f" value="${e}" />
			<input type="hidden" id="search-types" name="type" value="${n}" />
			<input type="hidden" id="search-redirect" name="redirect" value="search/search" />
			<input
				type="hidden"
				id="search-sort"
				name="sort"
				value="${t==="newest"?t:"relevance"}"
			/>
			${Up("search-query")}
		</form>
	`};var Hp=()=>{let o=document.querySelector(".nav-links-container");o.hidden=!0;let e=document.getElementById("main-navbar");e&&(e.removeAttribute("role"),e.removeAttribute("aria-label"));let t=document.querySelector('#not-footer div[role="banner"]');t&&t.removeAttribute("role"),U(Fp("navbar-search"),document.querySelector(".search-wrapper"))};var qp=()=>{let o=Array.from(document.styleSheets).filter(e=>e instanceof CSSStyleSheet&&e.href!==null&&/minerva\/.*pack\.css$/.test(e.href)).map(e=>e);for(let e of o)for(let t=0;t<e.cssRules.length;t++){let n=e.cssRules.item(t);n.type!==CSSRule.STYLE_RULE||n.selectorText.indexOf(".dropdown-menu")===-1||(n.selectorText=n.selectorText.replace(".dropdown-menu",".dropdown-menu:not(.box)"))}};function Bp(){document.addEventListener("keyup",function(o){let e=o.target instanceof HTMLElement&&o.target.closest(".qtip")||o.target instanceof HTMLElement&&o.target.querySelector(".qtip")||document.querySelector('.qtip[style*="display: block"]');o.key!=="Esc"&&o.key!=="Escape"||!e||(e.style.display="none",e.setAttribute("aria-hidden","true"))})}function Bn(o){if(!o)return"";let{primary:e,secondary:t}=o;return h`
		<ol class="nav-bar-list">
			${$p(t,!0)} ${$p(e)}
		</ol>
	`}function $p(o,e=!1){if(!o)return"";let{href:t,title:n}=o;return h`
		<li class="nav-bar-item ${e?"has-spacing":""}">
			<a
				class="button button-sm button-primary ${e?"":"button-filled"}"
				href="${t}"
			>
				${n}
			</a>
		</li>
	`}var To=class{};var Ha=class{constructor(){this._contentStack=[];this._titleStack=[]}get stackLength(){return this._contentStack?this._contentStack.length:void 0}get bodyTemplate(){return this.stackLength?this._contentStack[this._contentStack.length-1]:null}push(e){if(!e)throw new Error("Cannot push empty content");this._contentStack.push(e)}pop(){!this._contentStack||this.stackLength<=1||(this._contentStack.pop(),this._titleStack&&this._titleStack?.length>0&&this._titleStack.pop())}pushTitle(e){e&&this._titleStack.push(e)}getTitle(){return!this._titleStack||this._titleStack?.length===0?null:this._titleStack[this._titleStack.length-1]}dispose(){this._contentStack=null}};var So=class extends Error{constructor(e){let{status:t,statusText:n,url:r}=e;super(`Unexpected response status ${t}: ${n} from "${r}".`);this.name=this.constructor.name,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor),this.status=t,this.statusText=n,this.url=r}};var $h=["All","Documentation","Learn","Reference"];async function Vp(o,e=f.data.userLocale){let t={query:o,suggestions:[]};if(!o)return Promise.resolve(t);let n=`${te.siteSearch}/autocomplete?${Me({locale:e,query:o})}`,s=await B(n,{mode:"cors",credentials:ct?"include":"omit"});if(s.ok)return s.json();throw new So(s)}function nn(o){let e=new URLSearchParams(o),t=e.get("category")||"All",n=$h.find(r=>r.localeCompare(t,void 0,{sensitivity:"base"})===0)||"All";return{dataSource:e.get("dataSource"),category:n,skip:parseInt(e.get("skip")||"0"),term:e.get("search"),scope:e.get("scope"),preview:e.get("preview")}}function Gp(){let o=f.data.context.searchScope||O("scope");if(f.data.pageTemplate==="SearchPage"&&(o=nn(location.search).scope),O("hideScope")==="true"||!o)return"";let n=o.split(",").map(r=>r.trim()).filter(r=>r.length);return n.length?n[n.length-1]:""}var Vh=3e4,Kp=Symbol("scenario timeout"),qa=class{constructor(e){this.scenario=e;this._timeoutHandle=0;this._start=0}succeed(){this.complete(!0,void 0)}fail(e){this.complete(!1,e)}cancel(){this.unsubscribe()}start(){this.cancel(),this._diagnostics={type:"scenario-health",scenario:this.scenario,durationInMilliseconds:0,succeeded:!0,reason:void 0,startConnection:an.connection?.effectiveType??"unknown",endConnection:"unknown",wasHidden:k.visibilityState==="hidden",wentOffline:!an.onLine},this._start=new Date().getTime(),addEventListener("visibilitychange",this),addEventListener("offline",this),this._timeoutHandle=setTimeout(this.complete.bind(this),Vh,!1,Kp)}handleEvent(){var e,t;(e=this._diagnostics).wasHidden||(e.wasHidden=k.visibilityState==="hidden"),(t=this._diagnostics).wentOffline||(t.wentOffline=!an.onLine)}complete(e,t){if(this._start===0)return;this.unsubscribe();let n=this._diagnostics;n.succeeded=e,n.durationInMilliseconds=new Date().getTime()-this._start,n.reason=e?void 0:Gh(t),n.endConnection=an.connection?.effectiveType??"unknown",Ne({actionType:Ae.OTHER,behavior:we.OTHER,content:n}),this._start=0}unsubscribe(){removeEventListener("visibilitychange",this),removeEventListener("offline",this),clearTimeout(this._timeoutHandle)}};function Gh(o){return o===Kp?{type:"scenario-timeout"}:o instanceof Response||o instanceof So?{type:"dependency",url:o.url,status:o.status,statusText:o.statusText}:o instanceof Error?{type:"exception",name:o.name,message:o.message,stack:o.stack}:{type:"unknown",value:String(o)}}async function Wp(o){let e=new qa("Commerce.Docs.Discoverability_SiteSearch_Autocomplete");e.start();try{if(o=o.replace(/^[\s`~!@^,]+/,"").replace(/[\s`~!@^,]+$/,""),o.length>1){let t=await Vp(o,f.data.userLocale);return e.succeed(),t.suggestions}else return[]}catch(t){return e.fail(t),[]}}var Kh="https://www.azure.cn/searchresults/";function Ba(o,e=!1){let t=d=>{d.keyCode===at.escape&&o.searchExpanded&&(o.searchExpanded=!1,k.getElementById("form-expander").focus())},{scope:n,category:r,dataSource:s,preview:a}=Yh(),i=Wh(),c=f.data.brand==="mooncake"?"q":"terms";return h`
		<form
			class="nav-bar-search-form"
			method="GET"
			id="${e?"nav-bar-search-form-desktop":"nav-bar-search-form"}"
			name="nav-bar-search-form"
			aria-label="${lt}"
			role="search"
			action="${i}"
			@keydown=${t}
			@autocomplete-change-event=${Zh}
			@autocomplete-displayed-event=${e_}
		>
			${Jh(c,e)}
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" value="${r}" hidden />
			${n?h`<input name="scope" value="${n}" hidden />`:""}
			${s?h`<input name="dataSource" value="${s}" hidden />`:""}
			${a?h`<input name="preview" value="${a}" hidden />`:""}
		</form>
	`}function Wh(){let o;return f.data.brand==="mooncake"?o=Kh:P.systemContent?o=`/${f.data.userLocale}/${un?"test/docs/search/search":"search/"}`:o=`https://docs.microsoft.com/${f.data.userLocale}/search/`,o}function Yp(o,e){!o||(e=e||nn(J.search).term,o.value=e)}function Yh(){let o=Gp(),e=jh(),t=Qh();return{scope:o,category:e,dataSource:es()?"previousVersions":"",preview:t}}function jh(){let o=nn(J.search)?.category;if(o?.toLowerCase()!=="all")return o;let e=t_(J.href);return e&&e!=="All"?e:""}function Qh(){return nn(J.search).preview||""}function Jh(o,e){let t=e?st():"site-search-input";return Zr(Xh({id:t,name:o,docon:e?"search":null,size:"small"}))}function Xh({id:o,name:e,isFullWidth:t=!1,docon:n=null,size:r=null}){return{input:{id:o,type:"search",name:e,placeholder:es()?Ec:lt,label:lt,docon:n||void 0,isFullWidth:t,size:r||void 0},getSuggestions:Wp,itemTemplate:s=>h`<span class="${ts}">${s}</span>`}}function Zh(o){let e={suggestion:{title:o.detail.suggestion},term:o.detail.term};Zo(e)}function e_(o){let e=o.detail.map(t=>({title:t}));en(e)}function t_(o){let{pathname:e}=new URL(o);e=Kt(e),e=decodeURI(e).toLowerCase();let t=O("page_kind"),n=e.split("/").slice(1),r=n[0];return r==="learn"||t==="learn"||t==="certification"?"Learn":r==="powershell"&&n.length>1&&n[1]==="module"||n.indexOf("api")!==-1?"Reference":"All"}function ns(o){if(!o_())return null;let e=st(),t=h`
		<span class="is-visually-hidden-mobile">${lt}</span>
		<span class="icon margin-left-xxs" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	`,n=h`<span class="nav-bar-button-text">${Qt}</span>`,r=()=>{if(o.searchExpanded=!o.searchExpanded,o.searchExpanded){let a=document.getElementById("site-search-input");o.mobile&&(a.style.fontSize="16px"),a.focus(),o.mobile&&(a.style.fontSize=""),Yp(a)}},s=`${o.searchExpanded?"is-expanded":""}`;return h`
		<div
			class="nav-bar-search ${o.searchExpanded?"is-expanded":""}"
			id="${e}"
			?hidden="${!o.searchExpanded}"
		>
			${Ba(o)}
		</div>
		${o.mobile?null:h`
					<div class="nav-bar-search" ?hidden="${!o.desktop}">
						<!-- hidden when the width drops to tablet -->
						${Ba(o,!0)}
					</div>
			  `}
		<div class="nav-bar-search ${s}" ?hidden="${o.desktop}">
			<div class="nav-bar-search-form-expander">
				<button
					id="form-expander"
					class="nav-bar-button has-hover-underline ${s}"
					title="${o.searchExpanded?Ac:lt}"
					aria-expanded="${o.searchExpanded}"
					aria-controls="${e}"
					@click=${r}
				>
					${o.searchExpanded?n:t}
				</button>
			</div>
		</div>
	`}function o_(){return j!=="Q&A"&&j!=="Startups"}function n_(o,e,t){let n;return t&&(n=[],n.push("font-weight-semibold","font-size-md")),o.kind==="link"?rs(o,!1,n,t):r_(o,e,n)}function rs({href:o,title:e},t=!1,n=[],r=!1){let s=t?"has-text-primary":"",a=r?"":"has-external-link-indicator";return h` <li class="nav-bar-mobile-nav-item ${n.join(" ")}">
		<a
			class="${a} nav-bar-button has-text-wrap ${s}"
			href="${o}"
			autofocus
			>${e}</a
		>
	</li>`}function r_(o,e,t=[]){return h`
		<li class="nav-bar-mobile-nav-item">
			<button
				type="button"
				class="nav-bar-button has-text-wrap"
				@click=${()=>e(o)}
				autofocus
			>
				<span class="is-text-left ${t.join(" ")}">${o.title}</span>
				<span class="nav-bar-button-chevron" aria-hidden="true">
					<span
						class="docon docon-chevron-${f.data.userDir==="ltr"?"right":"left"}-light"
					></span>
				</span>
			</button>
		</li>
	`}function jp(o){return h`
		<div id="modal-header" class="nav-bar border-bottom">
			<div class="nav-bar-item">
				<button type="button" class="nav-bar-button" ?hidden=${o.searchExpanded} autofocus>
					<span class="icon is-small">
						<span class="docon docon-home" aria-hidden="true"></span>
					</span>
					<h4 class="title font-size-lg padding-left-xxs">${Qc}</h4>
				</button>
			</div>
			${ns(o)}
			<div class="nav-bar-item">
				<button
					type="button"
					class="nav-bar-button modal-close border-left"
					?hidden=${o.searchExpanded}
				>
					<span class="visually-hidden">${Qe}</span>
					<span class="icon is-small">
						<span class="docon docon-math-multiply" aria-hidden="true"></span>
					</span>
				</button>
			</div>
		</div>
	`}function Qp(o,e,t,n,r,s,a,i,c){return h`
		${a_(r,t)&&n>=2&&c?h`
					<div class="border-bottom">
						<button
							type="button"
							class="nav-bar-button pop-content is-text justify-content-flex-start padding-xs is-full-width"
							title=${ms}
							autofocus
						>
							<span class="icon" aria-hidden="true">
								<span
									class="docon docon-arrow-${f.data.userDir==="ltr"?"left":"right"}"
								></span>
							</span>
							<h3 class="font-size-sm margin-inline-xxs">${c}</h3>
							<span class="is-visually-hidden">${ms}</span>
						</button>
					</div>
			  `:null}
		${r?h`<div class="font-size-md">
					<h2 id="modal-heading" class="padding-xs font-weight-semibold">
						${r}
						${i?h`<span class="tag is-small is-uppercase">${Jn}</span>`:""}
					</h2>
			  </div>`:null}
		<nav class="nav-bar-mobile-nav" role="navigation" aria-label="${Qn}">
			<ul class="nav-bar-mobile-nav-list">
				${s?rs({href:s.href,title:Vi},!1,[],!t):null}
				${o&&o.length?o.map(d=>n_(d,e,!t)):null}
				${a?h`
							${a.primary?rs(a.primary,!0):null}
							${a.secondary?rs(a.secondary,!0):null}
					  `:null}
			</ul>
		</nav>
	`}function Jp(){let o="#",e=M.isAuthenticated?"font-size-xs padding-xxs":"auth-status-determined not-authenticated button button-filled button-sm has-outer-focus button-primary";j==="Q&A"?o=`/${f.data.userLocale}/answers/users/${M.isAuthenticated?"logout":"login"}.html`:e=`docs-sign-${M.isAuthenticated?"out":"in"} `+e;let t=h`<span class="flex-grow-1 flex-shrink-1 font-size-xs"
		>${Re(Wc)}</span
	>`;j==="Startups"&&(t=Bn({primary:{kind:"link",href:"https://portal.startups.microsoft.com/",title:"Member sign in"}}));let n=h` ${M.isAuthenticated?s_():t}
		<div>
			${M.isAuthenticated?h`<a
						class="font-size-xs padding-xxs"
						href="${He("me","settings")}"
						data-profile-property="settingsUrl"
				  >
						<span class="icon" aria-hidden="true">
							<span class="docon docon-settings"></span>
						</span>
						<span class="visually-hidden">${_n}</span>
				  </a>`:""}

			<a class="${e}" href="${o}"
				>${M.isAuthenticated?Xn:Lo}</a
			>
		</div>`;return h`
		<div
			class="border-top display-flex align-items-center padding-xxs justify-content-space-between"
		>
			${xn?n:t}
		</div>
	`}function s_(){return h`
		<a href="${He("me","activity")}" class="display-flex align-items-center">
			<div class="padding-left-xxs">
				<figure class="image is-24x24" aria-hidden="true">
					<img
						class="has-body-background-medium is-rounded"
						aria-labelledby="display-name-mobile"
						data-profile-property="avatarUrl"
						src=${M.avatarUrl}
					/>
				</figure>
			</div>
			<p class="title flex-grow-1 flex-shrink-1 font-size-sm margin-none padding-left-xxs">
				<span
					id="display-name-mobile"
					class="is-inline-truncated has-max-width-200"
					data-profile-property="displayName"
					>${M.displayName}</span
				>
			</p>
		</a>
	`}function a_(o,e){return e||j!=="Docs_Home"&&o}async function Zp(o){let e=k.createElement("div");e.classList.add("modal-content","is-docked-right","display-flex","flex-direction-column");let t=new Ha;e.paint=()=>{U(h` ${jp(o)}
				<div
					id="modal-body"
					class="flex-grow-1 flex-shrink-1 is-full-height is-vertically-scrollable"
				>
					${t.bodyTemplate}
				</div>
				${Jp()}`,e)};function n(){e.paint();let E=e.querySelector("#modal-body");i_(E)}function r(E){let I=E.target instanceof HTMLElement&&E.target.closest("button");!I||!I.classList.contains("pop-content")||(t.pop(),n())}let s=o.subscribe(To,e.paint);e.dispose=()=>{t.dispose(),s(),e.removeEventListener("click",r)};let a=Xp(o.items),i,c,l,d,u;function p(E){a=E.items,i=E.title,c=null,l=null,d=null,u=t.getTitle(),m(!0),n()}function m(E=!1){let I=Qp(a,p,E,t.stackLength,i,c,l,d,u);t.push(I),t.pushTitle(i)}function g(){m(),e.paint()}function y(){if(!(t.stackLength<=1)){for(;t.stackLength>1;)t.pop();n()}}if(g(),e.addEventListener("click",r),rr){await bn;let E=Xe;E&&(c=E.category,l=E.callToAction,d=E.preview,i=E.category?E.category.title:null,a=Xp(E.items),m(!0),n())}return e.querySelector("#modal-header button").onclick=y,e}function i_(o){let e=o.querySelector("[autofocus]");if(e&&Ur(e)){e.focus();return}o.focus()}function Xp(o){return o.slice(0,o.length-1)}function $a(o,e){let{leftTemplate:t,rightTemplate:n}=o;return h` ${t(e)} ${n(e)} `}function em(){return h`
		<div class="nav-bar-profile">
			${m_()} ${p_()}
		</div>
	`}function tm(){return h` <div class="nav-bar-brand">
		<a
			class="nav-bar-button"
			itemprop="url"
			href="https://www.microsoft.com"
			aria-label="Microsoft"
		>
			${Cu()}
		</a>
	</div>`}function om(o,e,t){if(!e)return"";let{href:n,title:r}=e;return h`
		<a
			class="nav-bar-button is-title has-hover-underline"
			href="${n}"
			?hidden=${o.mobile}
			itemprop="url"
		>
			<span>
				${r}
				${t?h`<span class="tag is-small is-uppercase">${Jn}</span>`:""}
			</span>
		</a>
	`}function c_(o){if(!o)return"";let{href:e,title:t}=o;return h`
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" href="${e}" itemprop="url">
				<span>${t}</span>
			</a>
		</li>
	`}function nm(){return j!=="Learn"?"":h`
		<div
			id="level-status-container"
			class="display-flex align-items-center is-hidden is-hidden-touch"
		>
			<div id="level-status" class="position-relative level margin-inline-xxs"></div>
		</div>
	`}function Va(o,e,t,n){let{items:r}=o;return h`
		<nav class="nav-bar-nav" role="navigation" aria-label="${e}">
			<ul class="nav-bar-nav-list">
				${n?c_(n):null}
				${r.map(s=>sm(s,!1,t))}
			</ul>
		</nav>
	`}function rm(o){return h`
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button
					class="nav-bar-button is-title"
					title="${fs}"
					aria-expanded="${o.mobileNavExpanded}"
					@click=${()=>l_(o)}
				>
					<span class="nav-bar-menu-title">${vs}</span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label">${fs}</span>
					</div>
				</button>
			</div>
		</div>
	`}async function l_(o){let e=await Zp(o),t=new Ee(e),n=window.outerWidth;function r(){e.dispose(),window.removeEventListener("resize",s),o.mobileNavExpanded=!1}function s(){t.hide(),r()}window.addEventListener("resize",()=>{window.outerWidth!==n&&s()},{passive:!0}),o.mobileNavExpanded=!0,await t.show(),r()}function sm(o,e,t){return o.kind==="link"?u_(o,e,t):d_(o,e,t)}function u_(o,e,t){let n=j==="Docs_Home"||j==="Developer"||j==="Regional Directors"||j==="Legal"||j==="Locale"||j==="Profile"||j==="Search",r=t&&o.title===Et&&O("page_type")==="directory",s=t&&o.title===vs&&!n||r||o.current?"is-active":"",a=Br(o.href,f.data.userLocale),i=t?"":"has-external-link-indicator";return e?h`
				<li class="nav-bar-item" ?hidden=${o.hidden}>
					<a class="${i} nav-bar-button ${s}" href="${a}">
						${o.title}
					</a>
				</li>
		  `:h`
				<li class="nav-bar-item" ?hidden=${o.hidden}>
					<a
						class="${i} nav-bar-button has-hover-underline ${s}"
						href="${a}"
					>
						<span>${o.title}</span>
					</a>
				</li>
		  `}function d_(o,e,t){let n=st(),r=e?f.data.userDir==="ltr"?"chevron-right-light":"chevron-left-light":"chevron-down-light",s=e?"":"expanded-indicator",a=o.current?"is-active":"";return h` <li class="dropdown nav-bar-item" ?hidden=${o.hidden}>
		<button
			class="dropdown-trigger nav-bar-button ${a} ${e?"":"has-hover-underline"}"
			aria-controls="${n}"
			aria-expanded="false"
		>
			<span>${o.title}</span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-${r} ${s}"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="${n}" aria-label="${o.title}">
			${o.items.map(i=>sm(i,!0,t))}
		</ul>
	</li>`}function p_(){return h`
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button
				class="dropdown-trigger button-reset"
				aria-label="${jc}"
				aria-controls="user-menu"
				aria-expanded="false"
			>
				<figure class="image is-36x36">
					<img
						class="has-body-background-medium is-rounded"
						alt=""
						data-profile-property="avatarUrl"
					/>
				</figure>
			</button>
			<div
				class="dropdown-menu box justify-content-flex-start has-body-background"
				id="user-menu"
				role="menu"
			>
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img
								class="has-body-background-medium is-rounded"
								aria-labelledby="displayName"
								data-profile-property="avatarUrl"
							/>
						</figure>
					</div>
					<div class="media-content">
						<h2 class="title font-size-lg">
							<span
								id="displayName"
								class="is-inline-truncated has-max-width-200"
								data-profile-property="displayName"
							></span>
						</h2>
						<p class="subtitle font-size-sm margin-bottom-none">
							<span
								class="is-inline-truncated has-max-width-200"
								data-profile-property="upn"
							></span>
						</p>
					</div>
				</div>
				<ul class="padding-top-xs padding-bottom-xs">
					<li class="padding-bottom-xs">
						<a href="${He("me","activity")}" data-profile-property="profileUrl"
							>${hc}</a
						>
					</li>
					<li>
						<a href="${He("me","settings")}" data-profile-property="settingsUrl"
							>${_n}</a
						>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out" href="#">${Xn}</a>
				</div>
			</div>
		</div>
	`}function m_(){return h`
		<a class="docs-sign-in auth-status-determined not-authenticated" href="#"> ${Lo} </a>
	`}function $n(o){return JSON.parse(JSON.stringify(o))}var Ga=class extends wt{constructor(){super();this._items=[{title:Le,kind:"menu",items:[]}];this._mobile=!1;this._searchExpanded=!1;this._desktop=!1;this._mobileNavExpanded=!1}get items(){return this._items}set items(e){this._items=e&&e.length?e:[{title:Le,kind:"menu",items:[]}],this.more.items=$n(this._items.slice(0,this._items.length-1)),this.resetItemVisibility(),this.notifyPropertyChanged()}get mobile(){return this._mobile}set mobile(e){this._mobile=e,this._mobileNavExpanded=!1,this.notifyPropertyChanged()}get desktop(){return this._desktop}set desktop(e){this._desktop=e,this._searchExpanded=!1,this.notifyPropertyChanged()}get searchExpanded(){return this._searchExpanded}set searchExpanded(e){this._searchExpanded=e,this.notifyPropertyChanged()}get mobileNavExpanded(){return this._mobileNavExpanded}set mobileNavExpanded(e){this._mobileNavExpanded=e,this._searchExpanded=!1,this.notifyPropertyChanged()}get more(){let e=this._items.length;return e?this._items[e-1]:null}resetItemVisibility(){this.items.length!==0&&(this.items.forEach(e=>e.hidden=!1),this.more.hidden=!0,this.more.items.forEach(e=>e.hidden=!0))}notifyPropertyChanged(){this.publish(new To)}};function Ka(o){let e=document.createElement("div");e.classList.add("nav-bar");let t=new Ga;return e.paint=()=>lm(e,t,o),Object.defineProperty(e,"items",{enumerable:!0,get:()=>t.items,set:n=>t.items=n}),t.desktop=lr.matches,t.mobile=!yn.matches,lr.addListener(()=>{t.desktop=lr.matches}),yn.addListener(()=>{t.mobile=!yn.matches}),window.addEventListener("resize",()=>{yn.matches&&g_(e,t,o)},{passive:!0}),e.paint(),ie.then(()=>{let n=new MutationObserver(r=>{for(let s of r)for(let a=0;a<s.addedNodes.length;a++)if(s.addedNodes[a]===e){n.disconnect(),e.paint();return}});n.observe(document.body,{childList:!0,subtree:!0})}),t.subscribe(To,()=>e.paint()),e}var cm=0;function lm(o,e,t){if(cm=Date.now(),e.resetItemVisibility(),U($a(t,e),o),e.mobile)return;let n=o.querySelector(".nav-bar-spacer"),{more:r,items:s}=e,a=s.length-1;for(;a>0&&n.getBoundingClientRect().width===0;)a--,r.hidden=!1,s[a].hidden=!0,r.items[a].hidden=!1,U($a(t,e),o)}var am=0,im=50;function g_(o,e,t){clearTimeout(am),Date.now()-cm>im?o.paint():am=setTimeout(lm,im,o,e,t)}var f_=j==="Regional Directors";function Wa(o){if(P.systemContent===!0||f_)return o;if(o.kind==="menu"){let t=$n(o);return t.items=t.items.map(Wa),t}let e=$n(o);return e.href=new URL(o.href,te.contentNav).href,e}async function um(){gl(),fl(),h_()}async function h_(){await ie;let o=k.querySelector("#headerAreaHolder > header"),[e,t]=await Promise.all([__(),x_()]);U(h` ${e} ${t} `,o),ml()}async function __(){await ks;let o=Ka({leftTemplate:()=>tm(),rightTemplate:e=>{let t=!xn&&oo.callToAction&&!e.mobile?Bn(oo.callToAction):null;return h`
				${rm(e)}
				${Va(e,Qn,!0,oo.category)}
				<span class="nav-bar-spacer"></span>
				${e.mobile?null:ns(e)}
				${xn?em():t}
			`}});return o.items=oo.items.map(Wa),o}async function x_(){if(await bn,!Xe)return null;let o=Ka(b_());return o.items=Xe.items,o.classList.add("border-top","is-hidden-mobile"),o}function b_(){let{category:o,callToAction:e,preview:t}=Xe;return{leftTemplate:s=>om(s,o,t),rightTemplate:s=>h`
		${Va(s,kc,!1)}
		<span class="nav-bar-spacer"></span>
		${Bn(e)} ${nm()}
	`}}Object.defineProperty(HTMLElement.prototype,"inlineStyle",{set(o){this.style.cssText=o}});Object.defineProperty(HTMLInputElement.prototype,"customValidity",{set(o){this.setCustomValidity(o)}});(f.data.pageTemplate==="ModuleUnit"||O("show_latex")==="true")&&(H.MathJax={showMathMenu:!1,showMathMenuMSIE:!1,tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0},AuthorInit:()=>{H.MathJax.Hub.Register.StartupHook("End",()=>{document.documentElement.classList.add("mathjax-complete")})}},f.data.mathjax?.macros&&(H.MathJax.TeX={Macros:f.data.mathjax?.macros}));async function dm(){if(H.adobeTarget===void 0)return;let o=await H.adobeTarget.atRequestSucceeded;if(!o||!o.detail)return;let{analyticsDetails:e,responseTokens:t}=o.detail;if(e&&Ls({actionType:"A",behavior:12,content:{},pageTags:{tnta:e[0]&&e[0].payload?e[0].payload.tnta:""}}),t){let n=t.length;for(let r=0;r<n;r++)Ls({actionType:"A",behavior:12,content:{},pageTags:{at_activity_name:t[r]?t[r]["activity.name"]:"",at_exp_name:t[r]?t[r]["experience.name"]:"",at_activity_id:t[r]?t[r]["activity.id"]:"",at_exp_id:t[r]?t[r]["experience.id"]:""}})}}function pm(){v_(),y_(),T_(),S_(),w_(),C_(),E_(),k_(),A_(),I_()}async function v_(){let o=()=>Ul(M.authenticationMode,M.isAuthenticated);M.subscribe(Fe,o),o(),await M.whenAuthenticated(),Ne({content:{event:"user-is-signed-in"}})}function y_(){function o(e){!e.isTrusted||!(e.target instanceof HTMLSelectElement)||!e.target.hasAttribute(pr.name)||Sn(e.target,{actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"select-value-changed",name:Ps(e.target),value:e.target.value}})}k.addEventListener("change",o,{passive:!0})}function T_(){let o="";function e(r){!r.isTrusted||o===r.type||(o=r.type,Ne({actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"page-focus-changed",value:r.type}}))}let t=0;function n(r){clearTimeout(t),t=setTimeout(()=>e(r),50)}H.addEventListener("focus",n,{passive:!0}),H.addEventListener("blur",n,{passive:!0})}function S_(){function o(){Ne({actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"page-visibility-changed",value:k.hidden?"hidden":"visible"}})}function e(){k.addEventListener("visibilitychange",o,{passive:!0})}k.readyState==="interactive"||k.readyState==="complete"?e():k.addEventListener("DOMContentLoaded",e)}function w_(){!Cl||El.addListener(o=>{!o.matches||Ne({actionType:Ae.OTHER,behavior:we.PRINT,content:{event:"print"}})})}function C_(){function o(t){if(!t.isTrusted||!(t.target instanceof HTMLElement))return;let{width:n,height:r}=t.target.getBoundingClientRect(),{scrollLeft:s,scrollTop:a,scrollWidth:i,scrollHeight:c}=t.target;Sn(t.target,{actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"secondary-content-scroll",name:Ps(t.target),viewPortWidth:Math.floor(n),viewPortHeight:Math.floor(r),contentWidth:Math.floor(i),contentHeight:Math.floor(c),horizontalOffset:Math.floor(s),verticalOffset:Math.floor(a)}})}function e(t){if(t.target===k)return;let n=t.target;clearTimeout(n.reportScrollTimeout),n.reportScrollTimeout=setTimeout(()=>o(t),100)}H.addEventListener("scroll",e,{passive:!0,capture:!0})}function E_(){let o=!1;function e(){Ne({actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"unload",anchor:o}})}function t(r){r.target instanceof HTMLAnchorElement&&(o=!0,setTimeout(()=>o=!1))}function n(r){r.target instanceof HTMLAnchorElement&&(o=!0,setTimeout(()=>o=!1))}H.addEventListener("keydown",n,{capture:!0,passive:!0}),H.addEventListener("click",t,{capture:!0,passive:!0}),H.addEventListener("beforeunload",e,{passive:!0})}function k_(){function o(e){let t=e.target;if(t.id!=="nav-bar-search-form"&&t.id!=="nav-bar-search-form-desktop"&&t.id!=="welcome-page-search-form"&&t.id!=="directory-page-search-form"&&t.id!=="facet-search-form")return;let r=Array.from(t.querySelectorAll('input[name="terms"], input[name="facet-search-input"]'))[0].value,s=k.activeElement&&k.activeElement instanceof HTMLButtonElement&&k.activeElement.type==="submit"&&!!t.querySelector(`#${k.activeElement.id}`);Sn(t,{actionType:Ae.OTHER,behavior:we.SEARCH,content:{event:"uhf-search",value:r,submitButton:s}})}H.addEventListener("submit",o,{passive:!0,capture:!0})}function A_(){function o(e){e.isTrusted&&e.keyCode===70&&e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&Ne({actionType:Ae.OTHER,behavior:we.OTHER,content:{event:"ctrl-f"}})}H.addEventListener("keydown",o,{passive:!0})}function I_(){function o(e){let t={referrerUri:e.referrerUrl.href,requestUri:e.url.href,title:e.title,pageName:O("document_id")||"missing document_id",pageType:O("page_type"),pageTags:{}};ur(t.pageTags),Fl(t),Ms()}Yt.subscribe(pn,o)}var $O=Intl.DateTimeFormat().resolvedOptions().timeZone;var VO=new Intl.DateTimeFormat(f.data.userLocale,{hour:"numeric",minute:"numeric"}),GO=new Intl.DateTimeFormat(f.data.userLocale,{month:"long",day:"numeric"}),KO=new Intl.DateTimeFormat(f.data.userLocale,{month:"short",day:"numeric"}),WO=new Intl.DateTimeFormat(f.data.userLocale,{month:"long",year:"numeric"}),YO=new Intl.DateTimeFormat(f.data.userLocale,{day:"numeric"}),jO=new Intl.DateTimeFormat(f.data.userLocale,{month:"short"}),QO=new Intl.DateTimeFormat(f.data.userLocale,{year:"numeric"}),JO=new Intl.DateTimeFormat(f.data.userLocale,{month:"long",day:"numeric",year:"numeric"}),XO=new Intl.DateTimeFormat(f.data.userLocale,{weekday:"long",month:"long",day:"numeric",year:"numeric"});function Ya(o){let e="h",t="m",n="s",r=0,s=o.indexOf(e)!==-1,a=o.indexOf(t)!==-1,i=o.indexOf(n)!==-1;return r+=s?Number(o.substring(0,o.indexOf(e)))*3600:0,r+=a?s?Number(o.substring(o.indexOf(e)+1,o.indexOf(t)))*60:Number(o.substring(0,o.indexOf(t)))*60:0,r+=i?Number(a?o.substring(o.indexOf(t)+1,o.indexOf(n)):s?o.substring(o.indexOf(e)+1,o.indexOf(n)):o.substring(0,o.indexOf(n))):0,r}var mm="2.3.9",_2=`/static/third-party/azure-media-player/${mm}/azuremediaplayer.min.js`,x2=`/static/third-party/azure-media-player/${mm}/azuremediaplayer.min.css`;var rn,ja;function P_(){let o=location.href,e="#time=";if(o.includes(e)){let t=o.substring(o.indexOf(e)+e.length);return Ya(t)}return Ya("0s")}function L_(){let o=rn.paused(),e=P_();e>0&&e<ja/1e3?rn.currentTime(e):rn.currentTime(0),rn.play(),o&&rn.pause()}window.addEventListener("hashchange",()=>{rn!==void 0&&L_()});async function gm(o){let e=await B(o,{credentials:"include",redirect:"follow"});if(!e.ok)throw new Error(`Unexpected response status ${e.status} for ${o}`);let t=await e.text(),r=new DOMParser().parseFromString(t,"text/html");return{url:new URL(e.url||o,location.origin),document:r}}var fm=/(^|\/)index$/i,E2=J.hostname==="localhost"&&f.environment===void 0;function Gn(o){let e=new URL(o,location.origin),t=decodeURIComponent(e.pathname).toLowerCase().replace(fm,"$1").replace(Xo,"/"),n=e.searchParams.get("view");if(n&&(e.search="",e.searchParams.set("view",n),t+=e.search),t.indexOf("/learn/challenges")!==-1){let r=e.searchParams.get("id");e.search="",e.searchParams.set("id",r),t+=e.search}return t}function hm(o){o.type!=="docs"&&o.type!=="qa"&&o.type!=="url"&&(o.type="docs"),o.type!=="url"&&(o.data.url=Gn(o.data.url))}function Vn(o){o.items.forEach(hm),o.sections?.forEach(e=>e.items?.forEach(hm))}var it={baseUrl:te.lists,async getAllLists(){let o=Z(this.baseUrl,{}),e=await B(o);if(ue(e),e.ok){let t=await e.json();return t.forEach(Vn),t}throw new Error(`${e.status}: ${e.statusText}`)},async getAllListsByUrl(o){let e=[];o.forEach(s=>{e.push(Gn(s))});let t=JSON.stringify(e),n=Z(this.baseUrl+"/by-url",{method:"POST",body:t}),r=await B(n);if(ue(r),r.ok)return await r.json();throw new Error(`${r.status}: ${r.statusText}`)},async getList(o){let e={locale:f.data.userLocale},t=`${this.baseUrl}/${o}?${Me(e)}`,n=Z(t,{},!0),r=await B(n);if(ue(r),r.ok){let s=await r.json();return Vn(s),s}if(r.status===404)return null;throw new Error(`${r.status}: ${r.statusText}`)},async getStudyGuideList(o,e,t=null){let n={locale:f.data.userLocale,branch:ct?t:null},r={credentials:ct?"include":null},s=`${this.baseUrl}/studyguide/${o}/${e}?${Me(n)}`,a=Z(s,r,!0),i=await B(a);if(ue(i),i.ok){let c=await i.json();return Vn(c),c}if(i.status===404)return null;throw new Error(`${i.status}: ${i.statusText}`)},async createList(o){let e=JSON.stringify(o),t=Z(this.baseUrl,{method:"POST",body:e},!0),n=await B(t);if(ue(n),n.ok){let r=await n.json();return{hasError:!1,data:r}}if(n.status===400){let r=await n.json();return{hasError:!0,error:r}}throw new Error(`${n.status}: ${n.statusText}`)},async deleteList(o){let e=Z(this.baseUrl+"/"+o,{method:"DELETE"},!0),t=await B(e);if(ue(t),!t.ok)throw new Error(`${t.status}: ${t.statusText}`)},async updateListMetadata(o,e){let t=JSON.stringify({name:e.name,description:e.description}),n=Z(this.baseUrl+"/"+o,{method:"PATCH",body:t},!0),r=await B(n);if(ue(r),r.ok){let s=await r.json();return Vn(s),{hasError:!1,data:s}}if(r.status===400){let s=await r.json();return{hasError:!0,error:s}}throw new Error(`${r.status}: ${r.statusText}`)},async sortList(o,e){let t={locale:f.data.userLocale},n=`${this.baseUrl}/${o}?${Me(t)}`,r=JSON.stringify(e),s=Z(n,{method:"PUT",body:r},!0),a=await B(s);if(ue(a),a.ok){let i=await a.json();return Vn(i),{hasError:!1,data:i}}if(a.status===400){let i=await a.json();return{hasError:!0,error:i}}throw new Error(`${a.status}: ${a.statusText}`)},async addItem(o,e){let t=JSON.stringify(e),n=Z(this.baseUrl+"/"+o,{method:"POST",body:t},!0),r=await B(n);if(ue(r),r.ok){let s=await r.json();return{hasError:!1,data:s}}if(r.status===400||r.status===403){let s=await r.json();return{hasError:!0,error:s}}throw new Error(`${r.status}: ${r.statusText}`)},async deleteItem(o,e){let t=Z(this.baseUrl+"/"+o+"/"+e,{method:"DELETE"},!0),n=await B(t);if(ue(n),!(n.ok||n.status===204))throw new Error(`${n.status}: ${n.statusText}`)},async updateItem(o,e,t){let n=JSON.stringify(t),r=Z(`${this.baseUrl}/${o}/${e}`,{method:"PUT",body:n},!0),s=await B(r);if(ue(s),s.ok){let a=await s.json();return{hasError:!1,data:a}}if(s.status===400||s.status===403){let a=await s.json();return{hasError:!0,error:a}}throw new Error(`${s.status}: ${s.statusText}`)},async createSection(o,e,t){let n=JSON.stringify({name:e,description:t}),r=Z(`${this.baseUrl}/${o}/section`,{method:"POST",body:n},!0),s=await B(r);if(ue(s),s.ok){let a=await s.json();return{hasError:!1,data:a}}if(s.status===400){let a=await s.json();return{hasError:!0,error:a}}throw new Error(`${s.status}: ${s.statusText}`)},async updateSection(o,e,t,n){let r=JSON.stringify({name:t,description:n}),s=Z(`${this.baseUrl}/${o}/section/${e}`,{method:"PATCH",body:r},!0),a=await B(s);if(ue(a),a.ok){let i=await a.json();return{hasError:!1,data:i}}if(a.status===400){let i=await a.json();return{hasError:!0,error:i}}throw new Error(`${a.status}: ${a.statusText}`)},async deleteSection(o,e){let t=Z(`${this.baseUrl}/${o}/section/${e}`,{method:"DELETE"},!0),n=await B(t);if(ue(n),n.ok){let r=await n.json();return{hasError:!1,data:r}}if(n.status===400){let r=await n.json();return{hasError:!0,error:r}}throw new Error(`${n.status}: ${n.statusText}`)}};async function ss(o=H.document,e=!1){let t;if(typeof o=="string")if(!e&&new URL(Br(o,f.data.userLocale),H.location.origin).href===H.location.href)o=H.document,t=new URL(H.location.href);else{let l=await gm(o);t=l.url,o=l.document}else t=new URL(o.URL);let n=ii(o),r=()=>n.page_type==="show"&&n.type?n.type:n.page_kind||"",s=new RegExp("^/"+f.data.userLocale+"/answers[$/]","i"),a=t.pathname.match(s)?"qa":"docs",i=t.toString(),c=null;return t.pathname.indexOf("/learn/challenges")!==-1&&(c=Zc().id),{type:a,data:{url:Gn(i),rawUrl:i,title:n["og:title"]||o.title,docId:n.document_id||"",docVIId:n.document_version_independent_id||"",pageType:n.page_type||"",pageKind:r(),uid:n.uid||"",challengeId:c,eventUid:n.eventUid||"",durationInMillisecond:ja||null,showId:n.showId||""}}}var hU=Jt(),_U=f.data.userLocale;var as;function _m(o=()=>!0){return as===void 0&&(as=it.getAllLists()),as.then(e=>{let t=e.find(n=>n.type==="bookmarks");return t&&(t.name=wi),e.filter(o)})}function xm(o){return as=void 0,it.createList(o)}async function bm(o,e){let t=o.elements.namedItem("collection-title").value,n=o.elements.namedItem("collection-description").value;o.querySelector("button[type=submit]").classList.add("is-loading");let r=await xm({type:"collection",name:t,description:n,items:e});return M_(r,o)}function M_(o,e){if(o.hasError===!0){let t=e.querySelector("button[type=submit]");t&&t.classList.remove("is-loading");let{errorCode:n}=o.error;return N_(n,e),{hasError:!0}}return{hasError:!1,data:o.data}}function N_(o,e){let t=e.elements.namedItem("collection-title"),n=e.elements.namedItem("collection-description");switch(o){case"InvalidBody":case"MissingType":return;case"InvalidTitle":t.setCustomValidity(vi),t.reportValidity();return;case"InvalidDescription":n.setCustomValidity(yi),n.reportValidity();return;case"DuplicateTitle":let r=bi.replace("{title}",t.value);t.setCustomValidity(r),t.reportValidity();return;default:return}}function vm(o,e,t,n,r,s=Gc,a=!0,i=!1,c=!1,l=""){return h`
		<h2
			class="title is-3 margin-none ${f.data.userDir==="rtl"?"margin-left-sm":"margin-right-sm"}"
		>
			${o}
		</h2>
		<button
			class="modal-close modal-card-close-button is-large is-sticky"
			aria-label="${Qe}"
		></button>
		<p class="margin-top-xxs" ?hidden="${a}">
			${Li}
		</p>
		<div class="margin-top-xs">
			<div class="field ${l}">
				<label for="collection-title" class="label margin-bottom-xxs"
					>${s}</label
				>
				<div class="control">
					<input
						id="collection-title"
						class="input"
						type="text"
						name="title"
						.value=${e}
						required
						minlength="1"
						maxlength="100"
						autofocus
					/>
				</div>
			</div>
			<div class="field" ?hidden="${i}">
				<label for="collection-description" class="label margin-bottom-xxs"
					>${Di}</label
				>
				<div class="control">
					<textarea
						id="collection-description"
						class="textarea"
						name="description"
						maxlength="550"
						.value=${t}
						placeholder="${mc}"
					></textarea>
				</div>
			</div>
			<p class="padding-bottom-xxs" ?hidden="${c}">
				${Re(Ti)}
			</p>
			<div class="buttons margin-top-sm">
				<button class="button button-primary button-filled font-weight-semibold" type="submit">
					${n}
				</button>
				<button type="button" class="modal-close button font-weight-semibold">${r}</button>
			</div>
		</div>
	`}var is=[],wo={};function ym(o,e,t,n=()=>{}){return wo={},h`
		<div class="modal-card padding-xs padding-sm-tablet">
			<div class="padding-xxs">
				<h2 class="title margin-bottom-xxs">${gs}</h2>
				<button
					class="modal-close modal-card-close-button is-large is-sticky"
					aria-label="Close"
				></button>
				<form
					id="save-to-multiple-collections"
					action="javascript:"
					@submit="${async r=>{r.preventDefault();let s=o.contentElement.querySelector("button#save-collection");s.classList.add("is-loading"),s.disabled=!0,await U_(wo),wo={},n(),o.hide()}}"
				>
					<legend class="font-size-sm">
						${Re(_i.replace("{pageName}",e))}
					</legend>
					<hr class="hr margin-top-xxs" />
					<div id="collections" class="has-max-height-300 is-vertically-scrollable"></div>
					<hr class="hr margin-bottom-xxs" />
					<button
						type="button"
						@click="${()=>F_(o,t,document.querySelectorAll("#collections input").length)}"
						class="button button-clear margin-bottom-xs"
					>
						<span class="icon" aria-hidden="true">
							<span class="has-text-primary docon docon-math-plus-light"></span>
						</span>
						<span>${Zi}</span>
					</button>
					<div class="buttons">
						<button
							id="save-collection"
							class="button button-primary button-filled title button-sm"
							type="submit"
						>
							${Po}
						</button>
						<button type="button" class="modal-close button is-unstyled title button-sm">
							${Qt}
						</button>
					</div>
				</form>
			</div>
		</div>
	`}async function z_(o,e,t){let n=document.createElement("div");n.classList.add("modal-content");let r=Si.replace("{userDisplayName}",M.displayName).replace("{index}",(t+1).toString()),a=h`
		<div class="modal-card padding-xs padding-sm-tablet">
			<div>
				<button
					@click="${()=>Tm(o)}"
					class="button button-clear button-sm button-primary"
				>
					<span class="icon">
						<span class="docon docon-arrow-left"></span>
					</span>
					<span>${Bi}</span>
				</button>
			</div>
			<div class="padding-xxs">
				<form id="save-to-collection">
					${vm(gs,r,"",Zn,Qt)}
				</form>
			</div>
		</div>
	`;return U(a,n),n.querySelector("button[type=submit]").onclick=async()=>{await D_(o,e)},n}async function Qa(o,e){let t=await _m(c=>c.type==="collection"||c.type==="bookmarks"),n=t.length===0,r=o.querySelector("#collections"),s=o.querySelector("#save-collection");if(s&&s.hasAttribute("autofocus")&&s.removeAttribute("autofocus"),n){let c=h`<p class="has-text-subtle">${Yc}</p>`;return s&&s.setAttribute("autofocus","autofocus"),U(c,r),[]}let a=await it.getAllListsByUrl([e]);is=a[0].lists;let i=h` ${t.map(c=>h` <div class="field">
			<div class="control">
				<label class="checkbox" for="${c.id}">
					<input
						@click="${()=>O_(e,a[0].lists,wo)}"
						.checked=${wo[c.id]?typeof wo[c.id]!="string":a[0].lists.reduce((l,d)=>l||d.listId===c.id,!1)||t.length===1&&t[0].id==="bookmarks"&&c.id==="bookmarks"}
						type="checkbox"
						class="collection-input"
						id="${c.id}"
						name="${c.name}"
						?autofocus=${c===t[0]}
					/>
					<span class="checkbox-check" role="presentation"></span>
					<span class="checkbox-text">${c.name}</span>
				</label>
			</div>
		</div>`)}`;if(U(i,r),t.length===1&&t[0].id==="bookmarks"&&is.length===0){let c=await ss(e);await it.addItem("bookmarks",c)}return is}async function D_(o,e){event.preventDefault();let t=event.target;t.classList.add("is-loading");let n=ss(e),r=document.getElementById("save-to-collection");await bm(r).then(async s=>{s.hasError?t.classList.remove("is-loading"):(s=s,wo[s.data.id]=n,Tm(o),is=await Qa(document.querySelector(".modal-card"),e))})}async function O_(o,e,t){let n=event.target;if(n.checked){let r=ss(o);t[n.id]=r}else{let r=e.find(s=>s.listId===n.id);r&&(t[n.id]=r.id)}}function U_(o){let e=Object.keys(o);return Promise.all(e.map(async t=>typeof o[t]!="string"?it.addItem(t,await o[t]):it.deleteItem(t,o[t])))}async function F_(o,e,t){o.pushContent(await z_(o,e,t))}function Tm(o){o.popContent()}var Ja=class{constructor(e){this.container=document.createElement("div"),this.container.setAttribute("role","alert"),this.container.setAttribute("aria-live","assertive"),this.container.setAttribute("data-dismissable","disappearing"),this.container.classList.add("toast"),this.container.appendChild(e),this.wrapper=document.createElement("div"),this.wrapper.insertAdjacentElement("afterbegin",this.container),this.contentElement=e}show(){let e=document.querySelector(".toast");e&&Gr(e),document.body.insertAdjacentElement("afterbegin",this.container),this.container.classList.add("appearing"),setTimeout(()=>{no()},10),setTimeout(()=>{Gr(this.container)},3500)}};function Sm(o){for(let e=0;e<o.elements.length;e++){let t=o.elements.item(e);(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&(t.onchange=()=>t.setCustomValidity(/^\s+$/.test(t.value)?gc:"")),t instanceof HTMLButtonElement&&t.type==="submit"&&(t.onclick=()=>o.classList.add("show-validation-status"))}}async function wm(o,e){let t=k.createElement("form");t.action="javascript:",o instanceof yt?U(o,t):t.appendChild(o),q_(t);let n=k.createElement("div");n.classList.add("modal-content"),n.appendChild(t);let r=new Ee(n),s=!1,a={hasError:!1,data:null};return t.addEventListener("submit",async i=>{i.preventDefault(),a=e?await e(t):{hasError:!1,data:null},a.hasError===!1&&(s=!0,r.hide())}),Sm(t),await r.show(),{submitted:s,form:t,data:a.hasError?null:a.data}}function q_(o){if(o.querySelector("form"))throw new Error("The content argument should not contain a form")}function Cm(o,e,t=dc){return h` <section class="modal-card is-shadowless-mobile padding-xs padding-sm-tablet">
		<h2 class="title is-3 margin-bottom-xs margin-right-xxs" id="modal-heading">${o}</h2>
		<button
			class="modal-close modal-card-close-button is-large is-sticky"
			aria-label="${Qe}"
		></button>
		<div class="flex-grow-0 padding-none">
			<p ?hidden="${!e}" id="modal-text" class="font-size-sm padding-bottom-sm">${e}</p>
			<div class="buttons margin-bottom-none">
				<button class="button button-primary button-filled button-sm" type="submit" autofocus>
					${t}
				</button>
				<button type="button" class="modal-close button button-sm">${Qt}</button>
			</div>
		</div>
	</section>`}var B_=["activity","training","challenges","certifications","qna","achievements","collections","transcript"],$_=B_.slice();function Em(o,e,t,n=H.location,r=f.data.userLocale,s){if(o=o.toLowerCase(),t&&!(e==="collections"||e==="training"||e==="achievements"||e==="transcript"||e==="certifications"))throw new Error(`Detail url component is not supported in ${e} section.`);let a=new URL(n.origin+n.pathname+n.search).searchParams;t!=="view-certifications"&&e==="certifications"||!s?a.delete("id"):s&&a.set("id",s);let i=a.toString();if(i=i.length?"?"+i:"",n.hostname==="docs.microsoft.com"){let u;return e&&e!=="activity"?u=new URL(`/${r}/users/${o}/${e}${t?"/"+t:""}${i}`,n.origin):u=new URL(`/${r}/users/${o}/${i}`,n.origin),u}let l=`/${r}/${si?"learn-sandbox":"test"}/profile/profile`,d=new URL(l+"?"+a.toString(),n.origin);return d.searchParams.delete("username"),d.searchParams.delete("section"),d.searchParams.delete("detail"),d.searchParams.set("username",o),e&&e!=="activity"?(d.searchParams.set("section",e),t&&d.searchParams.set("detail",t)):d.searchParams.delete("section"),d}var km={bookmarks:{pressed:"single-bookmark-solid",unpressed:"single-bookmark"},collection:{pressed:"circle-addition-solid",unpressed:"circle-addition"},studyguide:{pressed:"book-open",unpressed:"book-solid"}},V_={bookmarks:{pressed:gi,unpressed:fi},collection:{pressed:Ri,unpressed:Pi},studyguide:{pressed:Nc,unpressed:zc}};function Am(o,e){return`docon-${e?km[o].pressed:km[o].unpressed}`}function G_(o,e,t){return V_[o][e?"pressed":"unpressed"].replace(/\{title\}/g,t)}function K_(o,e,t,n){o.setAttribute("data-pressed",n.toString()),o.setAttribute("title",G_(e,n,t));let r=o.querySelector(".docon");if(!r)throw new Error("Expected list button to contain a docon");if(r.classList.remove(Am(e,!n)),r.classList.add(Am(e,n)),e==="collection"){let s=o.querySelector(".collection-status, .add-to-collection-status");s&&(s.textContent=n?wc:Po)}}function Im(o){if(!ce.userServices){Array.from(o.querySelectorAll("button[data-list-type]")).forEach(t=>t.hidden=!0);return}Rm(o),o.addEventListener("click",Y_)}async function Rm(o,e=M.isAuthenticated){let t=Array.from(o.querySelectorAll("button[data-list-type]")).map(s=>Pm(s)).filter(s=>s!==null);if(t.length===0)return;let n=t.map(s=>s.url).filter((s,a,i)=>s&&i.indexOf(s)===a),r=e?await it.getAllListsByUrl(n):[];for(let{button:s,type:a,url:i,title:c}of t){let l=W_(i,r);K_(s,a,c,l)}}function W_(o,e){return e.findIndex(t=>t.url===o&&t.lists.length>0)!==-1}async function Y_(o,e=M.isAuthenticated){let t=Pm(o.target);if(t!==null){if(o.preventDefault(),!e){j_();return}Q_(t)}}function Pm(o){let e=o instanceof Element&&o.closest("button");if(!e)return null;let t=e.getAttribute("data-list-type");if(t!=="collection")return null;let n=e.getAttribute("data-list-item-url")||location.href,r=e.getAttribute("data-list-item-title")||k.title,s=Gn(n),a=e.getAttribute("data-pressed")==="true",i=e.getAttribute("data-list-source")||"module";return{button:e,type:t,url:s,title:r,pressed:a,source:i}}async function j_(){let e=Cm(Ii,null,Lo);(await wm(e)).submitted&&zr()}async function Q_({button:o,url:e,title:t}){if(!o.classList.contains("is-loading")){o.classList.add("is-loading");try{J_(e,t)}finally{o.classList.remove("is-loading")}}}function Xa(o,e="added",t=[]){let n=k.querySelectorAll("#collections input:checked"),r=Em(M.userName,o,e==="removed"&&t.length!==0?t.length===1?t[0]:"":n.length===1?n.item(0).getAttribute("id"):"").href,s={"is-hidden":!1},a;e==="added"?a=(n.length!==1?Ai:ki.replace("{collectionName}",vn(n.item(0).getAttribute("name")))).replace("{url}",r):e==="removed"?a=(t.length>1?Ei:Ci.replace("{collectionName}",vn(k.querySelector(`#collections input[id="${t[0]}"]`).getAttribute("name")))).replace("{url}",r):a=xi.replace("{url}",r);let i=h` <div
		class="has-background-dark-opacity has-text-tertiary-invert is-full-width"
	>
		<div class="uhf-container">
			<div class="level padding-block-xxs">
				<div
					class="is-full-width level-item has-line-height-reset has-text-overlay-invert margin-top-xxs margin-right-xs margin-top-none-tablet margin-right-none-tablet"
				>
					<span
						aria-hidden="true"
						class="icon is-small is-rounded has-background-tertiary-invert has-text-tertiary ${la(s)}"
					>
						<span class="font-size-xs docon docon-check"></span>
					</span>
					<span class="message margin-left-xxs"> ${Re(a)} </span>
				</div>
				<div class="level-right">
					<button
						data-dismiss
						type="button"
						class="dismiss delete delete-lg position-absolute position-relative-tablet top-0 right-0 margin-xxs margin-none-tablet"
						aria-label="${Ao}"
					>
						<span class="docon docon-navigate-close" aria-hidden="true"></span>
					</button>
				</div>
			</div>
		</div>
	</div>`,c=k.createElement("div");U(i,c),new Ja(c).show()}async function J_(o,e){let t=k.querySelector(".modal");if(t&&!t.querySelector(".page-actions-menu"))return!1;let n=k.createElement("div");n.classList.add("modal-content");let r=new Ee(n),s=[];return U(ym(r,e,o,()=>{X_(s.map(a=>a.listId))}),n),s=await Qa(n,o),r.show()}function X_(o){Rm(k.body);let e=Array.from(k.querySelectorAll("#collections input:checked")).map(r=>r.id),t=e.filter(r=>!o.includes(r)),n=o.filter(r=>!e.includes(r));t.length>0&&n.length===0?Xa("collections","added"):t.length===0&&n.length>0?Xa("collections","removed",n):t.length>0&&n.length>0&&Xa("collections","updated")}dm();Qd();um();id();op();ep();sp();md();ip();qp();Ad();ie.then(()=>{setTimeout(()=>{jd(),Pl(),pm(),Dl(),Ld(),Od(),lp(),Ud()},10),Vd(),Gd(),hd(),_d(),xd(),bd(),vd(),yd(),Td(),kd(),Id(),Sd(),Hp(),ap(),Ed(),Hd(),Jd(),tp(),Yd(),np(),Wd(),Bp(),Xd(),gd(document.body),Im(document.body),Dp(),wd(),Cd(),cp(),Rd(),Pd(),Nd(),pd(),Md(),zd(),Dd(),Fd()});})();
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! @azure/msal-browser v2.22.1 2022-03-07 */
/*! @azure/msal-common v6.1.0 2022-02-08 */
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
