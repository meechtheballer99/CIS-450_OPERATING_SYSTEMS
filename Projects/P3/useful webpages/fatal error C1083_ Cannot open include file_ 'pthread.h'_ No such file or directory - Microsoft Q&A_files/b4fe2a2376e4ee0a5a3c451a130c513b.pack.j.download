var attachmentsSectionHelper={init:function(a){var b=a.$textarea;if(!a.$container&&(a.$container=b.closest("form").find(".main-attachments-container"),0==a.$container.size()))return null;var c=new AttachmentsSection(a);b.on("teamhubEdit.attachments.added",function(a,b){c.addAttachment(b)});return c}};
function AttachmentsSection(a){this.$container=a.$container;this.$imageAttachmentContainer=this.$container.find(".img-attachments-container");this.$fileAttachmentContainer=this.$container.find(".attachments-container");this.$textarea=a.$textarea;0<this.$container.find("script[data-attachments]").size()&&(a=JSON.parse(this.$container.find("script[data-attachments]").text()),this.addAllAttachments(a))}
AttachmentsSection.prototype.addAttachment=function(a){this.$container.slideDown();var b=$('\x3cbutton class\x3d"node-attachment-delete" href\x3d"#"\x3e\x3cspan class\x3d"sr-only"\x3e'+pageContext.i18n.removeAttachment+'\x3c/span\x3e\x3ci aria-hidden\x3d"true" class\x3d"icon-remove"\x3e\x3c/i\x3e\x3c/button\x3e');b.attr("data-fileUrl",a.url);var c=this;b.on("click",function(b){c.$textarea.teamhubEdit("editor").removeAttachment&&(b.preventDefault(),c.$textarea.teamhubEdit("editor").removeAttachment(a.urlFileName));
c.removeAttachment(a.urlFileName)});if(a.isImage){$el=$('\x3cdiv class\x3d"img-node-attachment attachment"\x3e\x3c/div\x3e');var d=$('\x3ca href\x3d"'+a.url+'" target\x3d"_blank"\x3e\x3c/a\x3e');d.append($('\x3cimg alt\x3d"'+a.fileName+'" src\x3d"'+a.url+'" width\x3d"100" /\x3e'));d.append($("\x3cspan\x3e"+a.fileName+"("+a.size+")\x3c/span\x3e"));$el.append(d);$el.append($('\x3cinput type\x3d"hidden" name\x3d"attachments" value\x3d"'+a.fileId+'" /\x3e'));$el.append(b);this.$imageAttachmentContainer.append($el)}else $el=
$('\x3cdiv class\x3d"node-attachment attachment"\x3e\x3c/div\x3e'),$el.append('\x3cspan class\x3d"attachment-icon"\x3e\x3c/span\x3e'),$el.append($('\x3ca href\x3d"'+a.url+'" target\x3d"_blank"\x3e'+a.fileName+"\x3c/a\x3e")),$el.append($("\x3cspan\x3e ("+a.size+")\x3c/span\x3e")),$el.append($('\x3cinput type\x3d"hidden" name\x3d"attachments" value\x3d"'+a.fileId+'" /\x3e')),$el.append(b),this.$fileAttachmentContainer.append($el)};
AttachmentsSection.prototype.removeAttachment=function(a){var b=this.$container.find('.node-attachment-delete[data-fileUrl$\x3d"/'+a+'"]').parent();a=b.find("input[type\x3dhidden]").val();$.getJSON(pageContext.url.cancelUpload,{file:a});var c=this.$container;b.fadeOut("fast",function(){b.remove();1>c.find(".img-node-attachment").length&&1>c.find(".node-attachment").length&&c.slideUp()})};AttachmentsSection.prototype.addAllAttachments=function(a){for(var b in a)this.addAttachment(a[b])};
AttachmentsSection.prototype.clear=function(){this.$fileAttachmentContainer.empty();this.$imageAttachmentContainer.empty();this.$container.hide()};AttachmentsSection.prototype.addError=function(a){this.clearErrors();this.$container.addClass("error");this.$container.append('\x3cspan class\x3d"help-inline"\x3e'+a+".\x3c/span\x3e")};AttachmentsSection.prototype.clearErrors=function(){this.$container.find("span.help-inline").remove()};
function getAuthorizeContext(a){var b=[];$("#main-attachments-container").find("input[name\x3dattachments]").each(function(){b.push($(this).val())});var c={};$.extend(c,pageContext.authorizeUploadContext);0<b.length&&(c.current=b);a&&(c.image=a);return c}function replaceAttachmentUrl(a){var b=a.val();a.val(b.replace(/(\/storage\/|\/storage\/[^\/]+\/)temp\//gi,"$1attachments/"))}
$(document).ready(function(){$(".widget-content form").each(function(a,b){$(b).submit(function(a){a=$(b).find(".redactor")||null;null!==a&&a.is("textarea")&&replaceAttachmentUrl(a)})})});
register_command("voteInList",{onSuccess:function(a){$("#post-"+this.nodeId+"-score-wrapper").html(a.result.score);"on"===this.getStatus()?(this.element.addClass("btn-outline btn-outline-primary"),this.element.removeClass("btn-primary"),$("."+this.nodeId+"-vote-action-performed").text(pageContext.i18n.voteCancelled+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score)):(this.element.removeClass("btn-outline").removeClass("btn-outline-primary"),this.element.addClass("btn-primary"),$("."+this.nodeId+
"-vote-action-performed").text(pageContext.i18n.contentUpVoted+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score));$("#refresh-votes").click()}});
register_command("voteUpInList",{onSuccess:function(a){$("#post-"+this.nodeId+"-score-wrapper").find("span").html(a.result.score);$("#idea-vote-down-"+this.nodeId).removeClass("on");$("#refresh-votes").click();$("#idea-vote-up-"+this.nodeId+" .sr-only")&&(a.result.cancelVoteAction?($("#idea-vote-up-"+this.nodeId+" .sr-only").text(pageContext.i18n.voteUp),$("."+this.nodeId+"-vote-action-performed").text(pageContext.i18n.voteCancelled+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score)):
($("#idea-vote-up-"+this.nodeId+" .sr-only").text(pageContext.i18n.cancelUpVote),$("."+this.nodeId+"-vote-action-performed").text(pageContext.i18n.contentUpVoted+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score),!$("#idea-vote-down-"+this.nodeId+" .sr-only").length||$("#idea-vote-down-"+this.nodeId+" .sr-only").text(pageContext.i18n.voteDown)))}});
register_command("voteDownInList",{onSuccess:function(a){$("#post-"+this.nodeId+"-score-wrapper").find("span").html(a.result.score);$("#idea-vote-up-"+this.nodeId).removeClass("on");$("#idea-vote-down-"+this.nodeId+" .sr-only")&&(a.result.cancelVoteAction?($("#idea-vote-down-"+this.nodeId+" .sr-only").text(pageContext.i18n.voteDown),$("."+this.nodeId+"-vote-action-performed").text(pageContext.i18n.voteCancelled+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score)):(!$("#idea-vote-up-"+this.nodeId+
" .sr-only").length||$("#idea-vote-up-"+this.nodeId+" .sr-only").text(pageContext.i18n.voteUp),$("."+this.nodeId+"-vote-action-performed").text(pageContext.i18n.contentDownVoted+" "+pageContext.i18n.currentNumberOfLikes+": "+a.result.score),$("#idea-vote-down-"+this.nodeId+" .sr-only").text(pageContext.i18n.cancelDownVote)))}});
register_command("ideaStatus",{execute:function(a){var b=this,d=b.getStatus(),c=ideasStatuses;c||(c=["none","submitted","started","completed"]);c=$.grep(c,function(a){return d!=a});c={statuses:c,description:b.getMessage("description"),reportHints:b.getMessage("reportHints"),statusNames:b.getMessage("statusNames")};commandUtils.showPrompt(a,"change-idea-status-dialog",c,{returnEle:this.element,beforeShow:function(a){var b=a.find("select[name\x3d'status']"),c=a.find("select[name\x3d'reason']");b.change(function(b){b=
$(b.target).val();0<reportHints[b].length?(a.find(".reasons-container select[name\x3d'reason']").empty(),$.each(reportHints[b],function(b,c){a.find(".reasons-container select[name\x3d'reason']").append('\x3coption value\x3d"'+c.name+'"\x3e'+c.label+"\x3c/option\x3e")}),a.find(".reasons-container").show(),a.find(".reasons-container select[name\x3d'reason']").trigger("change")):($("select[name\x3d'reason']").val(""),a.find(".reasons-container").hide(),a.find(".other-comments-container").hide(),a.find(".other-comments-container textarea").val(""))});
c.change(function(b){var c=$(b.target).val();b=a.find("select[name\x3d'status']");var d=!1;$.each(reportHints[b.val()],function(a,b){c==b.name&&"true"==b.allowExtraComments&&(d=!0)});d?a.find(".other-comments-container").show():(a.find(".other-comments-container").hide(),a.find(".other-comments-container textarea").val(""))});if(0<reportHints[b.val()].length){a.find(".reasons-container select[name\x3d'reason']").empty();$.each(reportHints[b.val()],function(b,c){a.find(".reasons-container select[name\x3d'reason']").append('\x3coption value\x3d"'+
c.name+'"\x3e'+c.label+"\x3c/option\x3e")});a.find(".reasons-container").show();var d=a.find(".reasons-container select[name\x3d'reason']").val(),e=!1;e=!1;$.each(reportHints[b.val()],function(a,b){d==b.name&&"true"==b.allowExtraComments&&(e=!0)});e?a.find(".other-comments-container").show():(a.find(".other-comments-container").hide(),a.find(".other-comments-container textarea").val(""))}else a.find(".reasons-container").hide(),a.find(".other-comments-container textarea").val(""),a.find(".other-comments-container").hide()},
onOk:function(a){b.executeRequest(a)}})},onSuccess:function(a,b){this.setStatus(a.result.setStatusAction.extra+","+a.result.setStatusActionReason)},onCompleted:function(a,b){a&&(this.updateTitle(),0<$(".idea-container .idea.post div:first").find(".idea-status-label").length&&(a=pageContext.i18n.ideaStatusAlert.replace("$n",'"'+this.getStatus().split(",")[0]+'"'),commandUtils.AccessibleUI.showAlert(a,{transition:{duration:500},selector:".mainContent",alert_type:"info",replace:".mainContent .alert"})))},
updateTitle:function(){if("none"!=this.getStatus()){var a=this.getStatus().split(","),b=a[0];a=a[1];var d=this.shouldShowReason?this.shouldShowReason:globalShouldShowReason;$(".idea-container .idea.post div:first .idea-status-label").remove();$(".idea-container .idea.post div:first .middot").remove();"none"!=b&&(b='\x3ca href\x3d"'+pageContext.url.ideasByState.replace(encodeURIComponent("%STATE%"),b)+'" class\x3d"idea-status-label label '+b+'"\x3e\x3cspan class\x3d"sr-only"\x3e'+pageContext.i18n.ideaStatusLabel+
" \x3c/span\x3e"+commands.ideaStatus.getMessage("statusNames")[b],d&&a&&"none"!=a&&(b+=" - "+a),b+="\x3c/a\x3e",$(".idea-container .idea.post div:first").append($("\x3cspan/\x3e").addClass("middot").append("\u00b7"),$(b)))}}});
register_command("viewIdeaStateHistoryCommand",{getRequestMethod:function(){return"GET"},onSuccess:function(a,b){a={history:a.result.history,description:this.getMessage("description")};commandUtils.showPrompt(b,"view-idea-status-history-dialog",a,{returnEle:this.element,title:"Idea Status History",show_yes:!1,show_no:!1})},onCompleted:function(a,b){}});
$(function(){var a=commands.voteUp.onSuccess;commands.voteUp.onSuccess=function(){a.apply(this,arguments);$("#refresh-votes").click()};var b=commands.voteDown.onSuccess;commands.voteDown.onSuccess=function(){b.apply(this,arguments);$("#refresh-votes").click()}});
jQuery.extend({createUploadIframe:function(b,l){b="jUploadFrame"+b;if(window.ActiveXObject){var n=document.createElement('\x3ciframe id\x3d"'+b+'" name\x3d"'+b+'" /\x3e');"boolean"==typeof l?n.src="javascript:false":"string"==typeof l&&(n.src=l)}else n=document.createElement("iframe"),n.id=b,n.name=b;n.style.position="absolute";n.style.top="-1000px";n.style.left="-1000px";document.body.appendChild(n);return n},createUploadForm:function(b,l){var n="jUploadForm"+b;b="jUploadFile"+b;n=$('\x3cform  action\x3d"" method\x3d"POST" name\x3d"'+
n+'" id\x3d"'+n+'" enctype\x3d"multipart/form-data"\x3e\x3c/form\x3e');l=$("#"+l);var t=$(l).clone();$(l).attr("id",b);$(l).before(t);$(l).appendTo(n);$(n).css("position","absolute");$(n).css("top","-1200px");$(n).css("left","-1200px");$(n).appendTo("body");return n},ajaxFileUpload:function(b){b=jQuery.extend({},jQuery.ajaxSettings,b);var l=(new Date).getTime(),n=jQuery.createUploadForm(l,b.fileElementId);jQuery.createUploadIframe(l,b.secureuri);var t="jUploadFrame"+l;l="jUploadForm"+l;b.global&&
!jQuery.active++&&jQuery.event.trigger("ajaxStart");var q=!1,p={};b.global&&jQuery.event.trigger("ajaxSend",[p,b]);var v=function(m){var h=document.getElementById(t);try{h.contentWindow?(p.responseText=h.contentWindow.document.body?h.contentWindow.document.body.innerText:null,p.responseXML=h.contentWindow.document.XMLDocument?h.contentWindow.document.XMLDocument:h.contentWindow.document):h.contentDocument&&(p.responseText=h.contentDocument.document.body?h.contentDocument.document.body.textContent||
document.body.innerText:null,p.responseXML=h.contentDocument.document.XMLDocument?h.contentDocument.document.XMLDocument:h.contentDocument.document)}catch(w){jQuery.handleError(b,p,null,w)}if(p||"timeout"==m){q=!0;try{var l="timeout"!=m?"success":"error";if("error"!=l){var v=jQuery.uploadHttpData(p,b.dataType);b.success&&b.success(v,l);b.global&&jQuery.event.trigger("ajaxSuccess",[p,b])}else jQuery.handleError(b,p,l)}catch(w){l="error",jQuery.handleError(b,p,l,w)}b.global&&jQuery.event.trigger("ajaxComplete",
[p,b]);b.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");b.complete&&b.complete(p,l);jQuery(h).unbind();setTimeout(function(){try{$(h).remove(),$(n).remove()}catch(w){jQuery.handleError(b,p,null,w)}},100);p=null}};0<b.timeout&&setTimeout(function(){q||v("timeout")},b.timeout);try{n=$("#"+l),$(n).attr("action",b.url),$(n).attr("method","POST"),$(n).attr("target",t),n.encoding?n.encoding="multipart/form-data":n.enctype="multipart/form-data",$(n).submit()}catch(m){jQuery.handleError(b,p,null,
m)}window.attachEvent?document.getElementById(t).attachEvent("onload",v):document.getElementById(t).addEventListener("load",v,!1);return{abort:function(){}}},uploadHttpData:function(b,l){b="xml"!=l&&l?b.responseText:b.responseXML;"script"==l&&jQuery.globalEval(b);"json"==l&&eval("data \x3d "+b);"html"==l&&jQuery("\x3cdiv\x3e").html(b).evalScripts();return b}});
function ajaxFileUpload(b){$("#loading").ajaxStart(function(){$(this).show()}).ajaxComplete(function(){$(this).hide()});$("#upload").ajaxStart(function(){$(this).hide()}).ajaxComplete(function(){$(this).show()});$.ajaxFileUpload({url:"/upload/",secureuri:!1,fileElementId:"file-upload",dataType:"xml",success:function(l,n){n=$(l).find("file_url").text();l=$(l).find("error").text();""!=l?alert(l):b.attr("value",n)},error:function(b,n,t){alert(t)}});return!1}var d=new Date;d.setTime(d.getTime()+864E5);
var expires="expires\x3d"+d.toUTCString();function createCookie(b,l,n){localStorage.setItem(b,l)}function readCookie(b){return localStorage.getItem(b)}function eraseCookie(b){localStorage.removeItem(b)}
function createWmd(b){b.wmdBase=function(l,n,t){var q=top.document,p=top.RegExp,v=top.navigator;b.Util={};b.Position={};b.Command={};b.Global={};b.KeysDown=[];b.TabOrder=[];b.TabIndex={active:0};var m=b.Util;n=b.Position;var h=b.Command,r=b.Global,x=b.KeysDown,w=b.TabOrder,y=b.TabIndex;r.isIE=/msie/.test(v.userAgent.toLowerCase());r.isIE_5or6=/msie 6/.test(v.userAgent.toLowerCase())||/msie 5/.test(v.userAgent.toLowerCase());r.isIE_7plus=r.isIE&&!r.isIE_5or6;r.isIE_9=/msie 9/.test(v.userAgent.toLowerCase());
r.isOpera=/opera/.test(v.userAgent.toLowerCase());r.isKonqueror=/konqueror/.test(v.userAgent.toLowerCase());$.i18n._("bold");$.i18n._("italic");$.i18n._("link");$.i18n._("quote");$.i18n._("preformatted text");$.i18n._("image");$.i18n._("numbered list");$.i18n._("bulleted list");$.i18n._("heading");$.i18n._("horizontal bar");$.i18n._("undo");$.i18n._("redo");var C=pageContext.i18n.WMDImageDialogText,D=pageContext.i18n.WMDLinkDialogText;mediaUrl("media/images/indicator.gif");b.PanelCollection=l?function(){this.buttonBar=
l.buttonBar;this.preview=l.preview;this.output=l.output;this.input=l.input}:function(){this.buttonBar=q.getElementById("wmd-button-bar");this.preview=q.getElementById("previewer");this.output=q.getElementById("wmd-output");this.input=q.getElementById("body")};b.panels=void 0;b.ieCachedRange=null;b.ieRetardedClick=!1;m.isVisible=function(a){if(window.getComputedStyle)return"none"!==window.getComputedStyle(a,null).getPropertyValue("display");if(a.currentStyle)return"none"!==a.currentStyle.display};
m.changeTabIndex=function(a,b){y.active=b;b=w[b];$.each($(a).find(".wmd-button-elem"),function(a,b){$(b).attr("tabindex","-1")});a=$(a).find("."+b+" .wmd-button-elem");a.length&&(a[0].setAttribute("tabindex","0"),a.focus())};b.attachedEvents=[];m.addEvent=function(a,e,c){a.attachEvent?a.attachEvent("on"+e,c):a.addEventListener(e,c,!1);b.attachedEvents.push([a,e,c])};m.removeEvent=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)};m.removeAllEvents=function(){for(index in b.attachedEvents)m.removeEvent(b.attachedEvents[index][0],
b.attachedEvents[index][1],b.attachedEvents[index][2])};m.fixEolChars=function(a){a=a.replace(/\r\n/g,"\n");return a=a.replace(/\r/g,"\n")};m.extendRegExp=function(a,b,c){if(null===b||void 0===b)b="";if(null===c||void 0===c)c="";a=a.toString();var e=a.match(/\/([gim]*)$/);e=null===e?e[0]:"";a=a.replace(/(^\/|\/[gim]*$)/g,"");return new RegExp(b+a+c,e)};m.createImage=function(a){a="images/"+a;var b=q.createElement("img");b.className="wmd-button";b.src=a;return b};m.prompt=function(a,b,c,g){a='\x3cspan\x3e\x3clabel class\x3d"h3" for\x3d"wmd-image-path-input"\x3e'+
a+'\x3c/label\x3e\x3cinput id\x3d"wmd-image-path-input" type\x3d"text" size\x3d"40" value\x3d"http://" /\x3e\x3c/span\x3e';var e=null;g?(e=commandUtils.createUploadDialogNodes(!0,!0),e.find(".h3").before(a)):e=a;var k=e.find("input")[0];commandUtils.showDialog({nodes:e,yes_callback:function(a,b){a=a.find("input").val();a=a.replace("http://http://","http://");a=a.replace("http://https://","https://");a=a.replace("http://ftp://","ftp://");-1===a.indexOf("http://")&&-1===a.indexOf("ftp://")&&-1===a.indexOf("https://")&&
(a="http://"+a);c(a);b();inputBox.focus()},show_no:!0,onAfterShow:function(){var a=b.length;if(void 0!==k.selectionStart)k.selectionStart=0,k.selectionEnd=a;else if(k.createTextRange){var c=k.createTextRange();c.collapse(!1);c.moveStart("character",-a);c.moveEnd("character",a);c.select()}k.focus()}})};n.getTop=function(a,b){var c=a.offsetTop;if(!b)for(;a=a.offsetParent;)c+=a.offsetTop;return c};n.getHeight=function(a){return a.offsetHeight||a.scrollHeight};n.getWidth=function(a){return a.offsetWidth||
a.scrollWidth};n.getPageSize=function(){if(self.innerHeight&&self.scrollMaxY){var a=q.body.scrollWidth;var b=self.innerHeight+self.scrollMaxY}else q.body.scrollHeight>q.body.offsetHeight?(a=q.body.scrollWidth,b=q.body.scrollHeight):(a=q.body.offsetWidth,b=q.body.offsetHeight);if(self.innerHeight){var c=self.innerWidth;var g=self.innerHeight}else q.documentElement&&q.documentElement.clientHeight?(c=q.documentElement.clientWidth,g=q.documentElement.clientHeight):q.body&&(c=q.body.clientWidth,g=q.body.clientHeight);
return[Math.max(a,c),Math.max(b,g),c,g]};b.inputPoller=function(a,e){var c=this,g=b.panels.input,f;0<$(g.parentNode).find(".keyboard-hint").length&&(f=!0);f||($("\x3cspan\x3e\x3c/span\x3e").addClass("hint-label keyboard-hint").text(pageContext.i18n.WMDEditorTabHint).insertAfter($(g)),f=g.id,f=$(g).attr("aria-label")||$("label[for\x3d"+f+"]").text()||"",$(g).attr("aria-label",f+=" "+pageContext.i18n.WMDEditorSRTabHint));var k,h,u;this.tick=function(){if(m.isVisible(g)){if(g.selectionStart||0===g.selectionStart){var a=
g.selectionStart,b=g.selectionEnd;if(a!=k||b!=h)if(k=a,h=b,u!=g.value)return u=g.value,!0}return!1}};this.destroy=function(){top.clearInterval(l)};var l=top.setInterval(function(){m.isVisible(g)&&c.tick()&&a()},e)};b.undoManager=function(a){var e=this,c=[],g=0,f="none",k,l,u,n,p=function(a,b){f!=a&&(f=a,b||A());r.isIE&&"moving"==f?n=null:u=top.setTimeout(q,1)},q=function(){n=new b.TextareaState;l.tick();u=void 0};this.setCommandMode=function(){f="command";A();u=top.setTimeout(q,0)};this.canUndo=function(){return 1<
g};this.canRedo=function(){return c[g+1]?!0:!1};this.undo=function(){e.canUndo()&&(k?(k.restore(),k=null):(c[g]=new b.TextareaState,c[--g].restore(),a&&a()));f="none";b.panels.input.focus();q()};this.redo=function(){e.canRedo()&&(c[++g].restore(),a&&a());f="none";b.panels.input.focus();q()};var A=function(){var e=n||new b.TextareaState;if(!e)return!1;"moving"==f?k||(k=e):(k&&(c[g-1].text!=k.text&&(c[g++]=k),k=null),c[g++]=e,c[g+1]=null,a&&a())},F=function(a){var b=!1;if(a.ctrlKey||a.metaKey)switch(String.fromCharCode(a.charCode||
a.keyCode)){case "y":e.redo();b=!0;break;case "z":a.shiftKey?e.redo():e.undo(),b=!0}b&&(a.preventDefault&&a.preventDefault(),top.event&&(top.event.returnValue=!1))},z=function(a){a.ctrlKey||a.metaKey||(a=a.keyCode,33<=a&&40>=a||63232<=a&&63235>=a?p("moving"):8==a||46==a||127==a?p("deleting"):13==a?p("newlines"):27==a?p("escape"):(16>a||20<a)&&91!=a&&p("typing"))};this.destroy=function(){l&&l.destroy()};(function(){m.addEvent(b.panels.input,"keypress",function(a){!a.ctrlKey&&!a.metaKey||89!=a.keyCode&&
90!=a.keyCode||a.preventDefault()});var a=function(){(r.isIE||n&&n.text!=b.panels.input.value)&&void 0==u&&(f="paste",A(),q());c(event);var a=b.panels.input.form.id;"fmanswer"==a&&(a+="-"+$("#question-table").attr("nodeid"));eraseCookie(a);createCookie(a,b.panels.input.value,expires)};const c=function(a){if(void 0!==a){var c=a.clipboardData||a.originalEvent.clipboardData||window.clipboardData,e=c.items;c.getData("text");let g=null;c=!1;let f={returnEle:$(b.panels.input)};for(let a=0;a<e.length;a++)"string"==
e[a].kind&&e[a].type.match("^text/plain")&&(c=!0),"file"==e[a].kind&&e[a].type.match("^image/")&&(c=!1,g=e[a].getAsFile());if(null!==g){a.preventDefault();(new FileReader).readAsDataURL(g);let c=null;Object.assign(f,{authorizeUrl:pageContext.url.authorizeAttachmentsUrl,authorizeContext:t.authorize(!0),onSuccess:function(a,c){t.toForm(c);{var e=c.url;a=new b.TextareaState;c=a.getChunks();var f=" [999]: "+e;const g=(new b.previewManager).refresh;e=e.replace(/\s/g,"+");c.startTag=c.endTag="";f=h.addLinkDef(c,
f);c.startTag="![";c.endTag="]["+f+"]";c.selection||(f=document.createElement("a"),f.href=e,e=f.pathname.endsWith("/")?f.pathname.slice(0,-1):f.pathname,c.selection=0===e.length?f.hostname:e.substr(e.lastIndexOf("/")+1));b.panels.input.focus();a.setChunks(c);a.restore();g();"function"==typeof autoSaveRoot?autoSaveRoot():"function"==typeof autoSave&&autoSave($(inputBox))}}});commandUtils.createUploadTracker(f.authorizeUrl,f.authorizeContext,{onAuthorize:function(a,b){if(a){c=b;a=new FormData;const e=
new XMLHttpRequest;a.append("file",g,g.name);e.open("POST",pageContext.url.uploadFile+"?"+pageContext.csrf.parameter+"\x3d"+pageContext.csrf.getToken()+"\x26trackingId\x3d"+b);e.send(a)}else commandUtils.showMessage(evt,b)},onSuccess:function(b){function e(){if(f.onSuccess)f.onSuccess(c,b.result)}if(!b.result.isImage||void 0!=f.disableCrop&&f.disableCrop)e();else{let c=f.previewDialogOptions?f.previewDialogOptions:{returnEle:f.returnEle};Object.assign(c,{fileData:b.result,onSuccess:function(){e()}});
commandUtils.showPreviewAndCropDialog(a,c)}},onError:function(b){b.errors&&b.errors.error&&commandUtils.showMessage(a,b.errors.error,null,f.returnEle,pageContext.i18n.uploadDialog.imageUploadFailed)}})}else c||(e=pageContext.i18n.WMDImageUploadOnly+" "+pageContext.i18n.uploadDialog.invalidImageType.replace("imageTypes",pageContext.authorizedImageTypes.join(", "))+".",commandUtils.showMessage(a,e,null,f.returnEle,pageContext.i18n.uploadDialog.uploadFailed))}};l=new b.inputPoller(a,100);m.addEvent(b.panels.input,
"keydown",F);m.addEvent(b.panels.input,"keydown",z);m.addEvent(b.panels.input,"keyup",function(){var a=$(this).closest("form").attr("id");"fmanswer"==a&&(a+="-"+$("#question-table").attr("nodeid"));eraseCookie(a);createCookie(a,b.panels.input.value,expires)});m.addEvent(b.panels.input,"mousedown",function(){p("moving")});b.panels.input.onpaste=a;b.panels.input.ondrop=a})();q();A()};b.editor=function(a){a||(a=function(){});var e=b.panels.input,c=b.panels.buttonBar,g=this,f,k=function(c){e.focus();
c=c.childNodes&&0<c.childNodes.length?c.childNodes[0]:c;if(c.textOp){f&&f.setCommandMode();var k=new b.TextareaState;if(!k)return;var z=k.getChunks(),h=function(b){e.focus();z&&k.setChunks(z);k.restore();a();"function"==typeof autoSaveRoot?autoSaveRoot():"function"==typeof autoSave&&autoSave($(e));b&&(b=k.end+z.endTag.length,k.start=b,k.end=b,k.setInputAreaSelection())};c.textOp(z,h,!0)||h();h=b.panels.input.form.id;"fmanswer"==h&&(h+="-"+$("#question-table").attr("nodeid"));eraseCookie(h);createCookie(h,
b.panels.input.value,expires)}c.execute&&c.execute(g)},n=null,u=null,p=function(){f&&(B(n,f.canUndo()),B(u,f.canRedo()))},B=function(a,c){var e=a.childNodes[0];c?(a.style.backgroundPosition=a.XShift+" 0px",e&&(e.setAttribute("aria-disabled",!1),e.onmouseover=function(){a.style.backgroundPosition=this.XShift+" -40px"},e.onmouseout=function(){a.style.backgroundPosition=a.XShift+" 0px"},r.isIE&&(e.onmousedown=function(){b.ieRetardedClick=!0;b.ieCachedRange=document.selection.createRange()}),a.isHelp||
(e.onclick=function(b){b.preventDefault();if(this.onmouseout)this.onmouseout();k(a);return!1}))):(a.style.backgroundPosition=a.XShift+" -20px",!e||e.setAttribute("aria-disabled",!0),e.onmouseover=e.onmouseout=e.onclick=function(){})},E=function(){var a=function(a,c){var b=document.createElement("span");b.className="wmd-spacer wmd-spacer"+a;b.setAttribute("aria-hidden","true");b.setAttribute("role","presentation");c.appendChild(b)},c=function(a,b){listItem=function(a,b){b={name:b.name,title:b.title||
"",ariaLabel:b.ariaLabel||b.title,ariaDesc:b.ariaDesc||"",XShift:b.XShift||0,class:b.class||"",execute:!0===b.execute||!1,href:b.href||!1,target:b.target||!1,isHelp:b.isHelp||!1};var c=document.createElement("li");c.setAttribute("role","presentation");c.className="wmd-button "+b.class;c.XShift=b.XShift;c.isHelp=b.isHelp;var f=b;if(f.href){var g=document.createElement("a");g.href=f.href;!f.target||(g.target=f.target)}else g=document.createElement("input"),g.type="button",g.setAttribute("aria-roledescription",
"button"),g.setAttribute("role","radio"),f.execute?g.execute=a:g.textOp=a,g.className="wmd-button-elem",w.push(f.class),g.setAttribute("tabindex","-1");g.setAttribute("aria-label",f.ariaLabel);c.appendChild(g);f.ariaDesc&&(a=document.createElement("span"),a.textContent=f.ariaDesc,a.className="sr-only wmd-sr-only-desc",a.id=e.id+"-"+b.name,c.appendChild(a),g.setAttribute("aria-describedby",a.id));g.title=f.title;return c}(a,b);(function(a){B(a,!0);k.appendChild(a);g[b.name]=a})(listItem)},f=$(l?l.buttonBar:
document.getElementById("wmd-button-bar"));f.addClass("wmd-button-bar");var g={},k=$("\x3cul role\x3d'toolbar' tabindex\x3d'0' aria-label\x3d'"+pageContext.i18n.WMDToolbarLabel+"'\x3e\x3c/ul\x3e");k.addClass("wmd-button-row");f.append(k);k=k.get(0);c(h.doBold,{title:pageContext.i18n.WMDBold,XShift:"-0px",class:"wmd-bold-button",name:"bold",ariaLabel:pageContext.i18n.WMDSRBold,ariaDesc:pageContext.i18n.WMDSRBoldDesc});c(h.doItalic,{title:pageContext.i18n.WMDItalic,XShift:"-20px",class:"wmd-italic-button",
name:"italic",ariaLabel:pageContext.i18n.WMDSRItalic,ariaDesc:pageContext.i18n.WMDSRItalicDesc});a(1,k);c(function(a,b,c){return h.doLinkOrImage(a,b,"link")},{title:pageContext.i18n.WMDLink,XShift:"-40px",class:"wmd-link-button",name:"link",ariaLabel:pageContext.i18n.WMDSRLink,ariaDesc:pageContext.i18n.WMDSRLinkDesc});c(h.doBlockquote,{title:pageContext.i18n.WMDQuote,XShift:"-60px",class:"wmd-quote-button",name:"quote",ariaLabel:pageContext.i18n.WMDSRQuote,ariaDesc:pageContext.i18n.WMDSRQuoteDesc});
c(h.doCode,{title:pageContext.i18n.WMDCode,XShift:"-80px",class:"wmd-code-button",name:"code",ariaLabel:pageContext.i18n.WMDSRCode,ariaDesc:pageContext.i18n.WMDSRCodeDesc});f=$(b.panels.input).attr("data-attachments");!t||null!=f&&"true"!=f||c(function(a,b,c){return h.doLinkOrImage(a,b,"attachment")},{title:pageContext.i18n.WMDAttachment,XShift:"-100px",class:"wmd-attachment-button",name:"attachment",ariaLabel:pageContext.i18n.WMDSRAttachment,ariaDesc:pageContext.i18n.WMDSRAttachmentDesc});c(function(a,
b,c){return h.doLinkOrImage(a,b,"image")},{title:pageContext.i18n.WMDImage,XShift:"-120px",class:"wmd-image-button",name:"image",ariaLabel:pageContext.i18n.WMDSRImage,ariaDesc:pageContext.i18n.WMDSRImageDesc});a(2,k);c(function(a,b,c){return h.doList(a,b,!0,c)},{title:pageContext.i18n.WMDOrderedList,XShift:"-140px",class:"wmd-olist-button",name:"olist",ariaLabel:pageContext.i18n.WMDSROrderedList,ariaDesc:pageContext.i18n.WMDSROrderedListDesc});c(function(a,b,c){h.doList(a,b,!1,c)},{title:pageContext.i18n.WMDUnorderedList,
XShift:"-160px",class:"wmd-ulist-button",name:"ulist",ariaLabel:pageContext.i18n.WMDSRUnorderedList,ariaDesc:pageContext.i18n.WMDSRUnorderedListDesc});c(h.doHeading,{title:pageContext.i18n.WMDHeading,XShift:"-180px",class:"wmd-heading-button",name:"heading",ariaLabel:pageContext.i18n.WMDSRHeading,ariaDesc:pageContext.i18n.WMDSRHeadingDesc});c(h.doHorizontalRule,{title:pageContext.i18n.WMDHorizontalRule,XShift:"-200px",class:"wmd-hr-button",name:"hr",ariaLabel:pageContext.i18n.WMDSRHorizontalRule,
ariaDesc:pageContext.i18n.WMDSRHorizontalRuleDesc});a(3,k);c(function(a){a.undo()},{title:pageContext.i18n.WMDUndo,XShift:"-220px",class:"wmd-undo-button",name:"undo",execute:!0,ariaLabel:pageContext.i18n.WMDSRUndo,ariaDesc:pageContext.i18n.WMDSRUndoDesc});c(function(a){a.redo()},{title:/win/.test(v.platform.toLowerCase())?pageContext.i18n.WMDRedoWin:pageContext.i18n.WMDRedoOther,XShift:"-240px",class:"wmd-redo-button",name:"redo",execute:!0,ariaLabel:/win/.test(v.platform.toLowerCase())?pageContext.i18n.WMDSRRedoWin:
pageContext.i18n.WMDSRRedoOther,ariaDesc:/win/.test(v.platform.toLowerCase())?pageContext.i18n.WMDSRRedoWinDesc:pageContext.i18n.WMDSRRedoOtherDesc});u=g.redo;n=g.undo;p();c(null,{title:pageContext.i18n.WMDHelp,XShift:"-260px",class:"wmd-help-button",name:"help",href:(pageContext.url.base||"")+"/markdown/help.html",target:"_blank",isHelp:!0,ariaLabel:pageContext.i18n.WMDSRHelp,ariaDesc:pageContext.i18n.WMDSRHelpDesc});return g};this.undo=function(){f&&f.undo()};this.redo=function(){f&&f.redo()};this.destroy=
function(){f&&f.destroy();e&&(e.style.marginTop="");top.clearInterval(void 0);m.removeAllEvents()};(function(){/\?noundo/.test(q.location.href)&&(b.nativeUndo=!0);b.nativeUndo||(f=new b.undoManager(function(){a();p()}));var g=E(),u="keydown";r.isOpera&&(u="keypress");m.addEvent(c,"focusout",function(a){if(!c.contains(a.relatedTarget)){a=$(c).find(".wmd-button-elem");for(var b=0;b<a.length;b++)a[b].setAttribute("tabindex","-1")}});m.addEvent(c,"focusin",function(a){$(a.target);$(a.target).hasClass("wmd-button-elem")?
(a=$(a.target).closest(".wmd-button").attr("class").split(" ")[1],a=w.indexOf(a),m.changeTabIndex(c,a)):(a=$(c).find("."+w[y.active]+" .wmd-button-elem"),a.length&&a.focus())});m.addEvent(e,"focusout",function(){x=[]});m.addEvent(c,u,function(a){var b=a.key||a.code;"ArrowRight"!=b&&39!==a.keyCode||y.active+1>=w.length||m.changeTabIndex(c,y.active+1);("ArrowLeft"==b||37===a.keyCode)&&0<y.active&&m.changeTabIndex(c,y.active-1);if("Escape"==b||27===a.keyCode)b=$(a.currentTarget.parentNode).find(".wmd-textarea"),
!b||b.focus();a.shiftKey&&"Tab"===a.key&&($(this).prev().find(":focusable").last().focus(),a.preventDefault())});m.addEvent(e,"keyup",function(a){a=x.indexOf(a.charCode||a.keyCode);0<=a&&x.splice(a,1)});m.addEvent(e,u,function(a){var b=a.charCode||a.keyCode;x.push(b);if((0<=x.indexOf("F10")||0<=x.indexOf(121))&&(0<=x.indexOf("Alt")||0<=x.indexOf(18))){var c=$(a.currentTarget.parentNode).find(".wmd-button-bar ul");!c.length||c[0].focus()}if(a.ctrlKey||a.metaKey){switch(String.fromCharCode(b).toLowerCase()){case "b":k(g.bold);
break;case "i":k(g.italic);break;case "l":k(g.link);break;case "q":k(g.quote);break;case "k":k(g.code);break;case "g":k(g.image);break;case "o":k(g.olist);break;case "u":k(g.ulist);break;case "h":k(g.heading);break;case "r":k(g.hr);break;case "y":k(g.redo);break;case "z":a.shiftKey?k(g.redo):k(g.undo);break;default:return}a.preventDefault&&a.preventDefault();top.event&&(top.event.returnValue=!1)}});m.addEvent(e,"keyup",function(a){a.shiftKey||a.ctrlKey||a.metaKey||13!==(a.charCode||a.keyCode)||(fakeButton=
{},fakeButton.textOp=h.doAutoindent,k(fakeButton))});r.isIE&&m.addEvent(e,"keydown",function(a){if(27===a.keyCode)return!1})})()};b.TextareaState=function(){var a=this,e=b.panels.input;this.init=function(){m.isVisible(e)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=e.scrollTop,!this.text&&e.selectionStart||0===e.selectionStart)&&(this.text=e.value)};this.setInputAreaSelection=function(){if(m.isVisible(e))if(void 0!==e.selectionStart&&!r.isOpera&&!r.isIE_9)e.focus(),e.selectionStart=a.start,
e.selectionEnd=a.end,e.scrollTop=a.scrollTop;else if(q.selection&&(!q.activeElement||q.activeElement===e)){e.focus();var b=e.createTextRange();b.moveStart("character",-e.value.length);b.moveEnd("character",-e.value.length);b.moveEnd("character",a.end);b.moveStart("character",a.start);b.select()}};this.setInputAreaSelectionStartEnd=function(){if((e.selectionStart||0===e.selectionStart)&&!r.isIE_9)a.start=e.selectionStart,a.end=e.selectionEnd;else if(q.selection){a.text=m.fixEolChars(e.value);if(b.ieRetardedClick&&
b.ieCachedRange){var c=b.ieCachedRange;b.ieRetardedClick=!1}else c=q.selection.createRange();var g=m.fixEolChars(c.text),f="\u0007"+g+"\u0007";c.text=f;var k=m.fixEolChars(e.value);c.moveStart("character",-f.length);c.text=g;a.start=k.indexOf("\u0007");a.end=k.lastIndexOf("\u0007")-1;if(f=a.text.length-m.fixEolChars(e.value).length){for(c.moveStart("character",-g.length);f--;)g+="\n",a.end+=1;c.text=g}this.setInputAreaSelection()}};this.restore=function(){void 0!=a.text&&a.text!=e.value&&(e.value=
a.text+"\n");this.setInputAreaSelection();e.scrollTop=a.scrollTop};this.getChunks=function(){var c=new b.Chunks;c.before=m.fixEolChars(a.text.substring(0,a.start));c.startTag="";c.selection=m.fixEolChars(a.text.substring(a.start,a.end));c.endTag="";c.after=m.fixEolChars(a.text.substring(a.end));c.scrollTop=a.scrollTop;return c};this.setChunks=function(a){a.before+=a.startTag;a.after=a.endTag+a.after;r.isOpera&&(a.before=a.before.replace(/\n/g,"\r\n"),a.selection=a.selection.replace(/\n/g,"\r\n"),
a.after=a.after.replace(/\n/g,"\r\n"));this.start=a.before.length;this.end=a.before.length+a.selection.length;this.text=a.before+a.selection+a.after;this.scrollTop=a.scrollTop};this.init()};b.Chunks=function(){};b.Chunks.prototype.findTags=function(a,b){var c=this;if(a){var e=m.extendRegExp(a,"","$");this.before=this.before.replace(e,function(a){c.startTag+=a;return""});e=m.extendRegExp(a,"^","");this.selection=this.selection.replace(e,function(a){c.startTag+=a;return""})}b&&(e=m.extendRegExp(b,"",
"$"),this.selection=this.selection.replace(e,function(a){c.endTag=a+c.endTag;return""}),e=m.extendRegExp(b,"^",""),this.after=this.after.replace(e,function(a){c.endTag=a+c.endTag;return""}))};b.Chunks.prototype.trimWhitespace=function(a){this.selection=this.selection.replace(/^(\s*)/,"");a||(this.before+=p.$1);this.selection=this.selection.replace(/(\s*)$/,"");a||(this.after=p.$1+this.after)};b.Chunks.prototype.addBlankLines=function(a,b,c){void 0===a&&(a=1);void 0===b&&(b=1);a++;b++;var e,f;navigator.userAgent.match(/Chrome/)&&
"X".match(/()./);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag+=p.$1;this.selection=this.selection.replace(/(\n*$)/,"");this.endTag+=p.$1;this.startTag=this.startTag.replace(/(^\n*)/,"");this.before+=p.$1;this.endTag=this.endTag.replace(/(\n*$)/,"");this.after+=p.$1;if(this.before){for(e=f="";a--;)e+="\\n?",f+="\n";c&&(e="\\n*");this.before=this.before.replace(new p(e+"$",""),f)}if(this.after){for(e=f="";b--;)e+="\\n?",f+="\n";c&&(e="\\n*");this.after=this.after.replace(new p(e,
""),f)}};h.prefixes="(?:\\s{4,}|\\s*\x3e|\\s*-\\s+|\\s*\\d+\\.|\x3d|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";h.unwrap=function(a){var b=new p("([^\\n])\\n(?!(\\n|"+h.prefixes+"))","g");a.selection=a.selection.replace(b,"$1 $2")};h.wrap=function(a,b){h.unwrap(a);b=new p("(.{1,"+b+"})( +|$\\n?)","gm");a.selection=a.selection.replace(b,function(a,b){return(new p("^"+h.prefixes,"")).test(a)?a:b+"\n"});a.selection=a.selection.replace(/\s+$/,"")};h.doBold=function(a,b,c){return h.doBorI(a,2,"strong text")};h.doItalic=
function(a,b,c){return h.doBorI(a,1,"emphasized text")};h.doBorI=function(a,b,c){a.trimWhitespace();a.selection=a.selection.replace(/\n{2,}/g,"\n");a.before.search(/(\**$)/);var e=p.$1;a.after.search(/(^\**)/);var f=p.$1;e=Math.min(e.length,f.length);e>=b&&(2!=e||1!=b)?(a.before=a.before.replace(p("[*]{"+b+"}$",""),""),a.after=a.after.replace(p("^[*]{"+b+"}",""),"")):!a.selection&&f?(a.after=a.after.replace(/^([*_]*)/,""),a.before=a.before.replace(/(\s?)$/,""),a.before=a.before+f+p.$1):(a.selection||
f||(a.selection=c),b=1>=b?"*":"**",a.before+=b,a.after=b+a.after)};h.stripLinkDefs=function(a,b){return a=a.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(a,e,f,k,h){b[e]=a.replace(/\s*$/,"");return k?(b[e]=a.replace(/["(](.+?)[")]$/,""),k+h):""})};h.addLinkDef=function(a,b){var c=0,e={};a.before=h.stripLinkDefs(a.before,e);a.selection=h.stripLinkDefs(a.selection,e);a.after=h.stripLinkDefs(a.after,e);var f="",k=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,
l=function(a){c++;a=a.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+c+"]:");f+="\n"+a},u=function(a,b,f,g,h,n){f=f.replace(k,u);return e[h]?(l(e[h]),b+f+g+c+n):a};a.before=a.before.replace(k,u);b?l(b):a.selection=a.selection.replace(k,u);b=c;a.after=a.after.replace(k,u);a.after&&(a.after=a.after.replace(/\n*$/,""));a.after||(a.selection=a.selection.replace(/\n*$/,""));a.after+="\n\n"+f;return b};h.doLinkOrImage=function(a,b,c){var e="image"==c;c="attachment"==c;a.trimWhitespace();a.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);
if(1<a.endTag.length)a.startTag=a.startTag.replace(/!?\[/,""),a.endTag="",h.addLinkDef(a,null);else if(/\n\n/.test(a.selection))h.addLinkDef(a,null);else{var f=function(c,f){void 0!=f&&(e=f);null!==c&&(c=c.replace(/\s/g,"+"),a.startTag=a.endTag="",f=h.addLinkDef(a," [999]: "+c),a.startTag=e?"![":"[",a.endTag="]["+f+"]",a.selection||(f=document.createElement("a"),f.href=c,c=f.pathname.endsWith("/")?f.pathname.slice(0,-1):f.pathname,a.selection=0===c.length?f.hostname:c.substr(c.lastIndexOf("/")+1)));
b(!0)},k=null,l=null;k=e?C:D;l="http://";k=$('\x3cspan\x3e\x3clabel id\x3d"dialog-description" for\x3d"link-dialog-input"\x3e'+k+'\x3c/label\x3e\x3cinput id\x3d"link-dialog-input" type\x3d"text" value\x3d"http://" /\x3e\x3c/span\x3e');e?h.doImage(k,l,f):c?h.doAttachment(f):h.doLink(k,f,l);return!0}};h.doAttachment=function(a){commandUtils.showUploadDialog(null,{returnEle:$(event.target),authorizeUrl:pageContext.url.authorizeAttachmentsUrl,authorizeContext:t.authorize(!1),onSuccess:function(b,c){t.toForm(c);
a(c.url,c.isImage)}})};h.doImage=function(a,b,c){if(t){var e=commandUtils.createUploadDialogNodes(!0,!0);e.find("p.divider").before(a);var f=e.find("input[type\x3dtext]");commandUtils.showUploadDialog(null,{returnEle:$(event.target),nodes:e,authorizeUrl:pageContext.url.authorizeAttachmentsUrl,authorizeContext:t.authorize(!0),onAfterShow:function(){var a=f[0],c=b.length;if(void 0!==a.selectionStart)a.selectionStart=0,a.selectionEnd=c;else if(a.createTextRange){var e=a.createTextRange();e.collapse(!1);
e.moveStart("character",-c);e.moveEnd("character",c);e.select()}a.focus()},override_yes_callback:function(a,e,g){if($(".fake-input").val()||f.val()!=b)g.close=e,g.dialog=a,$uploadButton=$(".modal.in .modal-footer .btn-primary"),$uploadButton.addClass("disabled");$(".fake-input").val()?g.authorizeAndStart():f.val()!=b&&(c(f.val()),g.close())},onSuccess:function(a,b){t.toForm(b);c(b.url)}})}else h.doLink(a,c,b)};h.doLink=function(a,b,c){var e=a.find("input")[0];a={returnEle:$(event.target),nodes:a,
yes_callback:function(a,c){a=a.find("input").val();a=a.replace("http://http://","http://");a=a.replace("http://https://","https://");a=a.replace("http://ftp://","ftp://");-1===a.indexOf("http://")&&-1===a.indexOf("ftp://")&&-1===a.indexOf("https://")&&(a="http://"+a);b(a);$("body .alert.sr-only").remove();$("body").prepend($('\x3cdiv aria-live\x3d"assertive" class\x3d"alert sr-only" role\x3d"alert"\x3eLink was added successfully\x3c/div\x3e'));c()},show_no:!0,onAfterShow:function(){var a=c.length;
if(void 0!==e.selectionStart)e.selectionStart=0,e.selectionEnd=a;else if(e.createTextRange){var b=e.createTextRange();b.collapse(!1);b.moveStart("character",-a);b.moveEnd("character",a);b.select()}e.focus()}};commandUtils.showDialog(a)};m.makeAPI=function(){b.wmd={};b.wmd.editor=b.editor;b.wmd.previewManager=b.previewManager};m.startEditor=function(){if(!1===b.wmd_env.autostart)m.makeAPI();else{var a={},e,c,g=function(){b.panels=new b.PanelCollection;c=new b.previewManager;e=new b.editor(c.refresh);
c.refresh(!0);a.edit=e;a.previewMgr=c};"complete"==q.readyState?g():m.addEvent(top,"load",g);return a}};b.previewManager=function(){var a=this,e,c,g="delayed",f=function(){if(b.panels.preview||b.panels.output){var a=b.panels.input.value;a&&a==c||(c=a,(new Date).getTime())}},k=function(){e&&(top.clearTimeout(e),e=void 0);if("manual"!==g){var a=0;"delayed"===g&&(a=500);3E3<a&&(a=3E3);e=top.setTimeout(f,a)}};this.refresh=function(a){a?(c="",f()):k()};this.processingTime=function(){return 0};this.output=
function(){};this.setUpdateMode=function(b){g=b;a.refresh()};this.destroy=function(){h&&h.destroy()};var h=new b.inputPoller(k,500);f();b.panels.preview&&(b.panels.preview.scrollTop=0);b.panels.output&&(b.panels.output.scrollTop=0)};h.doAutoindent=function(a,b,c){a.before=a.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");c=!1;/(\n|^)[ ]{0,3}([*+-])[ \t]+.*\n$/.test(a.before)&&
h.doList&&h.doList(a,b,!1,!0);/(\n|^)[ ]{0,3}(\d+[.])[ \t]+.*\n$/.test(a.before)&&h.doList&&h.doList(a,b,!0,!0);/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(a.before)&&h.doBlockquote&&h.doBlockquote(a,b,c);/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&h.doCode&&h.doCode(a,b,c,!0)};h.doBlockquote=function(a,b,c){a.selection=a.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(b,c,e,f){a.before+=c;a.after=f+a.after;return e});a.before=a.before.replace(/(>[ \t]*)$/,function(b,c){a.selection=c+a.selection;return""});
b=c?"Blockquote":"";a.selection=a.selection.replace(/^(\s|>)+$/,"");a.selection=a.selection||b;c=b="";if(a.before){var e=a.before.replace(/\n$/,"").split("\n"),f=!1;for(h in e){var k=!1;line=e[h];f=f&&0<line.length;/^>/.test(line)?(k=!0,!f&&1<line.length&&(f=!0)):k=/^[ \t]*$/.test(line)?!0:f;k?b+=line+"\n":(c+=b+line,b="\n")}/(^|\n)>/.test(b)||(c+=b,b="")}a.startTag=b;a.before=c;a.after&&(a.after=a.after.replace(/^\n?/,"\n"));a.after=a.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,
function(b){a.endTag=b;return""});var h=function(b){var c=b?"\x3e ":"";a.startTag&&(a.startTag=a.startTag.replace(/\n((>|\s)*)\n$/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,c)+"\n"}));a.endTag&&(a.endTag=a.endTag.replace(/^\n((>|\s)*)\n/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,c)+"\n"}))};/^(?![ ]{0,3}>)/m.test(a.selection)?(a.selection=a.selection.replace(/^/gm,"\x3e "),h(!0),a.addBlankLines()):(a.selection=a.selection.replace(/^[ ]{0,3}> ?/gm,""),h(!1),!/^(\n|^)[ ]{0,3}>/.test(a.selection)&&
a.startTag&&(a.startTag=a.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(a.selection)&&a.endTag&&(a.endTag=a.endTag.replace(/^\n{0,2}/,"\n\n")));/\n/.test(a.selection)||(a.selection=a.selection.replace(/^(> *)/,function(b,c){a.startTag+=c;return""}))};h.doCode=function(a,b,c,g){var e=/\S[ ]*$/.test(a.before);if(!/^[ ]*\S/.test(a.after)&&!e||/\n/.test(a.selection)){a.before=a.before.replace(/[ ]{4}$/,function(b){a.selection=b+a.selection;return""});e=c=1;if(/\n(\t|[ ]{4,}).*\n$/.test(a.before)||
""===a.after)c=0;/^\n(\t|[ ]{4,})/.test(a.after)&&(e=0);a.addBlankLines(c,e);a.selection||g?/^[ ]{0,3}\S/m.test(a.selection)?a.selection=a.selection.replace(/^/gm,"    "):a.selection=a.selection.replace(/^[ ]{4}/gm,""):(g={nodes:$("\x3clabel\x3e").text(pageContext.i18n.WMDAddCodeText).attr({for:"wmd-code-dialog-input",class:"h3 pb-1 capitalize"}).add($("\x3ctextarea\x3e").attr({placeholder:pageContext.i18n.WMDCodeEditorText,rows:"15",cols:"200",id:"wmd-code-dialog-input"}).css({width:"500px",height:"250px"})),
returnEle:$(event.target),extra_class:"prompt",onAfterShow:function(){setTimeout(function(){$("textarea#wmd-code-dialog-input").focus()},20)},yes_callback:function(c,e){c=pageContext.sanitizationEscapeHtml?c.find("textarea").val():commandUtils.escapeHtml(c.find("textarea").val());a.selection=pageContext.options.markdownCodeInBackticks?"```\n"+c+"\n```":pageContext.options.markdownCodeInPreTags?"\x3cpre\x3e\x3ccode\x3e\n"+c+"\n\x3c/pre\x3e\x3c/code\x3e":c.replace(/^/gm,"    ");b();e()},show_no:!0},
commandUtils.showDialog(g))}else a.trimWhitespace(),a.findTags(/`/,/`/),a.startTag||a.endTag?a.endTag&&!a.startTag?(a.before+=a.endTag,a.endTag=""):a.startTag=a.endTag="":(a.startTag=a.endTag="`",a.selection||(a.selection=c?pageContext.i18n.WMDCodeEditorText:""))};h.doList=function(a,b,c,g){b=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/;var e="-",h=1,l=function(){if(c){var a=" "+h+". ";h++}else a=" "+e+" ";return a},n=function(a){void 0===c&&(c=
/^\s*\d/.test(a));return a=a.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(a){return l()})};a.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);!a.before||/\n$/.test(a.before)||/^\n/.test(a.startTag)||(a.before+=a.startTag,a.startTag="");if(a.startTag){var m=/\d+[.]/.test(a.startTag);a.startTag="";a.selection=a.selection.replace(/\n[ ]{4}/g,"\n");a.selection=a.selection.replace(/\d+[.] /g,"");a.selection=a.selection.replace(/ - /g,"");a.addBlankLines();m&&(a.after=a.after.replace(b,n));if(c==m)return}var q=
1;a.before=a.before.replace(/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,function(a){/^\s*([*+-])/.test(a)&&(e=p.$1);q=/[^\n]\n\n[^\n]/.test(a)?1:0;return n(a)});a.selection||(a.selection=g?"List item":" ");g=l();var t=1;if(-1!==a.selection.indexOf("\n")){m=a.selection.split("\n");for(var r=1;r<m.length;r++)if(c){var v=l();m[r]=v+m[r].trim()}else m[r]=g+m[r];a.selection=m.join("\n")}a.after=a.after.replace(b,function(a){t=/[^\n]\n\n[^\n]/.test(a)?
1:0;return n(a)});a.trimWhitespace(!0);a.addBlankLines(q,t,!0);a.startTag=g};h.doHeading=function(a,b,c){a.selection=a.selection.replace(/\s+/g," ");a.selection=a.selection.replace(/(^\s+|\s+$)/g,"");if(a.selection){if(b=0,a.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(a.startTag)&&(b=p.lastMatch.length),a.startTag=a.endTag="",a.findTags(null,/\s?(-+|=+)/),/=+/.test(a.endTag)&&(b=1),/-+/.test(a.endTag)&&(b=2),a.startTag=a.endTag="",a.addBlankLines(1,1),4!=b&&0<=b){for(b+=1;b--;)a.startTag+="#";a.startTag+=
" "}}else a.startTag="# ",a.selection="Heading"};h.doHorizontalRule=function(a,b,c){a.startTag="----------\n";a.selection="";a.addBlankLines(2,1,!0)}};b.wmd_env={};b.account_options={};b.wmd_defaults={version:1,output:"HTML",lineLength:40,delayLoad:!1};b.wmd=function(){b.loadEnv=function(){var l=function(l){if(l)for(var n in l)b.wmd_env[n]=l[n]};l(b.wmd_defaults);l(b.account_options);l(top.wmd_options);b.full=!0;b.wmd_env.buttons=b.wmd_env.buttons||"bold italic link blockquote code image ol ul heading hr"};
b.loadEnv()};return b};
var osqaSkin="{{settings.OSQA_SKIN}}",i18nLang="{{settings.LANGUAGE_CODE}}",mediaUrl=function(e){return scriptUrl+"m/"+osqaSkin+"/"+e},scriptUrl="/{{settings.FORUM_SCRIPT_ALIAS}}";
(function(e){e.i18n={setDictionary:function(a){},_:function(a,b){var c=a;i18n_dict&&i18n_dict[a]&&(c=i18n_dict[a]);return this.printf(c,b)},toEntity:function(a){for(var b="",c=0;c<a.length;c++)b=128<a.charCodeAt(c)?b+("\x26#"+a.charCodeAt(c)+";"):b+a.charAt(c);return b},stripStr:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")},stripStrML:function(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=stripStr(a[b]);return stripStr(a.join(" "))},printf:function(a,b){if(!b)return a;var c="";
a=a.split("%s");for(var d=0;d<b.length;d++)a[d].lastIndexOf("%")==a[d].length-1&&d!=b.length-1&&(a[d]+="s"+a.splice(d+1,1)[0]),c+=a[d]+b[d];return c+a[a.length-1]}}})(jQuery);
var i18nZh={"insufficient privilege":"??????????","cannot pick own answer as best":"??????????????","anonymous users cannot select favorite questions":"?????????????","please login":"??????","anonymous users cannot vote":"????????","\x3e15 points requried to upvote":"??+15?????????","\x3e100 points required to downvote":"??+100?????????","please see":"??","cannot vote for own posts":"??????????","daily vote cap exhausted":"????????????????","cannot revoke old vote":"??????????????","please confirm offensive":"??????????????????????",
"anonymous users cannot flag offensive posts":"???????????","cannot flag message as offensive twice":"???????","flag offensive cap exhausted":"?????????????5?\ufffd??\ufffd???","need \x3e15 points to report spam":"??+15??????\ufffd???\ufffd?","confirm delete":"?????/????????","anonymous users cannot delete/undelete":"???????????????","post recovered":"?????????????","post deleted":"????????????","add comment":"????","community karma points":"????","to comment, need":"????","delete this comment":"?????",
"hide comments":"????","add a comment":"????",comments:"??","confirm delete comment":"?????????",characters:"??","can write":"???","click to close":"???????","loading...":"???...","tags cannot be empty":"???????","tablimits info":"??5????????????20????","content cannot be empty":"???????","content minchars":"????? {0} ???","please enter title":"??????","title minchars":"????? {0} ???","delete":"??",undelete:"??",bold:"??",italic:"??",link:"???",quote:"??","preformatted text":"??",image:"??","numbered list":"??????",
"bulleted list":"??????",heading:"??","horizontal bar":"???",undo:"??",redo:"??","enter image url":'\x3cb\x3e??????\x3c/b\x3e\x3c/p\x3e\x3cp\x3e???\x3cbr /\x3ehttp://www.example.com/image.jpg   "????"',"enter url":'\x3cb\x3e??Web??\x3c/b\x3e\x3c/p\x3e\x3cp\x3e???\x3cbr /\x3ehttp://www.cnprog.com/   "????"\x3c/p\x3e"',"upload image":"?????????"},i18nEn={"need \x3e15 points to report spam":"need \x3e15 points to report spam ","\x3e15 points requried to upvote":"\x3e15 points required to upvote ","tags cannot be empty":"please enter at least one tag",
"anonymous users cannot vote":"sorry, anonymous users cannot vote ","anonymous users cannot select favorite questions":"sorry, anonymous users cannot select favorite questions ","to comment, need":"(to comment other people's posts, karma ","please see":"please see ","community karma points":" or more is necessary) - ","upload image":"Upload image:","enter image url":'enter URL of the image, e.g. http://www.example.com/image.jpg "image title"',"enter url":'enter Web address, e.g. http://www.example.com "page title"',
"daily vote cap exhausted":"sorry, you've used up todays vote cap","cannot pick own answer as best":"sorry, you cannot accept your own answer","cannot revoke old vote":"sorry, older votes cannot be revoked","please confirm offensive":"are you sure this post is offensive, contains spam, advertising, malicious remarks, etc.?","flag offensive cap exhausted":"sorry, you've used up todays cap of flagging offensive messages ","confirm delete":"are you sure you want to delete this?","anonymous users cannot delete/undelete":"sorry, anonymous users cannot delete or undelete posts",
"post recovered":"your post is now restored!","post deleted":"your post has been deleted","confirm delete comment":"do you really want to delete this comment?","can write":"have ","tablimits info":"up to 5 tags, no more than 20 characters each","content minchars":"please enter more than {0} characters","title minchars":"please enter at least {0} characters",characters:"characters left","cannot vote for own posts":"sorry, you cannot vote for your own posts","cannot flag message as offensive twice":"cannot flag message as offensive twice ",
"\x3e100 points required to downvote":"\x3e100 points required to downvote "},i18nEs={"insufficient privilege":"privilegio insuficiente","cannot pick own answer as best":"no puede escoger su propia respuesta com la mejor","anonymous users cannot select favorite questions":"usuarios anonimos no pueden seleccionar","please login":"por favor inicie sesi\ufffdn","anonymous users cannot vote":"usuarios an\ufffdnimos no pueden votar","\x3e15 points requried to upvote":"\x3e15 puntos requeridos para votar positivamente",
"\x3e100 points required to downvote":"\x3e100 puntos requeridos para votar negativamente","please see":"por favor vea","cannot vote for own posts":"no se puede votar por sus propias publicaciones","daily vote cap exhausted":"cuota de votos diarios excedida","cannot revoke old vote":"no puede revocar un voto viejo","please confirm offensive":"por favor confirme ofensiva","anonymous users cannot flag offensive posts":"usuarios an\ufffdnimos no pueden marcar publicaciones com ofensivas","cannot flag message as offensive twice":"no puede marcar mensaje com ofensivo dos veces",
"flag offensive cap exhausted":"cuota para marcar ofensivas ha sido excedida","need \x3e15 points to report spam":"necesita \x3e15 puntos para reportar spam","confirm delete":"\ufffdEst\ufffd seguro que desea borrar esto?","anonymous users cannot delete/undelete":"usuarios an\ufffdnimos no pueden borrar o recuperar publicaciones","post recovered":"publicaci\ufffdn recuperada","post deleted":"publicaci\ufffdn borrada?","add comment":"agregar comentario","community karma points":"reputaci\ufffdn comunitaria",
"to comment, need":"para comentar, necesita reputaci\ufffdn","delete this comment":"borrar este comentario","hide comments":"ocultar comentarios","add a comment":"agregar comentarios",comments:"comentarios","confirm delete comment":"\ufffdRealmente desea borrar este comentario?",characters:"caracteres faltantes","can write":"tiene ","click to close":"haga click para cerrar","loading...":"cargando...","tags cannot be empty":"las etiquetas no pueden estar vac\ufffdas","tablimits info":"hasta 5 etiquetas de no mas de 20 caracteres cada una",
"content cannot be empty":"el contenido no puede estar vac\ufffdo","content minchars":"por favor introduzca mas de {0} caracteres","please enter title":"por favor ingrese un t\ufffdtulo","title minchars":"por favor introduzca al menos {0} caracteres","delete":"borrar",undelete:"recuperar",bold:"negrita",italic:"cursiva",link:"enlace",quote:"citar","preformatted text":"texto preformateado",image:"imagen","numbered list":"lista numerada","bulleted list":"lista no numerada",heading:"??","horizontal bar":"barra horizontal",
undo:"deshacer",redo:"rehacer","enter image url":'introduzca la URL de la imagen, por ejemplo?\x3cbr /\x3ehttp://www.example.com/image.jpg   "titulo de imagen"',"enter url":'introduzca direcciones web, ejemplo?\x3cbr /\x3ehttp://www.cnprog.com/   "titulo del enlace"\x3c/p\x3e"',"upload image":"cargar imagen?","questions/":"preguntas/","vote/":"votar/"},i18n={en:i18nEn,zh_CN:i18nZh,es:i18nEs},i18n_dict=i18n[i18nLang];$(function(){});
(function(f){function g(h){if(e[h])return e[h].exports;var m=e[h]={i:h,l:!1,exports:{}};f[h].call(m.exports,m,m.exports,g);m.l=!0;return m.exports}var e={};g.m=f;g.c=e;g.d=function(e,f,k){g.o(e,f)||Object.defineProperty(e,f,{configurable:!1,enumerable:!0,get:k})};g.n=function(e){var f=e&&e.__esModule?function(){return e["default"]}:function(){return e};g.d(f,"a",f);return f};g.o=function(e,f){return Object.prototype.hasOwnProperty.call(e,f)};g.p="";return g(g.s=5)})([function(f,g,e){Object.defineProperty(g,
"__esModule",{value:!0});var h=function(){function e(e,d){for(var b=0;b<d.length;b++){var a=d[b];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(e,a.key,a)}}return function(f,d,b){d&&e(f.prototype,d);b&&e(f,b);return f}}();e(2);f=function(){function e(f,d,b){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.data=f;this.term=d;this.strategy=b}h(e,[{key:"replace",value:function(e,d){var b=this.strategy.replace(this.data);
if(null!==b){Array.isArray(b)&&(d=b[1]+d,b=b[0]);var a=this.strategy.matchText(e);if(a)return b=b.replace(/\$&/g,a[0]).replace(/\$(\d)/g,function(b,q){return a[parseInt(q,10)]}),[[e.slice(0,a.index),b,e.slice(a.index+a[0].length)].join(""),d]}}},{key:"render",value:function(){return this.strategy.template(this.data,this.term)}}]);return e}();g.default=f},function(f,g,e){function h(){}function m(a,b,q){this.fn=a;this.context=b;this.once=q||!1}function k(){this._events=new h;this._eventsCount=0}var d=
Object.prototype.hasOwnProperty,b="~";Object.create&&(h.prototype=Object.create(null),(new h).__proto__||(b=!1));k.prototype.eventNames=function(){var a=[],c,q;if(0===this._eventsCount)return a;for(q in c=this._events)d.call(c,q)&&a.push(b?q.slice(1):q);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(c)):a};k.prototype.listeners=function(a,c){a=this._events[b?b+a:a];if(c)return!!a;if(!a)return[];if(a.fn)return[a.fn];c=0;for(var q=a.length,d=Array(q);c<q;c++)d[c]=a[c].fn;
return d};k.prototype.emit=function(a,c,q,d,n,r){var l=b?b+a:a;if(!this._events[l])return!1;l=this._events[l];var e=arguments.length,f;if(l.fn){l.once&&this.removeListener(a,l.fn,void 0,!0);switch(e){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,c),!0;case 3:return l.fn.call(l.context,c,q),!0;case 4:return l.fn.call(l.context,c,q,d),!0;case 5:return l.fn.call(l.context,c,q,d,n),!0;case 6:return l.fn.call(l.context,c,q,d,n,r),!0}var p=1;for(f=Array(e-1);p<e;p++)f[p-1]=arguments[p];
l.fn.apply(l.context,f)}else{var g=l.length;for(p=0;p<g;p++)switch(l[p].once&&this.removeListener(a,l[p].fn,void 0,!0),e){case 1:l[p].fn.call(l[p].context);break;case 2:l[p].fn.call(l[p].context,c);break;case 3:l[p].fn.call(l[p].context,c,q);break;case 4:l[p].fn.call(l[p].context,c,q,d);break;default:if(!f){var k=1;for(f=Array(e-1);k<e;k++)f[k-1]=arguments[k]}l[p].fn.apply(l[p].context,f)}}return!0};k.prototype.on=function(a,c,d){c=new m(c,d||this);a=b?b+a:a;this._events[a]?this._events[a].fn?this._events[a]=
[this._events[a],c]:this._events[a].push(c):(this._events[a]=c,this._eventsCount++);return this};k.prototype.once=function(a,c,d){c=new m(c,d||this,!0);a=b?b+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],c]:this._events[a].push(c):(this._events[a]=c,this._eventsCount++);return this};k.prototype.removeListener=function(a,c,d,p){a=b?b+a:a;if(!this._events[a])return this;if(!c)return 0===--this._eventsCount?this._events=new h:delete this._events[a],this;var n=this._events[a];
if(n.fn)n.fn!==c||p&&!n.once||d&&n.context!==d||(0===--this._eventsCount?this._events=new h:delete this._events[a]);else{for(var r=0,l=[],e=n.length;r<e;r++)(n[r].fn!==c||p&&!n[r].once||d&&n[r].context!==d)&&l.push(n[r]);l.length?this._events[a]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new h:delete this._events[a]}return this};k.prototype.removeAllListeners=function(a){a?(a=b?b+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new h:delete this._events[a])):(this._events=
new h,this._eventsCount=0);return this};k.prototype.off=k.prototype.removeListener;k.prototype.addListener=k.prototype.on;k.prototype.setMaxListeners=function(){return this};k.prefixed=b;k.EventEmitter=k;f.exports=k},function(f,g,e){function h(e){return e}Object.defineProperty(g,"__esModule",{value:!0});var m=function(){function e(d,b){for(var a=0;a<b.length;a++){var c=b[a];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}return function(d,
b,a){b&&e(d.prototype,b);a&&e(d,a);return d}}();f=function(){function e(d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.props=d;this.cache=d.cache?{}:null}m(e,[{key:"destroy",value:function(){this.cache=null;return this}},{key:"search",value:function(d,b,a){this.cache?this.searchWithCache(d,b,a):this.props.search(d,b,a)}},{key:"replace",value:function(d){return this.props.replace(d)}},{key:"searchWithCache",value:function(d,b,a){var c=this;this.cache&&this.cache[d]?
b(this.cache[d]):this.props.search(d,function(a){c.cache&&(c.cache[d]=a);b(a)},a)}},{key:"matchText",value:function(d){return"function"===typeof this.match?this.match(d):d.match(this.match)}},{key:"match",get:function(){return this.props.match}},{key:"index",get:function(){return"number"===typeof this.props.index?this.props.index:2}},{key:"template",get:function(){return this.props.template||h}}]);return e}();g.default=f},function(f,g,e){function h(b){return b>=k&&b<=d}function m(b,a){var c=document.body;
if(!c)return 0;b=document.createElement(b);b.innerHTML="\x26nbsp;";b.style.fontSize=a.fontSize;b.style.fontFamily=a.fontFamily;b.style.padding="0";c.appendChild(b);b instanceof HTMLTextAreaElement&&(b.rows=1);a=b.offsetHeight;c.removeChild(b);return a}Object.defineProperty(g,"__esModule",{value:!0});g.calculateElementOffset=function(b){var a=b.getBoundingClientRect(),c=b.ownerDocument;b=c.defaultView;c=c.documentElement;a={top:a.top+b.pageYOffset,left:a.left+b.pageXOffset};c&&(a.top-=c.clientTop,
a.left-=c.clientLeft);return a};g.getLineHeightPx=function(b){var a=window.getComputedStyle(b);return h(a.lineHeight.charCodeAt(0))?h(a.lineHeight.charCodeAt(a.lineHeight.length-1))?parseFloat(a.lineHeight)*parseFloat(a.fontSize):parseFloat(a.lineHeight):m(b.nodeName,a)};g.calculateLineHeightPx=m;g.createCustomEvent=function(){return"function"===typeof window.CustomEvent?function(b,a){return new document.defaultView.CustomEvent(b,{cancelable:a&&a.cancelable||!1,detail:a&&a.detail||void 0})}:function(b,
a){var c=document.createEvent("CustomEvent");c.initCustomEvent(b,!1,a&&a.cancelable||!1,a&&a.detail||void 0);return c}}();var k=48,d=57},function(f,g,e){function h(d,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);d.prototype=Object.create(b&&b.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(d,b):d.__proto__=b)}Object.defineProperty(g,"__esModule",
{value:!0});var m=function(){function d(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,c){a&&d(b.prototype,a);c&&d(b,c);return b}}();f=(f=e(1))&&f.__esModule?f:{default:f};var k=e(3);e(0);e=function(d){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!a||"object"!==typeof a&&"function"!==typeof a?this:a}h(b,d);m(b,[{key:"destroy",value:function(){return this}},{key:"applySearchResult",value:function(a){throw Error("Not implemented.");}},{key:"getCursorOffset",value:function(){throw Error("Not implemented.");}},{key:"getBeforeCursor",value:function(){throw Error("Not implemented.");}},{key:"emitMoveEvent",value:function(a){a=(0,k.createCustomEvent)("move",{cancelable:!0,detail:{code:a}});this.emit("move",a);return a}},{key:"emitEnterEvent",
value:function(){var a=(0,k.createCustomEvent)("enter",{cancelable:!0});this.emit("enter",a);return a}},{key:"emitChangeEvent",value:function(){var a=(0,k.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});this.emit("change",a);return a}},{key:"emitEscEvent",value:function(){var a=(0,k.createCustomEvent)("esc",{cancelable:!0});this.emit("esc",a);return a}},{key:"getCode",value:function(a){return 9===a.keyCode?"ENTER":13===a.keyCode?"ENTER":27===a.keyCode?"ESC":38===a.keyCode?
"UP":40===a.keyCode?"DOWN":78===a.keyCode&&a.ctrlKey?"DOWN":80===a.keyCode&&a.ctrlKey?"UP":"OTHER"}}]);return b}(f.default);g.default=e},function(f,g,e){f=e(6);g=(g=e(7))&&g.__esModule?g:{default:g};e=(e=e(12))&&e.__esModule?e:{default:e};var h=f.Textcomplete&&f.Textcomplete.editors?f.Textcomplete.editors:{};h.Textarea=e.default;f.Textcomplete=g.default;f.Textcomplete.editors=h},function(f,g){g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&
(g=window)}f.exports=g},function(f,g,e){function h(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(g,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var n=b[c];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(a,n.key,n)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();f=e(8);var b=h(f);f=e(4);h(f);f=e(10);var a=h(f);f=e(2);var c=h(f);f=e(0);h(f);e=e(1);var q="handleChange handleEnter handleEsc handleHit handleMove handleSelect".split(" ");
e=function(e){function n(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var e=m(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));e.completer=new b.default;e.isQueryInFlight=!1;e.nextPendingQuery=null;e.dropdown=new a.default(d.dropdown||{});e.editor=c;e.options=d;q.forEach(function(a){e[a]=e[a].bind(e)});e.startListening();return e}k(n,e);d(n,[{key:"destroy",value:function(){var a=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:!0;this.completer.destroy();this.dropdown.destroy();a&&this.editor.destroy();this.stopListening();return this}},{key:"hide",value:function(){this.dropdown.deactivate();return this}},{key:"register",value:function(a){var b=this;a.forEach(function(a){b.completer.registerStrategy(new c.default(a))});return this}},{key:"trigger",value:function(a){this.isQueryInFlight?this.nextPendingQuery=a:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(a));return this}},
{key:"handleHit",value:function(a){a=a.searchResults;a.length?this.dropdown.render(a,this.editor.getCursorOffset()):this.dropdown.deactivate();this.isQueryInFlight=!1;null!==this.nextPendingQuery&&this.trigger(this.nextPendingQuery)}},{key:"handleMove",value:function(a){"UP"===a.detail.code?this.dropdown.up(a):this.dropdown.down(a)}},{key:"handleEnter",value:function(a){var b=this.dropdown.getActiveItem();b?(this.dropdown.select(b),a.preventDefault()):this.dropdown.deactivate()}},{key:"handleEsc",
value:function(a){this.dropdown.shown&&(this.dropdown.deactivate(),a.preventDefault())}},{key:"handleChange",value:function(a){null!=a.detail.beforeCursor?this.trigger(a.detail.beforeCursor):this.dropdown.deactivate()}},{key:"handleSelect",value:function(a){this.emit("select",a);a.defaultPrevented||this.editor.applySearchResult(a.detail.searchResult)}},{key:"startListening",value:function(){var a=this;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",
this.handleChange);this.dropdown.on("select",this.handleSelect);"show shown render rendered selected hidden hide".split(" ").forEach(function(b){a.dropdown.on(b,function(){return a.emit(b)})});this.completer.on("hit",this.handleHit)}},{key:"stopListening",value:function(){this.completer.removeAllListeners();this.dropdown.removeAllListeners();this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}]);
return n}(h(e).default);g.default=e},function(f,g,e){function h(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(g,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}();f=e(1);f=h(f);var b=e(9),a=h(b);b=e(0);h(b);e=e(2);h(e);var c=["handleQueryResult"];e=function(b){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
var a=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));a.strategies=[];c.forEach(function(b){a[b]=a[b].bind(a)});return a}k(e,b);d(e,[{key:"destroy",value:function(){this.strategies.forEach(function(a){return a.destroy()});return this}},{key:"registerStrategy",value:function(a){this.strategies.push(a);return this}},{key:"run",value:function(a){(a=this.extractQuery(a))?a.execute(this.handleQueryResult):this.handleQueryResult([])}},{key:"extractQuery",value:function(b){for(var d=0;d<this.strategies.length;d++){var c=
a.default.build(this.strategies[d],b);if(c)return c}return null}},{key:"handleQueryResult",value:function(a){this.emit("hit",{searchResults:a})}}]);return e}(f.default);g.default=e},function(f,g,e){Object.defineProperty(g,"__esModule",{value:!0});var h=function(){function e(d,b){for(var a=0;a<b.length;a++){var c=b[a];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}return function(d,b,a){b&&e(d.prototype,b);a&&e(d,a);return d}}(),m=(f=
e(0))&&f.__esModule?f:{default:f};e(2);e=function(){function e(d,b,a){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.strategy=d;this.term=b;this.match=a}h(e,null,[{key:"build",value:function(d,b){if("function"===typeof d.props.context){var a=d.props.context(b);if("string"===typeof a)b=a;else if(!a)return null}return(b=d.matchText(b))?new e(d,b[d.index],b):null}}]);h(e,[{key:"execute",value:function(d){var b=this;this.strategy.search(this.term,function(a){d(a.map(function(a){return new m.default(a,
b.term,b.strategy)}))},this.match)}}]);return e}();g.default=e},function(f,g,e){function h(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(g,"__esModule",{value:!0});var d=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();f=e(1);f=h(f);var b=e(11),a=h(b);b=e(0);h(b);var c=e(3);e=function(b){function e(a){if(!(this instanceof
e))throw new TypeError("Cannot call a class as a function");var b=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));b.shown=!1;b.items=[];b.activeItem=null;b.footer=a.footer;b.header=a.header;b.maxCount=a.maxCount||10;b.el.className=a.className||"dropdown-menu textcomplete-dropdown";b.rotate=a.hasOwnProperty("rotate")?a.rotate:!0;b.placement=a.placement;b.itemOptions=a.item||{};var c=a.style;c&&Object.keys(c).forEach(function(a){b.el.style[a]=c[a]});return b}k(e,b);d(e,null,[{key:"createElement",
value:function(){var a=document.createElement("ul"),b=a.style;b.display="none";b.position="absolute";b.zIndex="10000";(b=document.body)&&b.appendChild(a);return a}}]);d(e,[{key:"destroy",value:function(){var a=this.el.parentNode;a&&a.removeChild(this.el);this.clear()._el=null;return this}},{key:"render",value:function(b,d){var e=this,f=(0,c.createCustomEvent)("render",{cancelable:!0});this.emit("render",f);if(f.defaultPrevented)return this;f=b.map(function(a){return a.data});var n=b.slice(0,this.maxCount||
b.length).map(function(b){return new a.default(b,e.itemOptions)});this.clear().setStrategyId(b[0]).renderEdge(f,"header").append(n).renderEdge(f,"footer").show().setOffset(d);this.emit("rendered",(0,c.createCustomEvent)("rendered"));return this}},{key:"deactivate",value:function(){return this.hide().clear()}},{key:"select",value:function(a){a={searchResult:a.searchResult};var b=(0,c.createCustomEvent)("select",{cancelable:!0,detail:a});this.emit("select",b);if(b.defaultPrevented)return this;this.deactivate();
this.emit("selected",(0,c.createCustomEvent)("selected",{detail:a}));return this}},{key:"up",value:function(a){return this.shown?this.moveActiveItem("prev",a):this}},{key:"down",value:function(a){return this.shown?this.moveActiveItem("next",a):this}},{key:"getActiveItem",value:function(){return this.activeItem}},{key:"append",value:function(a){var b=this,c=document.createDocumentFragment();a.forEach(function(a){b.items.push(a);a.appended(b);c.appendChild(a.el)});this.el.appendChild(c);return this}},
{key:"setOffset",value:function(a){var b=document.documentElement;if(b){var c=this.el.offsetWidth;if(a.left){var d=b.clientWidth;a.left+c>d&&(a.left=d-c);this.el.style.left=a.left+"px"}else a.right&&(0>a.right-c&&(a.right=0),this.el.style.right=a.right+"px");this.isPlacementTop()?this.el.style.bottom=b.clientHeight-a.top+a.lineHeight+"px":this.el.style.top=a.top+"px"}return this}},{key:"show",value:function(){if(!this.shown){var a=(0,c.createCustomEvent)("show",{cancelable:!0});this.emit("show",a);
if(a.defaultPrevented)return this;this.el.style.display="block";this.shown=!0;this.emit("shown",(0,c.createCustomEvent)("shown"))}return this}},{key:"hide",value:function(){if(this.shown){var a=(0,c.createCustomEvent)("hide",{cancelable:!0});this.emit("hide",a);if(a.defaultPrevented)return this;this.el.style.display="none";this.shown=!1;this.emit("hidden",(0,c.createCustomEvent)("hidden"))}return this}},{key:"clear",value:function(){this.el.innerHTML="";this.items.forEach(function(a){return a.destroy()});
this.items=[];return this}},{key:"moveActiveItem",value:function(a,b){if(a="next"===a?this.activeItem?this.activeItem.next:this.items[0]:this.activeItem?this.activeItem.prev:this.items[this.items.length-1])a.activate(),b.preventDefault();return this}},{key:"setStrategyId",value:function(a){(a=a&&a.strategy.props.id)?this.el.setAttribute("data-strategy",a):this.el.removeAttribute("data-strategy");return this}},{key:"renderEdge",value:function(a,b){var c=("header"===b?this.header:this.footer)||"";a=
"function"===typeof c?c(a):c;c=document.createElement("li");c.classList.add("textcomplete-"+b);c.innerHTML=a;this.el.appendChild(c);return this}},{key:"isPlacementTop",value:function(){return"top"===this.placement}},{key:"el",get:function(){this._el||(this._el=e.createElement());return this._el}}]);return e}(f.default);g.default=e},function(f,g,e){Object.defineProperty(g,"__esModule",{value:!0});g.DEFAULT_CLASS_NAME=void 0;var h=function(){function d(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,c){a&&d(b.prototype,a);c&&d(b,c);return b}}();e(0);var m=g.DEFAULT_CLASS_NAME="textcomplete-item",k=["onClick","onMouseover"];f=function(){function d(b,a){var c=this;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.searchResult=b;this.active=!1;this.className=a.className||m;this.activeClassName=this.className+" active";k.forEach(function(a){c[a]=
c[a].bind(c)})}h(d,[{key:"destroy",value:function(){this.el.removeEventListener("mousedown",this.onClick,!1);this.el.removeEventListener("mouseover",this.onMouseover,!1);this.el.removeEventListener("touchstart",this.onClick,!1);this.active&&(this.dropdown.activeItem=null);this._el=null}},{key:"appended",value:function(b){this.dropdown=b;this.siblings=b.items;this.index=this.siblings.length-1}},{key:"activate",value:function(){if(!this.active){var b=this.dropdown.getActiveItem();b&&b.deactivate();
this.dropdown.activeItem=this;this.active=!0;this.el.className=this.activeClassName}return this}},{key:"deactivate",value:function(){this.active&&(this.active=!1,this.el.className=this.className,this.dropdown.activeItem=null);return this}},{key:"onClick",value:function(b){b.preventDefault();this.dropdown.select(this)}},{key:"onMouseover",value:function(){this.activate()}},{key:"el",get:function(){if(this._el)return this._el;var b=document.createElement("li");b.className=this.active?this.activeClassName:
this.className;var a=document.createElement("a");a.innerHTML=this.searchResult.render();b.appendChild(a);this._el=b;b.addEventListener("mousedown",this.onClick);b.addEventListener("mouseover",this.onMouseover);b.addEventListener("touchstart",this.onClick);return b}},{key:"next",get:function(){if(this.index===this.siblings.length-1){if(!this.dropdown.rotate)return null;var b=0}else b=this.index+1;return this.siblings[b]}},{key:"prev",get:function(){if(0===this.index){if(!this.dropdown.rotate)return null;
var b=this.siblings.length-1}else b=this.index-1;return this.siblings[b]}}]);return d}();g.default=f},function(f,g,e){function h(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&
b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(g,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),b=function t(a,b,c){null===a&&(a=Function.prototype);var d=
Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return t(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};f=e(13);var a=h(f);f=e(4);f=h(f);var c=e(3),q=e(0);h(q);var p=e(14),n=["onInput","onKeydown"];e=function(e){function f(a){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");var b=m(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));b.el=a;n.forEach(function(a){b[a]=b[a].bind(b)});
b.startListening();return b}k(f,e);d(f,[{key:"destroy",value:function(){b(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"destroy",this).call(this);this.stopListening();this.el=null;return this}},{key:"applySearchResult",value:function(b){var c=this.getBeforeCursor();null!=c&&(b=b.replace(c,this.getAfterCursor()),this.el.focus(),Array.isArray(b)&&((0,a.default)(this.el,b[0],b[1]),this.el.dispatchEvent(new Event("input"))))}},{key:"getCursorOffset",value:function(){var a=(0,c.calculateElementOffset)(this.el),
b=this.getElScroll(),d=this.getCursorPosition(),e=(0,c.getLineHeightPx)(this.el),f=a.top-b.top+d.top+e;a=a.left-b.left+d.left;return"rtl"!==this.el.dir?{top:f,left:a,lineHeight:e}:{top:f,right:document.documentElement?document.documentElement.clientWidth-a:0,lineHeight:e}}},{key:"getBeforeCursor",value:function(){return this.el.selectionStart!==this.el.selectionEnd?null:this.el.value.substring(0,this.el.selectionEnd)}},{key:"getAfterCursor",value:function(){return this.el.value.substring(this.el.selectionEnd)}},
{key:"getElScroll",value:function(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}},{key:"getCursorPosition",value:function(){return p(this.el,this.el.selectionEnd)}},{key:"onInput",value:function(){this.emitChangeEvent()}},{key:"onKeydown",value:function(a){var b=this.getCode(a),c=void 0;"UP"===b||"DOWN"===b?c=this.emitMoveEvent(b):"ENTER"===b?c=this.emitEnterEvent():"ESC"===b&&(c=this.emitEscEvent());c&&c.defaultPrevented&&a.preventDefault()}},{key:"startListening",value:function(){this.el.addEventListener("input",
this.onInput);this.el.addEventListener("keydown",this.onKeydown)}},{key:"stopListening",value:function(){this.el.removeEventListener("input",this.onInput);this.el.removeEventListener("keydown",this.onKeydown)}}]);return f}(f.default);g.default=e},function(f,g,e){function h(){if("undefined"!==typeof Event)return new Event("input",{bubbles:!0,cancelable:!0});var e=document.createEvent("Event");e.initEvent("input",!0,!0);return e}Object.defineProperty(g,"__esModule",{value:!0});g.default=function(e,
f,d){var b=e.value;d=f+(d||"");for(var a=document.activeElement,c=0,g=0;c<b.length&&c<d.length&&b[c]===d[c];)c++;for(;0<=b.length-g-1&&0<=d.length-g-1&&b[b.length-g-1]===d[d.length-g-1];)g++;c=Math.min(c,Math.min(b.length,d.length)-g);e.setSelectionRange(c,b.length-g);b=d.substring(c,d.length-g);e.focus();document.execCommand("insertText",!1,b)||(e.value=d,e.dispatchEvent(h()));e.setSelectionRange(f.length,f.length);a&&a.focus();return e}},function(f,g){(function(){function e(d,b,a){if(!m)throw Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");
if(a=a&&a.debug||!1){var c=document.querySelector("#input-textarea-caret-position-mirror-div");c&&c.parentNode.removeChild(c)}c=document.createElement("div");c.id="input-textarea-caret-position-mirror-div";document.body.appendChild(c);var e=c.style,f=window.getComputedStyle?getComputedStyle(d):d.currentStyle;e.whiteSpace="pre-wrap";"INPUT"!==d.nodeName&&(e.wordWrap="break-word");e.position="absolute";a||(e.visibility="hidden");g.forEach(function(a){e[a]=f[a]});k?d.scrollHeight>parseInt(f.height)&&
(e.overflowY="scroll"):e.overflow="hidden";c.textContent=d.value.substring(0,b);"INPUT"===d.nodeName&&(c.textContent=c.textContent.replace(/\s/g,"\u00a0"));var h=document.createElement("span");h.textContent=d.value.substring(b)||".";c.appendChild(h);d={top:h.offsetTop+parseInt(f.borderTopWidth),left:h.offsetLeft+parseInt(f.borderLeftWidth)};a?h.style.backgroundColor="#aaa":document.body.removeChild(c);return d}var g="direction boxSizing width height overflowX overflowY borderTopWidth borderRightWidth borderBottomWidth borderLeftWidth borderStyle paddingTop paddingRight paddingBottom paddingLeft fontStyle fontVariant fontWeight fontStretch fontSize fontSizeAdjust lineHeight fontFamily textAlign textTransform textIndent textDecoration letterSpacing wordSpacing tabSize MozTabSize".split(" "),
m="undefined"!==typeof window,k=m&&null!=window.mozInnerScreenX;"undefined"!=typeof f&&"undefined"!=typeof f.exports?f.exports=e:m&&(window.getCaretCoordinates=e)})()}]);
(function(){var c=function(b,a){function c(){g||(g=$('\x3cdiv class\x3d"wmd-toolbar-shadow"\x3e\x3c/div\x3e'),f.append(g));return g}b.addClass("wmd-textarea");$("#body-preformatted").length&&(a=$("#body-preformatted")[0].innerText.replace(/\n/g,"\r\n").replace(/\u00a0/g," "),b.val(a),$("#body-preformatted").hide());var f=$('\x3cdiv class\x3d"wmd-panel"\x3e\x3c/div\x3e');b.before(f);var d=$('\x3cdiv class\x3d"wmd-previewer" tabindex\x3d"0" aria-readonly\x3d"true" role\x3d"textbox" aria-label\x3d"'+
pageContext.i18n.WMDPreviewMode+'"\x3e\x3c/div\x3e');b.after(d);a=createWmd({});var h=null;"undefined"!=typeof window.getAuthorizeContext&&(h={authorize:getAuthorizeContext,toForm:addAttachmentToForm});a.wmdBase({buttonBar:f.get(0),input:b.get(0)},!1,h);d.hide();var k=a.Util.startEditor(),g=null;b.on("keyup",function(){b.trigger("teamhubEdit.charCounter.update",b.val().length)});var l=Textcomplete.editors.Textarea,m={match:/\B@([\w\-\.]*)$/,search:function(a,b){$.ajax({url:pageContext.url.usersSearch,
dataType:"json",data:{q:a,page:1,pageSize:10},success:function(a){a=$.map(a.result,function(a,b){return{label:pageContext.userRealName&&a.realname?a.realname:a.username,value:a}});b(a)}})},index:1,cache:!0,replace:function(a){return"@"+a.label+" "},template:function(a){return $("\x3cdiv\x3e").append($('\x3cimg class\x3d"gravatar" height\x3d"24" width\x3d"24"/\x3e').attr("src",a.value.avatar)).append($('\x3cspan class\x3d"mention-label" style\x3d"margin-left:6px" \x3e\x3c/span\x3e').text(a.label)).html()}};
$("textarea[name\x3dbody]").not(".text-complete-added").each(function(){var a=new l(this);$(this).addClass("text-complete-added");var b=new Textcomplete(a);b.register([m]);var c=$(b.dropdown.el),d=$(b.editor.el);c.after('\x3cdiv class\x3d"mention-aria-live sr-only" aria-live\x3d"assertive"\x3e\x3c/div\x3e');b.on("rendered",function(){setTimeout(function(){c.siblings(".mention-aria-live").text(pageContext.i18n.editor.usersFound.replace("$n",b.dropdown.items.length))},100);d.on("keydown",function(a){a=
a||window.event;"38"!=a.keyCode&&"40"!=a.keyCode||setTimeout(function(){c.siblings(".mention-aria-live").text(pageContext.i18n.editor.userSelected.replace("$n",b.dropdown.activeItem.el.innerText))},100)})});b.on("select",function(a){setTimeout(function(){c.siblings(".mention-aria-live").text(pageContext.i18n.editor.userTagged.replace("$n",a.detail.searchResult.data.label))},100)});b.on("hide",function(){d.unbind("keydown")})});return{destroy:function(){f.remove();d.remove();b.removeClass("wmd-textarea");
k.edit.destroy()},get:function(){return b.val()},set:function(a){b.val(a);b.trigger("teamhubEdit.charCounter.update",b.val().length)},toggleCodeView:function(a){a?(d.hide(),b.show(),c().hide()):(a=b.val(),$.trim(a).length?$.ajax({type:"POST",url:(pageContext.url.base||"")+"/commands/previewMarkup/wmd.json?"+pageContext.csrf.parameter+"\x3d"+pageContext.csrf.getToken(),data:{source:a,editor:pageContext.currentEditor.name,escapeHtml:pageContext.sanitizationEscapeHtml},success:function(a){a=$(a.result.parsed);
$.each(a,function(a,b){$(b).is("pre")&&($(b).addClass("prettyprint").addClass("linenums"),pageContext.sanitizationEscapeHtml?$(b).find("code").text($(b).text()):$(b).find("code").text(commandUtils.unescapeHtml($(b).text())))});d.html(a);evaluateLineNum();prettyPrint()}}):d.html('\x3cspan class\x3d"no-preview"\x3eNothing to preview\x3c/span\x3e'),b.hide(),d.show(),c().show())}}};c.supportsOwnCodeView=!0;c.defaultTab="source";$.fn.teamhubEdit&&($.fn.teamhubEdit.register("wmd",c),$.fn.teamhubEdit.register("wmd-escaped",
c))})();
function addAttachmentToForm(c){function b(){return $('\x3cspan\x3e\x26nbsp;| \x3c/span\x3e\x3ca class\x3d"node-attachment-delete" href\x3d"#"\x3e\x3ci class\x3d"icon-remove"\x3e\x3c/i\x3e\x3c/a\x3e')}$("#main-attachments-container").slideDown();var a=null;if(c.isImage){a=$('\x3cdiv class\x3d"img-node-attachment"\x3e\x3c/div\x3e');var e=$('\x3ca href\x3d"'+c.url+'" target\x3d"_blank"\x3e\x3c/a\x3e');e.append($('\x3cimg src\x3d"'+c.url+'" width\x3d"100" /\x3e'));e.append($("\x3cspan\x3e"+c.fileName+"("+
c.size+")\x3c/span\x3e"));a.append(e);a.append($('\x3cinput type\x3d"hidden" name\x3d"attachments" value\x3d"'+c.fileId+'" /\x3e'));a.append(b());$("#img-attachments-container").append(a)}else a=$('\x3cdiv class\x3d"node-attachment"\x3e\x3c/div\x3e'),a.append('\x3cspan class\x3d"attachment-icon"\x3e\x3c/span\x3e'),a.append($('\x3ca href\x3d"'+c.url+'" target\x3d"_blank"\x3e'+c.fileName+"\x3c/a\x3e")),a.append($("\x3cspan\x3e ("+c.size+")\x3c/span\x3e")),a.append($('\x3cinput type\x3d"hidden" name\x3d"attachments" value\x3d"'+
c.fileId+'" /\x3e')),a.append(b()),$("#attachments-container").append(a)}
$(function(){$(document).on("click",".node-attachment-delete",function(c){function b(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$\x26")}var a=$(this);c=a.parent().find("input[type\x3dhidden]").val();var e=a.siblings("a").attr("href"),f=$($(this).parents("form")[0]).find("#body, textarea[name\x3dbody]"),d=new RegExp("\\s+?\\[(\\d+)\\]:\\s"+b(e)+"\\n?","g");e=new RegExp("\\s+?\\[(\\d+)\\]:\\s"+b(e).replace(" ","\\+")+"\\n?","g");if(d=d.exec(f.val())||e.exec(f.val()))e=new RegExp("!\\[[^\\]]+\\]\\s*\\["+
d[1]+"\\]","g"),f.val(f.val().replace(d[0],"").replace(e,""));f.trigger("focus");$.getJSON(pageContext.url.cancelUpload,{file:c});a.parent().fadeOut("fast",function(){a.parent().remove();1>$(".img-node-attachment").length&&1>$(".node-attachment").length&&$("#main-attachments-container").slideUp()});return!1})});
